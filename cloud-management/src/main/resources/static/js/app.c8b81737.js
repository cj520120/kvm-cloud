(()=>{var t={67986:t=>{t.exports={BASEURL:"."}},82746:(t,e,o)=>{"use strict";o(66992),o(88674),o(19601),o(17727);var s=o(27195),a=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[t.isFullScreen?t._e():e("HeadViewVue"),e("el-container",[t.isFullScreen?t._e():e("NavViewVue"),e("el-main",{staticClass:"main-container",class:t.isFullScreen?"full_screen_class":""},[e("router-view")],1)],1)],1)},n=[],r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"layout-left",attrs:{id:"LayoutLeft"}},[e("div",{staticClass:"shrink",on:{click:t.shrinkMenu}},[e("i",{class:t.isCollapse?"el-icon-s-unfold":"el-icon-s-fold"})]),e("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{collapse:t.isCollapse,"default-active":this.$route.path,router:"","collapse-transition":!1,"background-color":"rgb(52, 73, 94)","text-color":"#fff","active-text-color":"#ffd04b"}},t._l(t.nav_menu_data,(function(o,s){return e("el-menu-item",{key:s,attrs:{index:o.path}},[e("i",{class:o.icon}),e("span",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(o.title))])])})),1)],1)},i=[];const l={data:function(){return{path:"",isCollapse:!0,nav_menu_data:[{path:"/",title:"主页",icon:"el-icon-house"},{path:"/Guest",title:"虚拟机管理",icon:"el-icon-s-platform"},{path:"/Volume",title:"磁盘管理",icon:"el-icon-bank-card"},{path:"/Snapshot",title:"快照管理",icon:"el-icon-copy-document"},{path:"/Network",title:"网络管理",icon:"el-icon-platform-eleme"},{path:"/Host",title:"主机管理",icon:"el-icon-monitor"},{path:"/Storage",title:"存储池管理",icon:"el-icon-coin"},{path:"/Template",title:"模版管理",icon:"el-icon-price-tag"},{path:"/Scheme",title:"计算方案",icon:"el-icon-cpu"},{path:"/User",title:"用户管理",icon:"el-icon-s-custom"}]}},created:function(){this.isCollapse="0"!==localStorage.getItem("menu_is_collapse")},methods:{shrinkMenu:function(){this.isCollapse=!this.isCollapse,localStorage.setItem("menu_is_collapse",this.isCollapse?"1":"0")}}},c=l;var u=o(1001),d=(0,u.Z)(c,r,i,!1,null,"56b8a9fa",null);const _=d.exports;var p=function(){var t=this,e=t._self._c;return e("el-header",[e("div",{staticStyle:{float:"left","background-color":"#34495e",height:"100%"}},[e("img",{staticStyle:{width:"32px",height:"32px","margin-left":"10px","margin-top":"15px"},attrs:{src:o(66949)}})]),e("div",{staticStyle:{float:"left","background-color":"#34495e",height:"100%"}},[e("h5",{staticStyle:{"font-size":"18px",margin:"20px 0px 20px 10px",color:"white"}},[t._v("KVM Cloud")])]),e("el-menu",{staticClass:"headerMenu",attrs:{mode:"horizontal","background-color":"#34495e","text-color":"#fff","active-text-color":"#ffd04b"},on:{select:t.handleSelect}},[e("el-menu-item",{attrs:{index:"quit"}},[t._v("退出")]),e("el-menu-item",{attrs:{index:"password"}},[t._v("修改密码")])],1),e("el-dialog",{attrs:{title:"修改密码",visible:t.update_password_dialog_visible,center:"",width:"400px","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(e){t.update_password_dialog_visible=e}}},[e("el-form",{attrs:{model:t.update_password,"label-position":"right","label-width":"80px"}},[e("el-form-item",{attrs:{label:"旧密码",prop:"oldPassword"}},[e("el-input",{attrs:{type:"password","show-password":!0},model:{value:t.update_password.oldPassword,callback:function(e){t.$set(t.update_password,"oldPassword",e)},expression:"update_password.oldPassword"}})],1),e("el-form-item",{attrs:{label:"新密码",prop:"newPassword"}},[e("el-input",{attrs:{type:"password","show-password":!0},model:{value:t.update_password.newPassword,callback:function(e){t.$set(t.update_password,"newPassword",e)},expression:"update_password.newPassword"}})],1),e("el-form-item",{attrs:{label:"确认密码",prop:"confirmPassword"}},[e("el-input",{attrs:{type:"password","show-password":!0},model:{value:t.update_password.confirmPassword,callback:function(e){t.$set(t.update_password,"confirmPassword",e)},expression:"update_password.confirmPassword"}})],1),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:t.update_user_password_click}},[t._v("确 定")]),e("el-button",{on:{click:function(e){t.update_password_dialog_visible=!1}}},[t._v("取 消")])],1)],1)],1)],1)},h=[],m=(o(57658),o(45226)),f=o(27594),w=(o(41539),o(19265)),g=o(93069),v=o.n(g),y=o(42241),b=(o(68309),function(){var t=this,e=t._self._c;return e("div",[e("el-container",[e("el-main",[e("el-card",{directives:[{name:"show",rawName:"v-show",value:0===this.show_type,expression:"this.show_type === 0"}],staticClass:"box-card"},[e("el-row",{staticClass:"clearfix",staticStyle:{height:"20px"},attrs:{slot:"header"},slot:"header"},[e("el-button",{staticStyle:{float:"left",padding:"3px 0"},attrs:{type:"text"},on:{click:t.show_create_network}},[t._v("创建网络")])],1),e("el-row",[e("el-table",{staticStyle:{width:"100%"},attrs:{"v-loading":t.data_loading,data:t.networks}},[e("el-table-column",{attrs:{label:"ID",prop:"networkId",width:"80"}}),e("el-table-column",{attrs:{label:"名称",prop:"name",width:"120","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{label:"桥接网卡",prop:"bridge",width:"120"}}),e("el-table-column",{attrs:{label:"网络类型",prop:"type",width:"100"},scopedSlots:t._u([{key:"default",fn:function(o){return[e("el-tag",[t._v(t._s(t.get_network_type(o.row)))])]}}])}),e("el-table-column",{attrs:{label:"状态",prop:"status",width:"100"},scopedSlots:t._u([{key:"default",fn:function(o){return[e("el-tag",{attrs:{type:2===o.row.status?"success":"danger"}},[t._v(t._s(t.get_network_status(o.row)))])]}}])}),e("el-table-column",{attrs:{label:"操作","min-width":"380"},scopedSlots:t._u([{key:"default",fn:function(o){return[e("el-button",{attrs:{type:"",size:"mini"},on:{click:function(e){return t.show_network_info_click(o.row)}}},[t._v("网络详情")]),e("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(e){return t.register_network(o.row)}}},[t._v("重新注册")]),3!==o.row.status?e("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(e){return t.pasue_network(o.row)}}},[t._v("开始维护")]):t._e(),e("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){return t.destroy_network(o.row)}}},[t._v("销毁网络")])]}}])})],1)],1)],1),e("el-card",{directives:[{name:"show",rawName:"v-show",value:1===this.show_type,expression:"this.show_type === 1"}],staticClass:"box-card"},[e("el-row",{attrs:{slot:"header"},slot:"header"},[e("el-page-header",{attrs:{content:"网络详情"},on:{back:t.show_network_list}})],1),e("el-row",{staticStyle:{"text-align":"left",margin:"20px 0"}},[e("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(e){return t.register_network(t.show_network)}}},[t._v("重新注册")]),3!==t.show_network.status?e("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(e){return t.pasue_network(t.show_network)}}},[t._v("开始维护")]):t._e(),e("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){return t.destroy_network(t.show_network)}}},[t._v("销毁网络")])],1),e("el-row",[e("el-descriptions",{attrs:{column:2,size:"medium",border:""}},[e("el-descriptions-item",{attrs:{label:"ID"}},[t._v(t._s(t.show_network.networkId))]),e("el-descriptions-item",{attrs:{label:"名称"}},[t._v(t._s(t.show_network.name))]),e("el-descriptions-item",{attrs:{label:"起始IP"}},[t._v(t._s(t.show_network.startIp))]),e("el-descriptions-item",{attrs:{label:"结束IP"}},[t._v(t._s(t.show_network.endIp))]),e("el-descriptions-item",{attrs:{label:"网关地址"}},[t._v(t._s(t.show_network.gateway))]),e("el-descriptions-item",{attrs:{label:"子网掩码"}},[t._v(t._s(t.show_network.mask))]),e("el-descriptions-item",{attrs:{label:"子网地址"}},[t._v(t._s(t.show_network.subnet))]),e("el-descriptions-item",{attrs:{label:"官博地址"}},[t._v(t._s(t.show_network.broadcast))]),e("el-descriptions-item",{attrs:{label:"DNS"}},[t._v(t._s(t.show_network.dns))]),e("el-descriptions-item",{attrs:{label:"桥接网卡"}},[t._v(t._s(t.show_network.bridge))]),e("el-descriptions-item",{attrs:{label:"网络类型"}},[t._v(t._s(t.get_network_type(t.show_network)))]),1===t.show_network.type?e("el-descriptions-item",{attrs:{label:"VLAN ID"}},[t._v(t._s(t.show_network.vlanId))]):t._e(),1===t.show_network.type?e("el-descriptions-item",{attrs:{label:"基础网络"}},[e("el-link",{attrs:{type:"primary"}},[t._v(t._s(t.get_parent_network(t.show_network).name))])],1):t._e(),e("el-descriptions-item",{attrs:{label:"网络状态"}},[e("el-tag",{attrs:{type:2===t.show_network.status?"success":"danger"}},[t._v(t._s(t.get_network_status(t.show_network)))])],1)],1),e("br"),e("el-tabs",{attrs:{type:"border-card"}},[e("el-tab-pane",{attrs:{label:"系统组件"}},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.system_guests}},[e("el-table-column",{attrs:{label:"ID",prop:"guestId",width:"80"}}),e("el-table-column",{attrs:{label:"实例名",prop:"name",width:"200"}}),e("el-table-column",{attrs:{label:"标签",prop:"description",width:"200"}}),e("el-table-column",{attrs:{label:"IP地址",prop:"guestIp",width:"150"}}),e("el-table-column",{attrs:{label:"状态",prop:"status",width:"100"},scopedSlots:t._u([{key:"default",fn:function(o){return[e("el-tag",{attrs:{type:2===o.row.status?"success":"danger"}},[t._v(t._s(t.get_guest_status(o.row)))])]}}])}),e("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(o){return[e("el-link",{attrs:{type:"primary"},on:{click:function(e){return t.go_guest_info(o.row.guestId)}}},[t._v("详情")])]}}])})],1)],1)],1)],1)],1),e("el-card",{directives:[{name:"show",rawName:"v-show",value:2===this.show_type,expression:"this.show_type === 2"}],staticClass:"box-card"},[e("el-row",{attrs:{slot:"header"},slot:"header"},[e("el-page-header",{staticStyle:{color:"#409eff"},attrs:{content:"创建网络"},on:{back:function(e){return t.show_network_list()}}})],1),e("el-row",[e("el-form",{ref:"createForm",staticClass:"demo-ruleForm",attrs:{model:t.create_network,"label-width":"100px"}},[e("el-row",{attrs:{gutter:24}},[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"网络名称",prop:"name"}},[e("el-input",{model:{value:t.create_network.name,callback:function(e){t.$set(t.create_network,"name",e)},expression:"create_network.name"}})],1)],1)],1),e("el-row",{attrs:{gutter:24}},[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"起始IP",prop:"startIp"}},[e("el-input",{model:{value:t.create_network.startIp,callback:function(e){t.$set(t.create_network,"startIp",e)},expression:"create_network.startIp"}})],1)],1),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"结束IP",prop:"endIp"}},[e("el-input",{model:{value:t.create_network.endIp,callback:function(e){t.$set(t.create_network,"endIp",e)},expression:"create_network.endIp"}})],1)],1)],1),e("el-row",{attrs:{gutter:24}},[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"网关地址",prop:"gateway"}},[e("el-input",{model:{value:t.create_network.gateway,callback:function(e){t.$set(t.create_network,"gateway",e)},expression:"create_network.gateway"}})],1)],1),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"子网掩码",prop:"mask"}},[e("el-input",{model:{value:t.create_network.mask,callback:function(e){t.$set(t.create_network,"mask",e)},expression:"create_network.mask"}})],1)],1)],1),e("el-row",{attrs:{gutter:24}},[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"子网地址",prop:"subnet"}},[e("el-input",{model:{value:t.create_network.subnet,callback:function(e){t.$set(t.create_network,"subnet",e)},expression:"create_network.subnet"}})],1)],1),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"广播地址",prop:"broadcast"}},[e("el-input",{model:{value:t.create_network.broadcast,callback:function(e){t.$set(t.create_network,"broadcast",e)},expression:"create_network.broadcast"}})],1)],1)],1),e("el-row",{attrs:{gutter:24}},[e("el-col",{attrs:{span:24}},[e("el-form-item",{attrs:{label:"DNS",prop:"dns"}},[e("el-input",{model:{value:t.create_network.dns,callback:function(e){t.$set(t.create_network,"dns",e)},expression:"create_network.dns"}})],1)],1)],1),e("el-row",{attrs:{gutter:24}},[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"桥接网卡",prop:"bridge"}},[e("el-input",{model:{value:t.create_network.bridge,callback:function(e){t.$set(t.create_network,"bridge",e)},expression:"create_network.bridge"}})],1)],1),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"网络类型",prop:"type"}},[e("el-select",{staticStyle:{width:"100%"},model:{value:t.create_network.type,callback:function(e){t.$set(t.create_network,"type",e)},expression:"create_network.type"}},[e("el-option",{attrs:{label:"基础网络",value:0}}),e("el-option",{attrs:{label:"Vlan网络",value:1}})],1)],1)],1)],1),1===t.create_network.type?e("el-row",{attrs:{gutter:24}},[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"VLAN ID",prop:"vlanId"}},[e("el-input",{model:{value:t.create_network.vlanId,callback:function(e){t.$set(t.create_network,"vlanId",e)},expression:"create_network.vlanId"}})],1)],1),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"基础网络",prop:"basicNetworkId"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择基础网络"},model:{value:t.create_network.basicNetworkId,callback:function(e){t.$set(t.create_network,"basicNetworkId",e)},expression:"create_network.basicNetworkId"}},t._l(t.networks,(function(t){return e("el-option",{directives:[{name:"show",rawName:"v-show",value:0===t.type,expression:"item.type === 0"}],key:t.networkId,attrs:{label:t.name,value:t.networkId}})})),1)],1)],1)],1):t._e(),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:t.create_network_click}},[t._v("立即创建")]),e("el-button",{on:{click:t.show_network_list}},[t._v("取消")])],1)],1)],1)],1),e("GuestInfoComponent",{directives:[{name:"show",rawName:"v-show",value:3===this.show_type,expression:"this.show_type === 3"}],ref:"GuestInfoComponentRef",on:{back:function(e){t.show_type=1},onGuestUpdate:t.update_guest_info}})],1)],1)],1)}),k=[],I=o(51907),x=o(85617),T=(o(34553),o(69826),o(40561),o(82526),o(41817),function(){var t=this,e=t._self._c;return e("div",[e("el-card",{directives:[{name:"show",rawName:"v-show",value:0===this.show_type,expression:"this.show_type === 0"},{name:"loading",rawName:"v-loading",value:t.guest_loading,expression:"guest_loading"}],staticClass:"box-card"},[e("el-row",{attrs:{slot:"header"},slot:"header"},[e("el-page-header",{attrs:{content:"虚拟机详情"},on:{back:t.on_back_click}})],1),e("el-row",{staticStyle:{"text-align":"left",margin:"20px 0"}},[e("el-button",{attrs:{type:"primary",size:"mini",disabled:4!==t.show_guest_info.current_guest.status},on:{click:function(e){return t.show_start_guest_click(t.show_guest_info.current_guest)}}},[t._v("启动虚拟机")]),e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.show_stop_guest_click(t.show_guest_info.current_guest)}}},[t._v("停止虚拟机")]),0!==t.show_guest_info.current_guest.type?e("el-button",{attrs:{type:"primary",size:"mini",disabled:2!==t.show_guest_info.current_guest.status},on:{click:function(e){return t.reboot_guest_click(t.show_guest_info.current_guest)}}},[t._v("重启虚拟机")]):t._e(),0!==t.show_guest_info.current_guest.type?e("el-button",{attrs:{type:"primary",size:"mini",disabled:4!==t.show_guest_info.current_guest.status},on:{click:function(e){return t.show_reinstall_guest_click(t.show_guest_info.current_guest)}}},[t._v("重装系统")]):t._e(),0!==t.show_guest_info.current_guest.type?e("el-button",{attrs:{type:"primary",size:"mini",disabled:4!==t.show_guest_info.current_guest.status},on:{click:function(e){return t.show_modify_guest_click(t.show_guest_info.current_guest)}}},[t._v("修改配置")]):t._e(),e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.vnc_click(t.show_guest_info.current_guest)}}},[t._v("远程桌面")]),0!==t.show_guest_info.current_guest.type?e("el-button",{attrs:{type:"primary",size:"mini",disabled:0!==t.show_guest_info.current_guest.cdRoom},on:{click:function(e){return t.show_attach_cd_room_click(t.show_guest_info.current_guest)}}},[t._v("挂载光驱")]):t._e(),0!==t.show_guest_info.current_guest.type?e("el-button",{attrs:{type:"primary",size:"mini",disabled:0===t.show_guest_info.current_guest.cdRoom},on:{click:function(e){return t.detach_guest_cd_room_click(t.show_guest_info.current_guest)}}},[t._v("卸载光驱")]):t._e(),0!==t.show_guest_info.current_guest.type?e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.show_attach_network_click(t.show_guest_info.current_guest)}}},[t._v("添加网卡")]):t._e(),0!==t.show_guest_info.current_guest.type?e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.show_attach_volume_click(t.show_guest_info.current_guest)}}},[t._v("挂载磁盘")]):t._e(),e("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){return t.destroy_guest(t.show_guest_info.current_guest)}}},[t._v("销毁虚拟机")])],1),e("el-row",[e("el-descriptions",{attrs:{column:2,size:"medium",border:""}},[e("el-descriptions-item",{attrs:{label:"ID"}},[t._v(t._s(t.show_guest_info.current_guest.guestId))]),e("el-descriptions-item",{attrs:{label:"实例名"}},[t._v(t._s(t.show_guest_info.current_guest.name))]),e("el-descriptions-item",{attrs:{label:"标签"}},[t._v(t._s(t.show_guest_info.current_guest.description))]),e("el-descriptions-item",{attrs:{label:"总线类型"}},[t._v(t._s(t.show_guest_info.current_guest.busType))]),e("el-descriptions-item",{attrs:{label:"CPU"}},[t._v(t._s(t.show_guest_info.current_guest.cpu)+"核")]),e("el-descriptions-item",{attrs:{label:"内存"}},[t._v(t._s(t.get_memory_desplay(t.show_guest_info.current_guest.memory)))]),e("el-descriptions-item",{attrs:{label:"配额"}},[t._v(t._s(t.show_guest_info.current_guest.speed))]),e("el-descriptions-item",{attrs:{label:"光盘"}},[t._v(t._s(t.show_guest_info.template.name))]),e("el-descriptions-item",{attrs:{label:"运行主机"}},[0!==t.show_guest_info.host.hostId?e("el-link",{attrs:{type:"primary",underline:!1},on:{click:function(e){return t.show_host_info(t.show_guest_info.host.hostId)}}},[t._v(t._s(t.show_guest_info.host.displayName))]):t._e(),0===t.show_guest_info.host.hostId?e("span",{attrs:{underline:!1}},[t._v(t._s(t.show_guest_info.host.displayName))]):t._e()],1),e("el-descriptions-item",{attrs:{label:"架构方案"}},[0!==t.show_guest_info.scheme.schemeId?e("el-link",{attrs:{type:"primary",underline:!1},on:{click:function(e){return t.show_scheme_info(t.show_guest_info.scheme.schemeId)}}},[t._v(t._s(t.show_guest_info.scheme.name))]):t._e(),0===t.show_guest_info.scheme.schemeId?e("span",{attrs:{underline:!1}},[t._v(t._s(t.show_guest_info.scheme.name))]):t._e()],1),e("el-descriptions-item",{attrs:{label:"虚拟机类型"}},[e("el-tag",[t._v(t._s(0===t.show_guest_info.current_guest.type?"系统":"用户"))])],1),e("el-descriptions-item",{attrs:{label:"虚拟机IP"}},[t._v(t._s(t.show_guest_info.current_guest.guestIp))]),e("el-descriptions-item",{attrs:{label:"状态"}},[e("el-tag",{attrs:{type:2===t.show_guest_info.current_guest.status?"success":"danger"}},[t._v(t._s(t.get_guest_status(t.show_guest_info.current_guest)))])],1)],1)],1),e("br"),e("el-row",[e("el-tabs",{attrs:{type:"border-card"}},[e("el-tab-pane",{attrs:{label:"磁盘"}},[e("el-table",{staticStyle:{width:"100%"},attrs:{"v-loading":t.show_guest_info.volume_loading,data:t.show_guest_info.volumes}},[e("el-table-column",{attrs:{label:"ID",prop:"volumeId",width:"80"}}),e("el-table-column",{attrs:{label:"描述",prop:"description",width:"200"}}),e("el-table-column",{attrs:{label:"容量",prop:"capacity",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.get_volume_desplay_size(e.row.capacity))+" ")]}}])}),e("el-table-column",{attrs:{label:"已使用",prop:"allocation",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.get_volume_desplay_size(e.row.allocation))+" ")]}}])}),e("el-table-column",{attrs:{label:"路径",prop:"path","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:t._u([{key:"default",fn:function(o){return[e("el-link",{attrs:{type:"primary",href:"/#/Volume?id=".concat(o.row.volumeId)}},[t._v("详情")]),e("el-link",{staticStyle:{"margin-left":"10px"},attrs:{type:"danger",disabled:0===o.row.attach.deviceId},on:{click:function(e){return t.detach_volume_click(o.row)}}},[t._v("卸载磁盘")])]}}])})],1)],1),e("el-tab-pane",{attrs:{label:"网卡"}},[e("el-table",{staticStyle:{width:"100%"},attrs:{"v-loading":t.show_guest_info.network_loading,data:t.show_guest_info.networks}},[e("el-table-column",{attrs:{label:"MAC",prop:"mac",width:"200"}}),e("el-table-column",{attrs:{label:"IP",prop:"ip",width:"200"}}),e("el-table-column",{attrs:{label:"驱动类型",prop:"driveType",width:"150"}}),e("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(o){return[e("el-link",{attrs:{type:"danger",disabled:0===o.row.deviceId},on:{click:function(e){return t.detach_network_click(o.row)}}},[t._v("卸载网卡")])]}}])})],1)],1)],1)],1)],1),e("ReInstallComponentVue",{directives:[{name:"show",rawName:"v-show",value:1===t.show_type,expression:"show_type === 1"}],ref:"ReInstallComponentVueRef",on:{back:function(e){t.show_type=0},finish:t.on_finish_reinstall}}),e("HostInfoComponent",{directives:[{name:"show",rawName:"v-show",value:2===this.show_type,expression:"this.show_type === 2"}],ref:"HostInfoComponentRef",on:{back:t.show_host_return}}),e("SchemeInfoComponent",{directives:[{name:"show",rawName:"v-show",value:3===this.show_type,expression:"this.show_type === 3"}],ref:"SchemeInfoComponentRef",on:{back:t.show_scheme_return}}),e("AttachDiskComponent",{ref:"AttachDiskComponentRef",on:{onVoumeAttachCallBack:t.on_volume_attach_callback}}),e("AttachCdRoomComponent",{ref:"AttachCdRoomComponentRef",on:{onGuestUpdate:t.on_notify_update_guest_info}}),e("AttachNetworkComponent",{ref:"AttachNetworkComponentRef",on:{onGuestAttachCallback:t.on_network_attach_callback}}),e("ModifyGuestComponent",{ref:"ModifyGuestComponentRef",on:{onGuestUpdate:t.on_notify_update_guest_info}}),e("StartGuestComponent",{ref:"StartGuestComponentRef",on:{onGuestUpdate:t.on_notify_update_guest_info}}),e("StopGuestComponent",{ref:"StopGuestComponentRef",on:{onGuestUpdate:t.on_notify_update_guest_info}})],1)}),$=[],S=(o(56977),function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{title:"挂载磁盘",visible:t.attach_volume_dialog_visiable,width:"400px"},on:{"update:visible":function(e){t.attach_volume_dialog_visiable=e}}},[e("el-form",{attrs:{model:t.attach_volume_guest,"label-width":"100px"}},[e("el-form-item",{attrs:{label:"磁盘"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择磁盘"},model:{value:t.attach_volume_guest.volumeId,callback:function(e){t.$set(t.attach_volume_guest,"volumeId",e)},expression:"attach_volume_guest.volumeId"}},t._l(this.attach_volumes,(function(t){return e("el-option",{key:t.volumeId,attrs:{label:t.description,value:t.volumeId}})})),1)],1)],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.attach_volume_dialog_visiable=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.attach_volume_click}},[t._v("确 定")])],1)],1)}),C=[];const Z={data:function(){return{attach_volume_dialog_visiable:!1,attach_volumes:[],attach_volume_guest:{guestId:0,volumeId:""}}},methods:{load_all_attach_volumes:function(){var t=this;return(0,x.Z)((0,I.Z)().mark((function e(){return(0,I.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Do().then((function(e){0===e.code&&(t.attach_volumes=e.data)}));case 2:case"end":return e.stop()}}),e)})))()},init:function(t){var e=this;return(0,x.Z)((0,I.Z)().mark((function o(){return(0,I.Z)().wrap((function(o){while(1)switch(o.prev=o.next){case 0:return e.attach_volume_guest.guestId=t.guestId,e.attach_volume_guest.volumeId="",e.attach_volume_dialog_visiable=!0,o.next=5,e.load_all_attach_volumes();case 5:case"end":return o.stop()}}),o)})))()},attach_volume_click:function(){var t=this;ws(this.attach_volume_guest).then((function(e){0===e.code?(t.$emit("onVoumeAttachCallBack",e.data.guest,e.data.volume),t.attach_volume_dialog_visiable=!1):t.$notify.error({title:"错误",message:" 挂载磁盘失败:".concat(e.message)})}))}}},z=Z;var q=(0,u.Z)(z,S,C,!1,null,null,null);const B=q.exports;var N=function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{title:"挂载光驱",visible:t.attach_cd_room_dialog_visiable,width:"400px"},on:{"update:visible":function(e){t.attach_cd_room_dialog_visiable=e}}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择光盘镜像"},model:{value:t.attach_cd_room_guest.templateId,callback:function(e){t.$set(t.attach_cd_room_guest,"templateId",e)},expression:"attach_cd_room_guest.templateId"}},t._l(this.iso_template,(function(t){return e("el-option",{key:t.templateId,attrs:{label:t.name,value:t.templateId}})})),1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.attach_cd_room_dialog_visiable=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.attach_cd_room_guest_click}},[t._v("确 定")])],1)],1)},P=[];o(57327);const F={data:function(){return{attach_cd_room_dialog_visiable:!1,iso_template:[],attach_cd_room_guest:{guestId:0,templateId:""}}},methods:{init:function(t){var e=this;return(0,x.Z)((0,I.Z)().mark((function o(){return(0,I.Z)().wrap((function(o){while(1)switch(o.prev=o.next){case 0:return e.attach_cd_room_guest.guestId=t.guestId,e.attach_cd_room_guest.templateId="",e.attach_cd_room_dialog_visiable=!0,o.next=5,e.load_iso_template();case 5:case"end":return o.stop()}}),o)})))()},load_iso_template:function(){var t=this;return(0,x.Z)((0,I.Z)().mark((function e(){return(0,I.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Zo().then((function(e){0===e.code&&(t.iso_template=e.data.filter((function(t){return 0==t.templateType&&2===t.status})))}));case 2:case"end":return e.stop()}}),e)})))()},attach_cd_room_guest_click:function(){var t=this;ms(this.attach_cd_room_guest).then((function(e){0===e.code?(t.$emit("onGuestUpdate",e.data),t.attach_cd_room_dialog_visiable=!1):t.$notify.error({title:"错误",message:"挂载虚拟机光驱失败:".concat(e.message)})}))}}},V=F;var G=(0,u.Z)(V,N,P,!1,null,null,null);const M=G.exports;var R=function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{title:"挂载网卡",visible:t.attach_network_dialog_visiable,width:"400px"},on:{"update:visible":function(e){t.attach_network_dialog_visiable=e}}},[e("el-form",{attrs:{model:t.attach_network_guest,"label-width":"100px"}},[e("el-form-item",{attrs:{label:"网络"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择网络"},model:{value:t.attach_network_guest.networkId,callback:function(e){t.$set(t.attach_network_guest,"networkId",e)},expression:"attach_network_guest.networkId"}},t._l(this.networks,(function(t){return e("el-option",{key:t.networkId,attrs:{label:t.name,value:t.networkId}})})),1)],1),e("el-form-item",{attrs:{label:"驱动"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择网卡驱动"},model:{value:t.attach_network_guest.driveType,callback:function(e){t.$set(t.attach_network_guest,"driveType",e)},expression:"attach_network_guest.driveType"}},[e("el-option",{attrs:{label:"virtio",value:"virtio"}}),e("el-option",{attrs:{label:"rtl8139",value:"rtl8139"}})],1)],1)],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.attach_network_dialog_visiable=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.attach_network_click}},[t._v("确 定")])],1)],1)},D=[];const U={data:function(){return{attach_network_dialog_visiable:!1,networks:[],attach_network_guest:{guestId:0,networkId:"",driveType:"virtio"}}},methods:{init:function(t){var e=this;return(0,x.Z)((0,I.Z)().mark((function o(){return(0,I.Z)().wrap((function(o){while(1)switch(o.prev=o.next){case 0:return e.attach_network_guest.guestId=t.guestId,e.attach_network_guest.networkId="",e.attach_network_dialog_visiable=!0,o.next=5,e.load_all_networks();case 5:case"end":return o.stop()}}),o)})))()},load_all_networks:function(){var t=this;return(0,x.Z)((0,I.Z)().mark((function e(){return(0,I.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,uo().then((function(e){0===e.code&&(t.networks=e.data.filter((function(t){return 2===t.status})))}));case 2:case"end":return e.stop()}}),e)})))()},attach_network_click:function(){var t=this;vs(this.attach_network_guest).then((function(e){0===e.code?(t.$emit("onGuestAttachCallback",e.data.guest,e.data.network),t.attach_network_dialog_visiable=!1):t.$notify.error({title:"错误",message:"虚拟机附加网卡失败:".concat(e.message)})}))}}},O=U;var E=(0,u.Z)(O,R,D,!1,null,null,null);const L=E.exports;var A=function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{title:"修改配置",visible:t.modify_guest_dialog_visiable,width:"400px"},on:{"update:visible":function(e){t.modify_guest_dialog_visiable=e}}},[e("el-form",{attrs:{model:t.modify_guest,"label-width":"100px"}},[e("el-form-item",{attrs:{label:"名称",prop:"description"}},[e("el-input",{model:{value:t.modify_guest.description,callback:function(e){t.$set(t.modify_guest,"description",e)},expression:"modify_guest.description"}})],1),e("el-form-item",{attrs:{label:"总线方式"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"总线方式"},model:{value:t.modify_guest.busType,callback:function(e){t.$set(t.modify_guest,"busType",e)},expression:"modify_guest.busType"}},[e("el-option",{attrs:{label:"virtio",value:"virtio"}}),e("el-option",{attrs:{label:"ide",value:"ide"}}),e("el-option",{attrs:{label:"scsi",value:"scsi"}})],1)],1),e("el-form-item",{attrs:{label:"计算方案"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择计算方案"},model:{value:t.modify_guest.schemeId,callback:function(e){t.$set(t.modify_guest,"schemeId",e)},expression:"modify_guest.schemeId"}},t._l(this.schemes,(function(t){return e("el-option",{key:t.schemeId,attrs:{label:t.name,value:t.schemeId}})})),1)],1)],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.modify_guest_dialog_visiable=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.modify_guest_click}},[t._v("确 定")])],1)],1)},H=[];const j={data:function(){return{modify_guest_dialog_visiable:!1,schemes:[],modify_guest:{guestId:0,busType:"",description:"",schemeId:""}}},methods:{init:function(t){var e=this;return(0,x.Z)((0,I.Z)().mark((function o(){return(0,I.Z)().wrap((function(o){while(1)switch(o.prev=o.next){case 0:return e.modify_guest.guestId=t.guestId,e.modify_guest.description=t.description,e.modify_guest.schemeId=t.schemeId,e.modify_guest.busType=t.busType,e.modify_guest_dialog_visiable=!0,o.next=7,e.load_all_schemes();case 7:case"end":return o.stop()}}),o)})))()},load_all_schemes:function(){var t=this;return(0,x.Z)((0,I.Z)().mark((function e(){return(0,I.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Ko().then((function(e){0===e.code&&(t.schemes=e.data)}));case 2:case"end":return e.stop()}}),e)})))()},modify_guest_click:function(){var t=this;hs(this.modify_guest).then((function(e){0===e.code?(t.$emit("onGuestUpdate",e.data),t.modify_guest_dialog_visiable=!1):t.$notify.error({title:"错误",message:" 修改主机信息失败:".concat(e.message)})}))}}},K=j;var X=(0,u.Z)(K,A,H,!1,null,null,null);const J=X.exports;var Q=function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{title:"启动虚拟机",visible:t.start_dialog_visiable,width:"400px"},on:{"update:visible":function(e){t.start_dialog_visiable=e}}},[e("el-form",{attrs:{model:t.start_guest,"label-width":"100px"}},[e("el-form-item",{attrs:{label:"选择主机"}},[e("el-select",{staticStyle:{width:"100%"},model:{value:t.start_guest.hostId,callback:function(e){t.$set(t.start_guest,"hostId",e)},expression:"start_guest.hostId"}},[e("el-option",{attrs:{label:"随机",value:0}}),t._l(this.hosts,(function(t){return e("el-option",{key:t.hostId,attrs:{label:t.displayName,value:t.hostId,"v-loading":!0}})}))],2)],1)],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.start_dialog_visiable=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.start_guest_click}},[t._v("确 定")])],1)],1)},W=[];const Y={data:function(){return{start_dialog_visiable:!1,start_guest:{hostId:0,guestId:0},hosts:[]}},methods:{init:function(t){var e=this;return(0,x.Z)((0,I.Z)().mark((function o(){return(0,I.Z)().wrap((function(o){while(1)switch(o.prev=o.next){case 0:return e.start_guest.guestId=t.guestId,e.start_guest.hostId=0,e.start_dialog_visiable=!0,o.next=5,e.load_all_host();case 5:case"end":return o.stop()}}),o)})))()},load_all_host:function(){var t=this;return(0,x.Z)((0,I.Z)().mark((function e(){return(0,I.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,wo().then((function(e){0===e.code&&(t.hosts=e.data.filter((function(t){return 1==t.status})))}));case 2:case"end":return e.stop()}}),e)})))()},start_guest_click:function(){var t=this;cs(this.start_guest).then((function(e){0===e.code?(t.$emit("onGuestUpdate",e.data),t.start_dialog_visiable=!1):t.$notify.error({title:"错误",message:"启动虚拟机失败:".concat(e.message)})}))}}},tt=Y;var et=(0,u.Z)(tt,Q,W,!1,null,null,null);const ot=et.exports;var st=function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{title:"关闭虚拟机",visible:t.stop_dialog_visiable,width:"400px"},on:{"update:visible":function(e){t.stop_dialog_visiable=e}}},[e("el-checkbox",{model:{value:t.stop_guest.force,callback:function(e){t.$set(t.stop_guest,"force",e)},expression:"stop_guest.force"}},[t._v("强制关闭")]),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.stop_dialog_visiable=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.stop_guest_click}},[t._v("确 定")])],1)],1)},at=[];const nt={data:function(){return{stop_dialog_visiable:!1,stop_guest:{hostId:0,force:!1}}},methods:{init:function(t){var e=this;return(0,x.Z)((0,I.Z)().mark((function o(){return(0,I.Z)().wrap((function(o){while(1)switch(o.prev=o.next){case 0:e.stop_guest.guestId=t.guestId,e.stop_guest.force=!1,e.stop_dialog_visiable=!0;case 3:case"end":return o.stop()}}),o)})))()},stop_guest_click:function(){var t=this;this.$confirm("停止当前虚拟机, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){ds(t.stop_guest).then((function(e){0===e.code?(t.$emit("onGuestUpdate",e.data),t.stop_dialog_visiable=!1):t.$notify.error({title:"错误",message:"启动虚拟机失败:".concat(e.message)})}))}))["catch"]((function(){}))}}},rt=nt;var it=(0,u.Z)(rt,st,at,!1,null,null,null);const lt=it.exports;var ct=function(){var t=this,e=t._self._c;return e("el-card",{staticClass:"box-card"},[e("el-row",{attrs:{slot:"header"},slot:"header"},[e("el-page-header",{staticStyle:{color:"#409eff"},attrs:{content:"重装虚拟机"},on:{back:t.on_back_click}})],1),e("el-row",[e("el-form",{ref:"reInstallForm",staticClass:"demo-ruleForm",attrs:{model:t.reinstall_guest,"label-width":"100px"}},[e("el-row",[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"安装方式"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择安装方式"},model:{value:t.reinstall_guest.type,callback:function(e){t.$set(t.reinstall_guest,"type",e)},expression:"reinstall_guest.type"}},[e("el-option",{attrs:{label:"ISO镜像",value:0}}),e("el-option",{attrs:{label:"模版安装",value:1}}),e("el-option",{attrs:{label:"快照安装",value:2}}),e("el-option",{attrs:{label:"现有磁盘",value:3}})],1)],1)],1),e("el-col",{attrs:{span:12}},[3!==t.reinstall_guest.type?e("el-form-item",{attrs:{label:"磁盘类型"}},[e("el-select",{staticStyle:{width:"100%"},model:{value:t.reinstall_guest.volumeType,callback:function(e){t.$set(t.reinstall_guest,"volumeType",e)},expression:"reinstall_guest.volumeType"}},[e("el-option",{attrs:{label:"raw",value:"raw"}}),e("el-option",{attrs:{label:"qcow",value:"qcow"}}),e("el-option",{attrs:{label:"qcow2",value:"qcow2"}}),e("el-option",{attrs:{label:"vdi",value:"vdi"}}),e("el-option",{attrs:{label:"vmdk",value:"vmdk"}}),e("el-option",{attrs:{label:"vpc",value:"vpc"}})],1)],1):t._e()],1)],1),e("el-row",[e("el-col",{attrs:{span:12}},[0===t.reinstall_guest.type?e("el-form-item",{attrs:{label:"ISO模版"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择光盘镜像"},model:{value:t.reinstall_guest.isoTemplateId,callback:function(e){t.$set(t.reinstall_guest,"isoTemplateId",e)},expression:"reinstall_guest.isoTemplateId"}},t._l(this.iso_template,(function(t){return e("el-option",{key:t.templateId,attrs:{label:t.name,value:t.templateId}})})),1)],1):t._e(),1===t.reinstall_guest.type?e("el-form-item",{attrs:{label:"系统模版"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择模版"},model:{value:t.reinstall_guest.diskTemplateId,callback:function(e){t.$set(t.reinstall_guest,"diskTemplateId",e)},expression:"reinstall_guest.diskTemplateId"}},t._l(this.disk_template,(function(t){return e("el-option",{key:t.templateId,attrs:{label:t.name,value:t.templateId}})})),1)],1):t._e(),2===t.reinstall_guest.type?e("el-form-item",{attrs:{label:"快照模版"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择系统快照"},model:{value:t.reinstall_guest.snapshotVolumeId,callback:function(e){t.$set(t.reinstall_guest,"snapshotVolumeId",e)},expression:"reinstall_guest.snapshotVolumeId"}},t._l(this.snapshot_template,(function(t){return e("el-option",{key:t.snapshotVolumeId,attrs:{label:t.name,value:t.snapshotVolumeId}})})),1)],1):t._e(),3===t.reinstall_guest.type?e("el-form-item",{attrs:{label:"可用磁盘"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择系统磁盘"},model:{value:t.reinstall_guest.volumeId,callback:function(e){t.$set(t.reinstall_guest,"volumeId",e)},expression:"reinstall_guest.volumeId"}},t._l(this.attach_volumes,(function(t){return e("el-option",{key:t.volumeId,attrs:{label:t.description,value:t.volumeId}})})),1)],1):t._e()],1),e("el-col",{attrs:{span:12}},[3!==t.reinstall_guest.type?e("el-form-item",{attrs:{label:"存储池"}},[e("el-select",{staticStyle:{width:"100%"},model:{value:t.reinstall_guest.storageId,callback:function(e){t.$set(t.reinstall_guest,"storageId",e)},expression:"reinstall_guest.storageId"}},[e("el-option",{attrs:{label:"随机",value:0}}),t._l(this.storages,(function(t){return e("el-option",{key:t.storageId,attrs:{label:t.description,value:t.storageId}})}))],2)],1):t._e()],1)],1),0===t.reinstall_guest.type?e("el-form-item",{attrs:{label:"磁盘大小"}},[e("el-input",{model:{value:t.reinstall_guest.size,callback:function(e){t.$set(t.reinstall_guest,"size",e)},expression:"reinstall_guest.size"}})],1):t._e(),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:t.reinstall_guest_click}},[t._v("立即重装")]),e("el-button",{on:{click:t.on_back_click}},[t._v("取消")])],1)],1)],1)],1)},ut=[];const dt={data:function(){return{reinstall_guest:{guestId:0,type:0,volumeType:"qcow2",isoTemplateId:"",diskTemplateId:"",snapshotVolumeId:"",volumeId:"",storageId:0,size:100},iso_template:[],attach_volumes:[],disk_template:[],storages:[],snapshot_template:[]}},methods:{on_back_click:function(){this.$emit("back")},load_all_attach_volumes:function(){var t=this;return(0,x.Z)((0,I.Z)().mark((function e(){return(0,I.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Do().then((function(e){0===e.code&&(t.attach_volumes=e.data)}));case 2:case"end":return e.stop()}}),e)})))()},load_all_template:function(){var t=this;return(0,x.Z)((0,I.Z)().mark((function e(){return(0,I.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Zo().then((function(e){0===e.code&&(t.iso_template=e.data.filter((function(t){return 0==t.templateType&&2===t.status})),t.disk_template=e.data.filter((function(t){return 2==t.templateType&&2===t.status})))}));case 2:case"end":return e.stop()}}),e)})))()},load_all_storage:function(){var t=this;return(0,x.Z)((0,I.Z)().mark((function e(){return(0,I.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Io().then((function(e){0==e.code&&(t.storages=e.data.filter((function(t){return 1==t.status})))}));case 2:case"end":return e.stop()}}),e)})))()},load_all_snapshot:function(){var t=this;return(0,x.Z)((0,I.Z)().mark((function e(){return(0,I.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Fo().then((function(e){0==e.code&&(t.snapshot_template=e.data.filter((function(t){return 1==t.status})))}));case 2:case"end":return e.stop()}}),e)})))()},init:function(t){var e=this;return(0,x.Z)((0,I.Z)().mark((function o(){return(0,I.Z)().wrap((function(o){while(1)switch(o.prev=o.next){case 0:e.show_type=0,e.load_all_attach_volumes(),e.load_all_template(),e.load_all_storage(),e.load_all_snapshot(),e.reinstall_guest.guestId=t.guestId,e.reinstall_guest.isoTemplateId="",e.reinstall_guest.diskTemplateId="",e.reinstall_guest.snapshotVolumeId="",e.reinstall_guest.volumeId="",e.reinstall_guest.type=0;case 11:case"end":return o.stop()}}),o)})))()},reinstall_guest_click:function(){var t=this;switch(this.reinstall_guest.type){case 0:this.reinstall_guest.diskTemplateId=0,this.reinstall_guest.snapshotVolumeId=0,this.reinstall_guest.volumeId=0;break;case 1:this.reinstall_guest.isoTemplateId=0,this.reinstall_guest.snapshotVolumeId=0,this.reinstall_guest.volumeId=0,this.reinstall_guest.size=0;break;case 2:this.reinstall_guest.isoTemplateId=0,this.reinstall_guest.diskTemplateId=0,this.reinstall_guest.volumeId=0,this.reinstall_guest.size=0;break;case 3:this.reinstall_guest.isoTemplateId=0,this.reinstall_guest.diskTemplateId=0,this.reinstall_guest.snapshotVolumeId=0,this.reinstall_guest.size=0;break}this.$confirm("重装虚拟机, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){ls(t.reinstall_guest).then((function(e){0===e.code?t.$emit("finish",e.data):t.$notify.error({title:"错误",message:"重装虚拟机失败:".concat(e.message)})}))}))["catch"]((function(){}))}}},_t=dt;var pt=(0,u.Z)(_t,ct,ut,!1,null,null,null);const ht=pt.exports;var mt=function(){var t=this,e=t._self._c;return e("el-card",{staticClass:"box-card"},[e("el-row",{attrs:{slot:"header"},slot:"header"},[e("el-page-header",{directives:[{name:"loading",rawName:"v-loading",value:t.host_loading,expression:"host_loading"}],attrs:{content:"主机详情"},on:{back:t.on_back_click}})],1),e("el-row",{staticStyle:{"text-align":"left",margin:"20px 0"}},[e("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(e){return t.register_host(t.show_host)}}},[t._v("重新注册")]),3!==t.show_host.status?e("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(e){return t.pasue_host(t.show_host)}}},[t._v("开始维护")]):t._e(),e("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){return t.destroy_host(t.show_host)}}},[t._v("销毁主机")])],1),e("el-row",[e("el-descriptions",{attrs:{column:2,size:"medium",border:""}},[e("el-descriptions-item",{attrs:{label:"ID"}},[t._v(t._s(t.show_host.hostId))]),e("el-descriptions-item",{attrs:{label:"主机名"}},[t._v(t._s(t.show_host.hostName))]),e("el-descriptions-item",{attrs:{label:"显示名称"}},[t._v(t._s(t.show_host.displayName))]),e("el-descriptions-item",{attrs:{label:"主机IP"}},[t._v(t._s(t.show_host.hostIp))]),e("el-descriptions-item",{attrs:{label:"网卡名称"}},[t._v(t._s(t.show_host.nic))]),e("el-descriptions-item",{attrs:{label:"通信地址"}},[t._v(t._s(t.show_host.uri))]),e("el-descriptions-item",{attrs:{label:"主机架构"}},[t._v(t._s(t.show_host.arch))]),e("el-descriptions-item",{attrs:{label:"虚拟化类型"}},[t._v(t._s(t.show_host.hypervisor))]),e("el-descriptions-item",{attrs:{label:"内存"}},[e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"已使用:"+t.get_memory_desplay(t.show_host.allocationMemory)+" / 总共:"+t.get_memory_desplay(t.show_host.totalMemory),placement:"top"}},[e("el-progress",{attrs:{color:"#67C23A",percentage:t.show_host.totalMemory<=0?0:Math.floor(100*t.show_host.allocationMemory/t.show_host.totalMemory)}})],1)],1),e("el-descriptions-item",{attrs:{label:"CPU"}},[e("el-tooltip",{staticClass:"item",staticStyle:{width:"150px"},attrs:{effect:"dark",content:"已使用:"+t.show_host.allocationCpu+"核 / 总共:"+t.show_host.totalCpu+"核",placement:"top"}},[e("el-progress",{attrs:{color:"#67C23A",percentage:t.show_host.totalCpu<=0?0:Math.floor(100*t.show_host.allocationCpu/t.show_host.totalCpu)}})],1)],1),e("el-descriptions-item",{attrs:{label:"Cores"}},[t._v(t._s(t.show_host.cores))]),e("el-descriptions-item",{attrs:{label:"Sockets"}},[t._v(t._s(t.show_host.sockets))]),e("el-descriptions-item",{attrs:{label:"Threads"}},[t._v(t._s(t.show_host.threads))]),e("el-descriptions-item",{attrs:{label:"Eemulator"}},[t._v(t._s(t.show_host.emulator))]),e("el-descriptions-item",{attrs:{label:"状态"}},[e("el-tag",{attrs:{type:1===t.show_host.status?"success":"danger"}},[t._v(t._s(t.get_host_status(t.show_host)))])],1)],1)],1)],1)},ft=[];const wt={data:function(){return{host_loading:!1,show_host:{hostId:0,displayName:"",hostIp:"127.0.0.1",hostName:"-",nic:"-",uri:"http://127.0.0.1:8081",allocationMemory:0,allocationCpu:0,totalMemory:0,totalCpu:0,arch:"-",hypervisor:"QEMU",emulator:"-",cores:0,threads:0,sockets:0,status:1}}},methods:{on_back_click:function(){this.$emit("back")},on_notify_update_host_info:function(t){this.refresh_host(t),this.$emit("onHostUpdate",t)},get_host_status:function(t){switch(t.status){case 0:return"正在创建";case 1:return"在线";case 2:return"离线";case 3:return"正在维护";case 4:return"主机错误";default:return"未知状态[".concat(t.status,"]")}},get_memory_desplay:function(t){return t>1048576?(t/1048576).toFixed(2)+" GB":t>1024?(t/1024).toFixed(0)+"  MB":t+" KB"},init_host:function(t){this.show_host=t,this.host_loading=!1},refresh_host:function(t){this.show_host.hostId===t.hostId&&(this.show_host=t)},init:function(t){var e=this;return(0,x.Z)((0,I.Z)().mark((function o(){return(0,I.Z)().wrap((function(o){while(1)switch(o.prev=o.next){case 0:return e.host_loading=!0,o.next=3,go({hostId:t}).then((function(t){console.log(t),0===t.code?e.init_host(t.data):e.$alert("获取主机信息失败:".concat(t.message),"提示",{dangerouslyUseHTMLString:!0,confirmButtonText:"返回",type:"error"}).then((function(){e.on_back_click()}))["catch"]((function(){e.on_back_click()}))}))["finally"]((function(){e.host_loading=!1}));case 3:case"end":return o.stop()}}),o)})))()},pasue_host:function(t){var e=this;this.$confirm("维护主机, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){yo({hostId:t.hostId}).then((function(t){0===t.code?e.on_notify_update_host_info(t.data):e.$notify.error({title:"错误",message:"暂停主机失败:".concat(t.message)})}))}))["catch"]((function(){}))},register_host:function(t){var e=this;this.$confirm("重新注册主机, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){bo({hostId:t.hostId}).then((function(t){0===t.code?e.on_notify_update_host_info(t.data):e.$notify.error({title:"错误",message:"注册主机失败:".concat(t.message)})}))}))["catch"]((function(){}))},destroy_host:function(t){var e=this;this.$confirm("删除当前主机, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){ko({hostId:t.hostId}).then((function(t){0===t.code?e.on_back_click():e.$notify.error({title:"错误",message:"删除主机失败:".concat(t.message)})}))}))["catch"]((function(){}))}}},gt=wt;var vt=(0,u.Z)(gt,mt,ft,!1,null,null,null);const yt=vt.exports;var bt=function(){var t=this,e=t._self._c;return e("el-card",{staticClass:"box-card"},[e("el-row",{attrs:{slot:"header"},slot:"header"},[e("el-page-header",{directives:[{name:"loading",rawName:"v-loading",value:t.schme_loading,expression:"schme_loading"}],attrs:{content:"计算方案详情"},on:{back:t.on_back_click}})],1),e("el-row",{staticStyle:{"text-align":"left",margin:"20px 0"}},[e("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){return t.destroy_scheme(t.show_scheme)}}},[t._v("删除")])],1),e("el-row",[e("el-descriptions",{attrs:{column:2,size:"medium",border:""}},[e("el-descriptions-item",{attrs:{label:"ID"}},[t._v(t._s(t.show_scheme.schemeId))]),e("el-descriptions-item",{attrs:{label:"名称"}},[t._v(t._s(t.show_scheme.name))]),e("el-descriptions-item",{attrs:{label:"配额"}},[t._v(t._s(t.show_scheme.speed))]),e("el-descriptions-item",{attrs:{label:"CPU"}},[t._v(t._s(t.show_scheme.cpu))]),e("el-descriptions-item",{attrs:{label:"内存"}},[t._v(t._s(t.get_memory_desplay(t.show_scheme.memory)))]),e("el-descriptions-item",{attrs:{label:"Cores"}},[t._v(t._s(t.show_scheme.cores))]),e("el-descriptions-item",{attrs:{label:"Sockets"}},[t._v(t._s(t.show_scheme.sockets))]),e("el-descriptions-item",{attrs:{label:"Threads"}},[t._v(t._s(t.show_scheme.threads))])],1)],1)],1)},kt=[];o(91058);const It={data:function(){return{schme_loading:!1,show_scheme:{schemeId:0,name:"-",cpu:0,memory:0,speed:0,sockets:0,cores:0,threads:0}}},methods:{on_back_click:function(){this.$emit("back")},on_notify_update_scheme_info:function(t){this.refresh_scheme(t),this.$emit("onSchemeUpdate",t)},refresh_scheme:function(t){this.show_scheme.schemeId===t.schemeId&&(this.show_scheme=t)},init_scheme:function(t){this.show_scheme=t,this.schme_loading=!1},get_memory_desplay:function(t){return t>=1048576?parseInt(t/1048576)+" GB":t>=1024?parseInt(t/1024)+"  MB":void 0},init:function(t){var e=this;return(0,x.Z)((0,I.Z)().mark((function o(){return(0,I.Z)().wrap((function(o){while(1)switch(o.prev=o.next){case 0:return e.schme_loading=!0,o.next=3,Xo({schemeId:t}).then((function(t){console.log(t),0===t.code?e.init_scheme(t.data):e.$alert("获取计算方案信息失败:".concat(t.message),"提示",{dangerouslyUseHTMLString:!0,confirmButtonText:"返回",type:"error"}).then((function(){e.on_back_click()}))["catch"]((function(){e.on_back_click()}))}))["finally"]((function(){e.host_loading=!1}));case 3:case"end":return o.stop()}}),o)})))()},destroy_scheme:function(t){var e=this;this.$confirm("删除计算方案, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Wo({schemeId:t.schemeId}).then((function(t){0===t.code?e.on_back_click():e.$notify.error({title:"错误",message:"删除计算方案失败:".concat(t.message)})}))}))["catch"]((function(){}))}}},xt=It;var Tt=(0,u.Z)(xt,bt,kt,!1,null,null,null);const $t=Tt.exports,St={components:{AttachDiskComponent:B,AttachCdRoomComponent:M,AttachNetworkComponent:L,ModifyGuestComponent:J,StartGuestComponent:ot,StopGuestComponent:lt,ReInstallComponentVue:ht,HostInfoComponent:yt,SchemeInfoComponent:$t},data:function(){return{show_type:0,guest_loading:!1,show_guest_info:{guestId:0,volume_loading:!1,network_loading:!1,guest_loading:!0,current_guest:{guestId:0,name:"",description:"",busType:"virtio",cpu:1,memory:524288,speed:500,cdRoom:0,hostId:0,schemeId:0,type:0,networkId:0,status:1,guestIp:""},host:{hostId:0,displayName:"-"},template:{templateId:0,name:"-"},scheme:{schemeId:0,name:"-"},volumes:[],networks:[]}}},methods:{on_volume_attach_callback:function(t,e){this.update_guest_info(t),this.show_guest_info.volumes.push(e)},on_network_attach_callback:function(t,e){this.update_guest_info(t),this.show_guest_info.networks.push(e)},show_host_return:function(){this.show_type=0},show_scheme_return:function(){this.show_type=0},show_host_info:function(t){this.show_type=2,this.$refs.HostInfoComponentRef.init(t)},show_scheme_info:function(t){this.show_type=3,this.$refs.SchemeInfoComponentRef.init(t)},on_back_click:function(){this.$emit("back")},on_notify_update_guest_info:function(t){this.$emit("onGuestUpdate",t)},show_reinstall_guest_click:function(t){this.$refs.ReInstallComponentVueRef.init(t),this.show_type=1},on_finish_reinstall:function(t){this.show_type=0,this.on_notify_update_guest_info(t)},refresh_host:function(t){this.$refs.HostInfoComponentRef.refresh_host(t)},refresh_scheme:function(t){this.$refs.SchemeInfoComponentRef.refresh_scheme(t)},init:function(t){var e=this;return(0,x.Z)((0,I.Z)().mark((function o(){return(0,I.Z)().wrap((function(o){while(1)switch(o.prev=o.next){case 0:return e.show_type=0,e.guest_loading=!1,e.show_guest_info.guestId=t.guestId,e.show_guest_info.current_guest=t,o.next=6,e.load_current_guest_template(t);case 6:return o.next=8,e.load_current_guest_host(t);case 8:return o.next=10,e.load_current_guest_scheme(t);case 10:return o.next=12,e.load_current_guest_volume(t);case 12:return o.next=14,e.load_current_guest_network(t);case 14:case"end":return o.stop()}}),o)})))()},initGuestId:function(t){var e=this;return(0,x.Z)((0,I.Z)().mark((function o(){return(0,I.Z)().wrap((function(o){while(1)switch(o.prev=o.next){case 0:return e.show_type=0,e.guest_loading=!0,o.next=4,Yo({guestId:t}).then((function(t){0===t.code?e.init(t.data):e.$alert("获取虚拟机信息失败:".concat(t.message),"提示",{dangerouslyUseHTMLString:!0,confirmButtonText:"返回",type:"error"}).then((function(){e.on_back_click()}))["catch"]((function(){e.on_back_click()}))}))["finally"]((function(){e.guest_loading=!1}));case 4:case"end":return o.stop()}}),o)})))()},load_current_guest_template:function(t){var e=this;return(0,x.Z)((0,I.Z)().mark((function o(){return(0,I.Z)().wrap((function(o){while(1)switch(o.prev=o.next){case 0:if(e.show_guest_info.template.templateId=t.cdRoom,e.show_guest_info.template.name="-",!(e.show_guest_info.template.templateId>0)){o.next=5;break}return o.next=5,zo({templateId:t.cdRoom}).then((function(t){0===t.code&&(e.show_guest_info.template.name=t.data.name)}));case 5:case"end":return o.stop()}}),o)})))()},load_current_guest_scheme:function(t){var e=this;return(0,x.Z)((0,I.Z)().mark((function o(){return(0,I.Z)().wrap((function(o){while(1)switch(o.prev=o.next){case 0:if(e.show_guest_info.scheme.schemeId=t.schemeId,e.show_guest_info.scheme.name="-",!(e.show_guest_info.scheme.schemeId>0)){o.next=5;break}return o.next=5,Xo({schemeId:t.schemeId}).then((function(t){0===t.code&&(e.show_guest_info.scheme.name=t.data.name)}));case 5:case"end":return o.stop()}}),o)})))()},load_current_guest_host:function(t){var e=this;return(0,x.Z)((0,I.Z)().mark((function o(){return(0,I.Z)().wrap((function(o){while(1)switch(o.prev=o.next){case 0:if(e.show_guest_info.host.hostId=t.hostId,e.show_guest_info.host.displayName="-",!(e.show_guest_info.host.hostId>0)){o.next=5;break}return o.next=5,go({hostId:t.hostId}).then((function(t){0===t.code&&(e.show_guest_info.host.displayName=t.data.displayName)}));case 5:case"end":return o.stop()}}),o)})))()},load_current_guest_volume:function(t){var e=this;this.show_guest_info.volume_loading=!0,es({guestId:t.guestId}).then((function(t){0===t.code&&(e.show_guest_info.volumes=t.data)}))["finally"]((function(){e.show_guest_info.volume_loading=!1}))},load_current_guest_network:function(t){var e=this;this.show_guest_info.network_loading=!0,os({guestId:t.guestId}).then((function(t){0===t.code&&(e.show_guest_info.networks=t.data)}))["finally"]((function(){e.show_guest_info.network_loading=!1}))},update_guest_info:function(t){var e=this;return(0,x.Z)((0,I.Z)().mark((function o(){return(0,I.Z)().wrap((function(o){while(1)switch(o.prev=o.next){case 0:if(e.show_guest_info.guestId!==t.guestId){o.next=9;break}return e.show_guest_info.current_guest=t,o.next=4,e.load_current_guest_template(t);case 4:return o.next=6,e.load_current_guest_host(t);case 6:return o.next=8,e.load_current_guest_scheme(t);case 8:e.$forceUpdate();case 9:case"end":return o.stop()}}),o)})))()},get_memory_desplay:function(t){return t>=1048576?(t/1048576).toFixed(2)+" GB":t>=1024?(t/1024).toFixed(2)+"  MB":t+" KB"},get_volume_desplay_size:function(t){return t>=1099511627776?(t/1099511627776).toFixed(2)+" TB":t>=1073741824?(t/1073741824).toFixed(2)+" GB":t>=1048576?(t/1048576).toFixed(2)+" MB":t>=1024?(t/1024).toFixed(2)+"  KB":t+"  bytes"},get_guest_status:function(t){switch(t.status){case 0:return"正在创建";case 1:return"正在启动";case 2:return"正在运行";case 3:return"正在停止";case 4:return"已停止";case 5:return"重启中";case 6:return"虚拟机错误";default:return"未知状态[".concat(t.status,"]")}},show_start_guest_click:function(t){this.$refs.StartGuestComponentRef.init(t)},show_attach_network_click:function(t){this.$refs.AttachNetworkComponentRef.init(t)},show_attach_volume_click:function(t){this.$refs.AttachDiskComponentRef.init(t)},show_stop_guest_click:function(t){this.$refs.StopGuestComponentRef.init(t)},show_attach_cd_room_click:function(t){this.$refs.AttachCdRoomComponentRef.init(t)},show_modify_guest_click:function(t){this.$refs.ModifyGuestComponentRef.init(t)},vnc_click:function(t){var e=this.$router.resolve({path:"/Vnc",query:{id:t.guestId,description:t.description}}),o=e.href;window.open(o,"_blank")},detach_guest_cd_room_click:function(t){var e=this;fs({guestId:t.guestId}).then((function(t){0===t.code?(e.$emit("onGuestUpdate",t.data),e.stop_dialog_visiable=!1):e.$notify.error({title:"错误",message:"卸载虚拟机光驱失败:".concat(t.message)})}))},detach_network_click:function(t){var e=this;this.$confirm("卸载当前挂载网卡, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){ys({guestId:t.guestId,guestNetworkId:t.guestNetworkId}).then((function(o){if(0===o.code){e.$emit("onGuestUpdate",o.data);var s=e.show_guest_info.networks.findIndex((function(e){return e.guestNetworkId===t.guestNetworkId}));s>=0&&e.show_guest_info.networks.splice(s,1)}else e.$notify.error({title:"错误",message:"虚拟机附加网卡失败:".concat(o.message)})}))}))["catch"]((function(){}))},detach_volume_click:function(t){var e=this;this.$confirm("卸载当前挂载磁盘, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var o=t.attach;gs({guestId:o.guestId,guestDiskId:o.guestDiskId}).then((function(t){if(0===t.code){var s=e.show_guest_info.volumes.findIndex((function(t){return t.attach.guestDiskId===o.guestDiskId}));s>=0&&e.show_guest_info.volumes.splice(s,1)}else e.$notify.error({title:"错误",message:"卸载磁盘失败:".concat(t.message)})}))}))["catch"]((function(){}))},reboot_guest_click:function(t){var e=this;this.$confirm("重启当前虚拟机, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){ps({guestId:t.guestId}).then((function(t){0===t.code?e.$emit("onGuestUpdate",t.data):e.$notify.error({title:"错误",message:"重启虚拟机失败:".concat(t.message)})}))}))["catch"]((function(){}))},destroy_guest:function(t){var e=this;this.$confirm("删除当前虚拟机, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){rs({guestId:t.guestId}).then((function(t){0===t.code?e.on_back_click():e.$notify.error({title:"错误",message:"删除虚拟机失败:".concat(t.message)})}))}))["catch"]((function(){}))}}},Ct=St;var Zt=(0,u.Z)(Ct,T,$,!1,null,null,null);const zt=Zt.exports;var qt=o(54503),Bt=(o(83710),o(32564),function(){function t(){(0,m.Z)(this,t)}return(0,f.Z)(t,[{key:"init",value:function(e){var o=this;if(!t.instance){var s="ws://".concat(window.location.host,"/api/ws/");console.log(new Date,"开始连接通信服务器..."),t.instance=new WebSocket(s),t.instance.onopen=function(){console.log(new Date,"通信服务器连接成功")},t.instance.onerror=function(){console.log(new Date,"出现错误，断开链接，重新开始连接..."),t.instance.close(),t.instance=void 0,setTimeout((function(){o.init(e)}),3e3)},t.instance.onclose=function(){console.log(new Date,"断开链接,等待链接..."),t.instance=void 0,setTimeout((function(){o.init(e)}),3e3)}}t.instance.onmessage=function(t){t.data&&e.handle_notify_message(JSON.parse(t.data))}}}]),t}());(0,qt.Z)(Bt,"instance",void 0);const Nt=new Bt,Pt={data:function(){return{}},methods:{init_notify:function(){Nt.init(this)},handle_notify_message:function(t){console.log(t)}}},Ft={name:"NetworkView",components:{GuestInfoComponent:zt},data:function(){return{data_loading:!1,current_loading:!1,current_network_id:0,show_type:-1,show_network:{},system_guests:[],create_network:{name:"",startIp:"",endIp:"",gateway:"",mask:"",subnet:"",broadcast:"",bridge:"",dns:"",type:0,vlanId:100,basicNetworkId:""},networks:[]}},mounted:function(){var t=this;this.current_network_id=this.$route.query.id,this.current_network_id?(this.show_type,this.current_loading=!0,_o({networkId:this.current_network_id}).then((function(e){0===e.code?t.show_network_info_click(e.data):t.$alert("获取网络信息失败:".concat(e.message),"提示",{dangerouslyUseHTMLString:!0,confirmButtonText:"返回",type:"error"}).then((function(){t.show_type=0}))}))["finally"]((function(){t.current_loading=!1}))):this.show_type=0,this.init_view(),this.init_notify()},mixins:[Pt],methods:{init_view:function(){var t=this;return(0,x.Z)((0,I.Z)().mark((function e(){return(0,I.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.data_loading=!0,e.next=3,uo().then((function(e){0==e.code&&(t.networks=e.data)}))["finally"]((function(){t.data_loading=!1}));case 3:case"end":return e.stop()}}),e)})))()},load_system_guest:function(t){var e=this;return(0,x.Z)((0,I.Z)().mark((function o(){return(0,I.Z)().wrap((function(o){while(1)switch(o.prev=o.next){case 0:return e.system_guests=[],o.next=3,as({networkId:t.networkId}).then((function(t){0===t.code&&(e.system_guests=t.data)}));case 3:case"end":return o.stop()}}),o)})))()},update_guest_info:function(t){if(0===t.type&&t.networkId===this.show_network.networkId){var e=this.system_guests.findIndex((function(e){return e.guestId===t.guestId}));e>=0?this.$set(this.system_guests,e,t):this.system_guests.push(t),this.$forceUpdate()}this.$refs.GuestInfoComponentRef.update_guest_info(t)},go_guest_info:function(t){this.show_type=3,this.$refs.GuestInfoComponentRef.initGuestId(t)},get_network_status:function(t){switch(t.status){case 1:return"正在注册";case 2:return"已就绪";case 3:return"正在维护";case 4:return"正在销毁";case 5:return"网络错误";default:return"未知状态[".concat(t.status,"]")}},get_network_type:function(t){switch(t.type){case 0:return"基础网络";case 1:return"Vlan网络";default:return"未知类型[".concat(t.type,"]")}},get_guest_status:function(t){switch(t.status){case 0:return"正在创建";case 1:return"正在启动";case 2:return"正在运行";case 3:return"正在停止";case 4:return"已停止";case 5:return"重启中";case 6:return"虚拟机错误";default:return"未知状态[".concat(t.status,"]")}},get_parent_network:function(t){var e=this.networks.find((function(e){return e.networkId===t.basicNetworkId}));return e||{name:"-"}},update_network_info:function(t){var e=this.networks.findIndex((function(e){return e.networkId===t.networkId}));e>=0?this.$set(this.networks,e,t):this.networks.push(t),this.show_network&&this.show_network.networId===t.networId&&(this.show_network=t)},handle_notify_message:function(t){var e=this;3===t.type?_o({networkId:t.id}).then((function(o){if(0==o.code)e.update_network_info(o.data);else if(1000001==o.code){var s=e.networks.findIndex((function(e){return e.networkId===t.id}));s>=0&&e.networks.splice(s,1)}e.$forceUpdate()})):1===t.type&&Yo({guestId:t.id}).then((function(o){if(0==o.code)e.update_guest_info(o.data);else if(2000001==o.code){var s=e.system_guests.findIndex((function(e){return e.guestId===t.id}));s>=0&&e.system_guests.splice(s,1)}}))},show_network_list:function(){this.show_type=0},show_create_network:function(){this.$refs["createForm"]&&this.$refs["createForm"].resetFields(),this.show_type=2},show_network_info_click:function(t){this.show_network=t,this.load_system_guest(t),this.show_type=1},create_network_click:function(){var t=this;0===this.create_network.type&&(this.create_network.vlanId=0,this.create_network.basicNetworkId=0),po(this.create_network).then((function(e){0===e.code?(t.update_network_info(e.data),t.show_type=0):t.$notify.error({title:"错误",message:"创建网络失败:".concat(e.message)})}))},pasue_network:function(t){var e=this;this.$confirm("维护网络, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){ho({networkId:t.networkId}).then((function(t){0===t.code?e.update_network_info(t.data):e.$notify.error({title:"错误",message:"暂停网络失败:".concat(t.message)})}))}))["catch"]((function(){}))},register_network:function(t){var e=this;this.$confirm("重新注册网络, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){mo({networkId:t.networkId}).then((function(t){0===t.code?e.update_network_info(t.data):e.$notify.error({title:"错误",message:"注册网络失败:".concat(t.message)})}))}))["catch"]((function(){}))},destroy_network:function(t){var e=this;this.$confirm("销毁网络, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){fo({networkId:t.networkId}).then((function(t){0===t.code?(e.update_network_info(t.data),e.show_type=0):e.$notify.error({title:"错误",message:"删除网络失败:".concat(t.message)})}))}))["catch"]((function(){}))}}},Vt=Ft;var Gt=(0,u.Z)(Vt,b,k,!1,null,"5b453f49",null);const Mt=Gt.exports;var Rt=function(){var t=this,e=t._self._c;return e("div",[e("el-container",[e("el-main",[e("el-card",{directives:[{name:"show",rawName:"v-show",value:0===this.show_type,expression:"this.show_type === 0"}],staticClass:"box-card"},[e("el-row",{staticClass:"clearfix",staticStyle:{height:"20px"},attrs:{slot:"header"},slot:"header"},[e("el-button",{staticStyle:{float:"left",padding:"3px 0"},attrs:{type:"text"},on:{click:t.show_create_host}},[t._v("创建主机")])],1),e("el-row",[e("el-table",{staticStyle:{width:"100%"},attrs:{"v-loading":t.data_loading,data:t.hosts}},[e("el-table-column",{attrs:{label:"ID",prop:"hostId",width:"80"}}),e("el-table-column",{attrs:{label:"名称",prop:"displayName","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{label:"主机IP",prop:"hostIp",width:"120"}}),e("el-table-column",{attrs:{label:"CPU",prop:"hostIp",width:"120"},scopedSlots:t._u([{key:"default",fn:function(t){return[e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"已使用:"+t.row.allocationCpu+"核 / 总共:"+t.row.totalCpu+"核",placement:"top"}},[e("el-progress",{attrs:{color:"#67C23A",percentage:t.row.totalCpu<=0?0:Math.floor(100*t.row.allocationCpu/t.row.totalCpu)}})],1)]}}])}),e("el-table-column",{attrs:{label:"内存",prop:"hostIp",width:"120"},scopedSlots:t._u([{key:"default",fn:function(o){return[e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"已使用:"+t.get_memory_desplay(o.row.allocationMemory)+" / 总共:"+t.get_memory_desplay(o.row.totalMemory),placement:"top"}},[e("el-progress",{attrs:{color:"#67C23A",percentage:o.row.totalMemory<=0?0:Math.floor(100*o.row.allocationMemory/o.row.totalMemory)}})],1)]}}])}),e("el-table-column",{attrs:{label:"状态",prop:"status",width:"100"},scopedSlots:t._u([{key:"default",fn:function(o){return[e("el-tag",{attrs:{type:1===o.row.status?"success":"danger"}},[t._v(t._s(t.get_host_status(o.row)))])]}}])}),e("el-table-column",{attrs:{label:"操作",width:"400"},scopedSlots:t._u([{key:"default",fn:function(o){return[e("el-button",{attrs:{type:"",size:"mini"},on:{click:function(e){return t.show_host_info_click(o.row)}}},[t._v("主机详情")]),e("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(e){return t.register_host(o.row)}}},[t._v("重新注册")]),3!==o.row.status?e("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(e){return t.pasue_host(o.row)}}},[t._v("开始维护")]):t._e(),e("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){return t.destroy_host(o.row)}}},[t._v("销毁主机")])]}}])})],1)],1)],1),e("HostInfoComponent",{directives:[{name:"show",rawName:"v-show",value:1===this.show_type,expression:"this.show_type === 1"}],ref:"HostInfoComponentRef",on:{back:t.show_host_list,onHostUpdate:t.update_host_info}}),e("el-card",{directives:[{name:"show",rawName:"v-show",value:2===this.show_type,expression:"this.show_type === 2"}],staticClass:"box-card"},[e("el-row",{attrs:{slot:"header"},slot:"header"},[e("el-page-header",{staticStyle:{color:"#409eff"},attrs:{content:"创建主机"},on:{back:function(e){return t.show_host_list()}}})],1),e("el-row",[e("el-form",{ref:"createForm",staticClass:"demo-ruleForm",attrs:{model:t.create_host,"label-width":"100px"}},[e("el-form-item",{attrs:{label:"显示名称",prop:"nadisplayNameme"}},[e("el-input",{model:{value:t.create_host.displayName,callback:function(e){t.$set(t.create_host,"displayName",e)},expression:"create_host.displayName"}})],1),e("el-form-item",{attrs:{label:"主机IP",prop:"hostIp"}},[e("el-input",{model:{value:t.create_host.hostIp,callback:function(e){t.$set(t.create_host,"hostIp",e)},expression:"create_host.hostIp"}})],1),e("el-form-item",{attrs:{label:"网卡名称",prop:"nic"}},[e("el-input",{model:{value:t.create_host.nic,callback:function(e){t.$set(t.create_host,"nic",e)},expression:"create_host.nic"}})],1),e("el-form-item",{attrs:{label:"通信地址",prop:"uri"}},[e("el-input",{model:{value:t.create_host.uri,callback:function(e){t.$set(t.create_host,"uri",e)},expression:"create_host.uri"}})],1),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:t.create_host_click}},[t._v("立即创建")]),e("el-button",{on:{click:t.show_host_list}},[t._v("取消")])],1)],1)],1)],1)],1)],1)],1)},Dt=[];const Ut={name:"hostView",components:{HostInfoComponent:yt},data:function(){return{data_loading:!1,current_loading:!1,current_host_id:0,show_type:-1,create_host:{displayName:"",hostIp:"",nic:"",uri:""},hosts:[]}},mixins:[Pt],mounted:function(){var t=this;this.current_host_id=this.$route.query.id,this.current_host_id?(this.show_type,this.current_loading=!0,go({hostId:this.current_host_id}).then((function(e){0===e.code?t.show_host_info_click(e.data):t.$alert("获取主机信息失败:".concat(e.message),"提示",{dangerouslyUseHTMLString:!0,confirmButtonText:"返回",type:"error"}).then((function(){t.show_type=0}))}))["finally"]((function(){t.current_loading=!1}))):this.show_type=0,this.init_view(),this.init_notify()},methods:{init_view:function(){var t=this;return(0,x.Z)((0,I.Z)().mark((function e(){return(0,I.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.data_loading=!0,e.next=3,wo().then((function(e){0==e.code&&(t.hosts=e.data)}))["finally"]((function(){t.data_loading=!1}));case 3:case"end":return e.stop()}}),e)})))()},get_host_status:function(t){switch(t.status){case 0:return"正在创建";case 1:return"在线";case 2:return"离线";case 3:return"正在维护";case 4:return"主机错误";default:return"未知状态[".concat(t.status,"]")}},show_host_list:function(){this.show_type=0},show_create_host:function(){this.$refs["createForm"]&&this.$refs["createForm"].resetFields(),this.show_type=2},show_host_info_click:function(t){this.show_host=t,this.$refs.HostInfoComponentRef.init_host(t),this.show_type=1},update_host_info:function(t){var e=this.hosts.findIndex((function(e){return e.hostId===t.hostId}));e>=0?this.$set(this.hosts,e,t):this.hosts.push(t),this.$refs.HostInfoComponentRef.refresh_host(t)},handle_notify_message:function(t){var e=this;4===t.type&&go({hostId:t.id}).then((function(o){if(0==o.code)e.update_host_info(o.data);else if(7000001==o.code){var s=e.hosts.findIndex((function(e){return e.hostId===t.id}));s>=0&&e.hosts.splice(s,1)}}))},create_host_click:function(){var t=this;vo(this.create_host).then((function(e){0===e.code?(t.update_host_info(e.data),t.show_type=0):t.$notify.error({title:"错误",message:"创建主机失败:".concat(e.message)})}))},get_memory_desplay:function(t){return t>1048576?(t/1048576).toFixed(2)+" GB":t>1024?(t/1024).toFixed(0)+"  MB":t+" KB"},pasue_host:function(t){var e=this;this.$confirm("维护主机, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){yo({hostId:t.hostId}).then((function(t){0===t.code?e.update_host_info(t.data):e.$notify.error({title:"错误",message:"暂停主机失败:".concat(t.message)})}))}))["catch"]((function(){}))},register_host:function(t){var e=this;this.$confirm("重新注册主机, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){bo({hostId:t.hostId}).then((function(t){0===t.code?e.update_host_info(t.data):e.$notify.error({title:"错误",message:"注册主机失败:".concat(t.message)})}))}))["catch"]((function(){}))},destroy_host:function(t){var e=this;this.$confirm("删除当前主机, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){ko({hostId:t.hostId}).then((function(o){if(0===o.code){var s=e.hosts.findIndex((function(e){return e.hostId===t.hostId}));s>=0&&e.hosts.splice(s,1),e.show_type=0}else e.$notify.error({title:"错误",message:"删除主机失败:".concat(o.message)})}))}))["catch"]((function(){}))}}},Ot=Ut;var Et=(0,u.Z)(Ot,Rt,Dt,!1,null,"70bbac91",null);const Lt=Et.exports;var At=function(){var t=this,e=t._self._c;return e("div",[e("el-container",[e("el-main",[e("el-card",{directives:[{name:"show",rawName:"v-show",value:0===this.show_type,expression:"this.show_type === 0"}],staticClass:"box-card"},[e("el-row",{staticClass:"clearfix",staticStyle:{height:"20px"},attrs:{slot:"header"},slot:"header"},[e("el-button",{staticStyle:{float:"left",padding:"3px 0"},attrs:{type:"text"},on:{click:t.show_create_storage}},[t._v("创建存储池")])],1),e("el-row",[e("el-table",{staticStyle:{width:"100%"},attrs:{"v-loading":t.data_loading,data:t.storages}},[e("el-table-column",{attrs:{label:"ID",prop:"storageId",width:"80"}}),e("el-table-column",{attrs:{label:"名称",prop:"description","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{label:"类型",prop:"type",width:"120"}}),e("el-table-column",{attrs:{label:"容量",prop:"capacity",width:"120"},scopedSlots:t._u([{key:"default",fn:function(o){return[e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"已用:"+t.get_storage_desplay(o.row.allocation)+" / 总共:"+t.get_storage_desplay(o.row.capacity),placement:"top"}},[e("el-progress",{attrs:{color:"#67C23A",percentage:o.row.capacity<=0?0:Math.floor(100*o.row.allocation/o.row.capacity)}})],1)]}}])}),e("el-table-column",{attrs:{label:"状态",prop:"status",width:"110"},scopedSlots:t._u([{key:"default",fn:function(o){return[e("el-tag",{attrs:{type:1===o.row.status?"success":"danger"}},[t._v(t._s(t.get_storage_status(o.row)))])]}}])}),e("el-table-column",{attrs:{label:"操作",width:"400"},scopedSlots:t._u([{key:"default",fn:function(o){return[e("el-button",{attrs:{type:"",size:"mini"},on:{click:function(e){return t.show_storage_info_click(o.row)}}},[t._v("存储池详情")]),e("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(e){return t.register_storage(o.row)}}},[t._v("重新注册")]),2!==o.row.status?e("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(e){return t.pasue_storage(o.row)}}},[t._v("开始维护")]):t._e(),e("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){return t.destroy_storage(o.row)}}},[t._v("销毁存储池")])]}}])})],1)],1)],1),e("el-card",{directives:[{name:"show",rawName:"v-show",value:1===this.show_type,expression:"this.show_type === 1"}],staticClass:"box-card"},[e("el-row",{attrs:{slot:"header"},slot:"header"},[e("el-page-header",{attrs:{content:"存储池详情"},on:{back:t.show_storage_list}})],1),e("el-row",{staticStyle:{"text-align":"left",margin:"20px 0"}},[e("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(e){return t.register_storage(t.show_storage)}}},[t._v("重新注册")]),3!==t.show_storage.status?e("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(e){return t.pasue_storage(t.show_storage)}}},[t._v("开始维护")]):t._e(),e("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){return t.destroy_storage(t.show_storage)}}},[t._v("销毁存储池")])],1),e("el-row",[e("el-descriptions",{attrs:{column:2,size:"medium",border:""}},[e("el-descriptions-item",{attrs:{label:"ID"}},[t._v(t._s(t.show_storage.storageId))]),e("el-descriptions-item",{attrs:{label:"存储池名"}},[t._v(t._s(t.show_storage.name))]),e("el-descriptions-item",{attrs:{label:"存储池类型"}},[t._v(t._s(t.show_storage.type))]),e("el-descriptions-item",{attrs:{label:"挂载路径"}},[t._v(t._s(t.show_storage.mountPath))]),"nfs"===t.show_storage.type?e("el-descriptions-item",{attrs:{label:"NFS路径"}},[t._v(t._s(JSON.parse(t.show_storage.param).path))]):t._e(),"nfs"===t.show_storage.type?e("el-descriptions-item",{attrs:{label:"NFS地址"}},[t._v(t._s(JSON.parse(t.show_storage.param).uri))]):t._e(),e("el-descriptions-item",{attrs:{label:"容量"}},[t._v(t._s(t.get_storage_desplay(t.show_storage.capacity)))]),e("el-descriptions-item",{attrs:{label:"可用"}},[t._v(t._s(t.get_storage_desplay(t.show_storage.available)))]),e("el-descriptions-item",{attrs:{label:"已申请"}},[t._v(t._s(t.get_storage_desplay(t.show_storage.allocation)))]),e("el-descriptions-item",{attrs:{label:"状态"}},[e("el-tag",{attrs:{type:1===t.show_storage.status?"success":"danger"}},[t._v(t._s(t.get_storage_status(t.show_storage)))])],1)],1)],1)],1),e("el-card",{directives:[{name:"show",rawName:"v-show",value:2===this.show_type,expression:"this.show_type === 2"}],staticClass:"box-card"},[e("el-row",{attrs:{slot:"header"},slot:"header"},[e("el-page-header",{staticStyle:{color:"#409eff"},attrs:{content:"创建存储池"},on:{back:function(e){return t.show_storage_list()}}})],1),e("el-row",[e("el-form",{ref:"createForm",staticClass:"demo-ruleForm",attrs:{model:t.create_storage,"label-width":"100px"}},[e("el-form-item",{attrs:{label:"名称",prop:"description"}},[e("el-input",{model:{value:t.create_storage.description,callback:function(e){t.$set(t.create_storage,"description",e)},expression:"create_storage.description"}})],1),e("el-form-item",{attrs:{label:"存储池类型",prop:"type"}},[e("el-select",{staticStyle:{width:"100%"},model:{value:t.create_storage.type,callback:function(e){t.$set(t.create_storage,"type",e)},expression:"create_storage.type"}},[e("el-option",{attrs:{label:"NFS",value:"nfs"}})],1)],1),"nfs"===t.create_storage.type?e("el-form-item",{attrs:{label:"NFS路径",prop:"path"}},[e("el-input",{model:{value:t.create_storage.path,callback:function(e){t.$set(t.create_storage,"path",e)},expression:"create_storage.path"}})],1):t._e(),"nfs"===t.create_storage.type?e("el-form-item",{attrs:{label:"NFS地址",prop:"uri"}},[e("el-input",{model:{value:t.create_storage.uri,callback:function(e){t.$set(t.create_storage,"uri",e)},expression:"create_storage.uri"}})],1):t._e(),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:t.create_storage_click}},[t._v("立即创建")]),e("el-button",{on:{click:t.show_storage_list}},[t._v("取消")])],1)],1)],1)],1)],1)],1)],1)},Ht=[];o(38862);const jt={name:"storageView",components:{},data:function(){return{data_loading:!1,current_loading:!1,current_network_id:0,show_type:-1,show_storage:{},create_storage:{description:"",type:"nfs",param:"",path:"",uri:""},storages:[]}},mixins:[Pt],mounted:function(){var t=this;this.current_storage_id=this.$route.query.id,this.current_storage_id?(this.show_type,this.current_loading=!0,xo({storageId:this.current_storage_id}).then((function(e){0===e.code?t.show_storage_info_click(e.data):t.$alert("获取存储池信息失败:".concat(e.message),"提示",{dangerouslyUseHTMLString:!0,confirmButtonText:"返回",type:"error"}).then((function(){t.show_type=0}))}))["finally"]((function(){t.current_loading=!1}))):this.show_type=0,this.init_view(),this.init_notify()},methods:{init_view:function(){var t=this;return(0,x.Z)((0,I.Z)().mark((function e(){return(0,I.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.data_loading=!0,e.next=3,Io().then((function(e){0==e.code&&(t.storages=e.data)}))["finally"]((function(){t.data_loading=!1}));case 3:case"end":return e.stop()}}),e)})))()},get_storage_status:function(t){switch(t.status){case 0:return"正在创建";case 1:return"已就绪";case 2:return"正在维护";case 3:return"正在销毁";case 4:return"存储池错误";default:return"未知状态[".concat(t.status,"]")}},update_storate_info:function(t){var e=this.storages.findIndex((function(e){return e.storageId===t.storageId}));e>=0?this.$set(this.storages,e,t):this.storages.push(t),this.show_storage&&this.show_storage.storageId===t.storageId&&(this.show_storage=t)},handle_notify_message:function(t){var e=this;7===t.type&&xo({storageId:t.id}).then((function(o){if(0==o.code)e.update_storate_info(o.data);else if(3000001==o.code){var s=e.storages.findIndex((function(e){return e.storageId===t.id}));s>=0&&e.storages.splice(s,1)}}))},show_storage_list:function(){this.show_type=0},show_create_storage:function(){this.$refs["createForm"]&&this.$refs["createForm"].resetFields(),this.show_type=2},show_storage_info_click:function(t){this.show_storage=t,this.show_type=1},create_storage_click:function(){var t=this,e={name:this.create_storage.name,type:this.create_storage.type,param:"{}"};"nfs"===this.create_storage.type?(e.param=JSON.stringify({path:this.create_storage.path,uri:this.create_storage.uri}),To(e).then((function(e){0===e.code?(t.update_storate_info(e.data),t.show_type=0):t.$notify.error({title:"错误",message:"创建存储池失败:".concat(e.message)})}))):this.$notify.error({title:"错误",message:"不支持的存储池:".concat(this.create_storage.type)})},get_storage_desplay:function(t){return t>=1099511627776?(t/1099511627776).toFixed(2)+" TB":t>=1073741824?(t/1073741824).toFixed(2)+" GB":t>=1048576?(t/1048576).toFixed(2)+" MB":t>=1024?(t/1024).toFixed(2)+"  KB":t+"  bytes"},pasue_storage:function(t){var e=this;this.$confirm("暂停存储池, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){$o({storageId:t.storageId}).then((function(t){0===t.code?e.update_storate_info(t.data):e.$notify.error({title:"错误",message:"暂停存储池失败:".concat(t.message)})}))}))["catch"]((function(){}))},register_storage:function(t){var e=this;this.$confirm("重新注册存储池, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){So({storageId:t.storageId}).then((function(o){0===o.code?t.status=0:e.$notify.error({title:"错误",message:"注册存储池失败:".concat(o.message)})}))}))["catch"]((function(){}))},destroy_storage:function(t){var e=this;this.$confirm("删除存储池, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Co({storageId:t.storageId}).then((function(t){0===t.code?(e.update_storate_info(t.data),e.show_type=0):e.$notify.error({title:"错误",message:"删除存储池失败:".concat(t.message)})}))}))["catch"]((function(){}))}}},Kt=jt;var Xt=(0,u.Z)(Kt,At,Ht,!1,null,"38795d22",null);const Jt=Xt.exports;o(82772);var Qt=function(){var t=this,e=t._self._c;return e("div",[e("el-container",[e("el-main",[e("el-card",{directives:[{name:"show",rawName:"v-show",value:0===this.show_type,expression:"this.show_type === 0"}],staticClass:"box-card"},[e("el-row",{staticClass:"clearfix",staticStyle:{height:"20px"},attrs:{slot:"header"},slot:"header"},[e("el-button",{staticStyle:{float:"left",padding:"3px 0"},attrs:{type:"text"},on:{click:t.show_create_template}},[t._v("创建模版")])],1),e("el-row",[e("el-table",{staticStyle:{width:"100%"},attrs:{"v-loading":t.data_loading,data:t.templates}},[e("el-table-column",{attrs:{label:"ID",prop:"templateId",width:"80"}}),e("el-table-column",{attrs:{label:"名称",prop:"name","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{label:"磁盘类型",prop:"volumeType",width:"120"}}),e("el-table-column",{attrs:{label:"类型",prop:"type",width:"100"},scopedSlots:t._u([{key:"default",fn:function(o){return[e("el-tag",[t._v(t._s(t.get_template_type(o.row)))])]}}])}),e("el-table-column",{attrs:{label:"状态",prop:"status",width:"120"},scopedSlots:t._u([{key:"default",fn:function(o){return[e("el-tag",{attrs:{type:2===o.row.status?"success":"danger"}},[t._v(t._s(t.get_template_status(o.row)))])]}}])}),e("el-table-column",{attrs:{label:"操作","min-width":"200"},scopedSlots:t._u([{key:"default",fn:function(o){return[e("el-button",{attrs:{type:"",size:"mini"},on:{click:function(e){return t.show_template_info(o.row)}}},[t._v("模版详情")]),0===o.row.templateType||1===o.row.templateType?e("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(e){return t.download_template(o.row)}}},[t._v("重新下载")]):t._e(),e("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){return t.destroy_template(o.row)}}},[t._v("销毁模版")])]}}])})],1)],1)],1),e("el-card",{directives:[{name:"show",rawName:"v-show",value:1===this.show_type,expression:"this.show_type === 1"}],staticClass:"box-card"},[e("el-row",{attrs:{slot:"header"},slot:"header"},[e("el-page-header",{attrs:{content:"模版详情"},on:{back:t.show_template_list}})],1),e("el-row",{staticStyle:{"text-align":"left",margin:"20px 0"}},[0===t.show_template.templateType||1===t.show_template.templateType?e("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(e){return t.download_template(t.show_template)}}},[t._v("重新下载")]):t._e(),e("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){return t.destroy_template(t.show_template)}}},[t._v("销毁模版")])],1),e("el-row",[e("el-descriptions",{attrs:{column:2,size:"medium",border:""}},[e("el-descriptions-item",{attrs:{label:"ID"}},[t._v(t._s(t.show_template.templateId))]),e("el-descriptions-item",{attrs:{label:"模版名"}},[t._v(t._s(t.show_template.name))]),t.show_template.uri&&0===t.show_template.uri.indexOf("http")?e("el-descriptions-item",{attrs:{label:"下载地址"}},[t._v(t._s(t.show_template.uri))]):t._e(),e("el-descriptions-item",{attrs:{label:"模版类型"}},[e("el-tag",[t._v(t._s(t.get_template_type(t.show_template)))])],1),e("el-descriptions-item",{attrs:{label:"状态"}},[e("el-tag",{attrs:{type:2===t.show_template.status?"success":"danger"}},[t._v(t._s(t.get_template_status(t.show_template)))])],1)],1)],1)],1),e("el-card",{directives:[{name:"show",rawName:"v-show",value:2===this.show_type,expression:"this.show_type === 2"}],staticClass:"box-card"},[e("el-row",{attrs:{slot:"header"},slot:"header"},[e("el-page-header",{staticStyle:{color:"#409eff"},attrs:{content:"创建模版"},on:{back:function(e){return t.show_template_list()}}})],1),e("el-row",[e("el-form",{ref:"createForm",staticClass:"demo-ruleForm",attrs:{model:t.create_template,"label-width":"100px"}},[e("el-form-item",{attrs:{label:"名称",prop:"name"}},[e("el-input",{model:{value:t.create_template.name,callback:function(e){t.$set(t.create_template,"name",e)},expression:"create_template.name"}})],1),e("el-form-item",{attrs:{label:"模版类型",prop:"templateType"}},[e("el-select",{staticStyle:{width:"100%"},model:{value:t.create_template.templateType,callback:function(e){t.$set(t.create_template,"templateType",e)},expression:"create_template.templateType"}},[e("el-option",{attrs:{label:"ISO",value:0}}),e("el-option",{attrs:{label:"系统模版",value:1}}),e("el-option",{attrs:{label:"用户模版",value:2}})],1)],1),2===t.create_template.templateType?e("el-form-item",{attrs:{label:"磁盘类型",prop:"volumeType"}},[e("el-select",{staticStyle:{width:"100%"},model:{value:t.create_template.volumeType,callback:function(e){t.$set(t.create_template,"volumeType",e)},expression:"create_template.volumeType"}},[e("el-option",{attrs:{label:"raw",value:"raw"}}),e("el-option",{attrs:{label:"qcow",value:"qcow"}}),e("el-option",{attrs:{label:"qcow2",value:"qcow2"}}),e("el-option",{attrs:{label:"vdi",value:"vdi"}}),e("el-option",{attrs:{label:"vmdk",value:"vmdk"}}),e("el-option",{attrs:{label:"vpc",value:"vpc"}})],1)],1):t._e(),e("el-form-item",{attrs:{label:" 下载地址",prop:"uri"}},[e("el-input",{model:{value:t.create_template.uri,callback:function(e){t.$set(t.create_template,"uri",e)},expression:"create_template.uri"}})],1),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:t.create_template_click}},[t._v("立即创建")]),e("el-button",{on:{click:t.show_template_list}},[t._v("取消")])],1)],1)],1)],1)],1)],1)],1)},Wt=[];const Yt={name:"templateView",components:{},data:function(){return{data_loading:!1,show_type:0,show_template:{},create_template:{name:"",templateType:0,volumeType:"qcow2",uri:""},templates:[]}},mixins:[Pt],created:function(){this.init_view(),this.init_notify()},methods:{init_view:function(){var t=this;return(0,x.Z)((0,I.Z)().mark((function e(){return(0,I.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.data_loading=!0,e.next=3,Zo().then((function(e){0==e.code&&(t.templates=e.data)}))["finally"]((function(){t.data_loading=!1}));case 3:case"end":return e.stop()}}),e)})))()},get_template_status:function(t){switch(t.status){case 0:return"正在创建";case 1:return"下载中";case 2:return"已就绪";case 3:return"模版错误";default:return"未知状态[".concat(t.status,"]")}},get_template_type:function(t){switch(t.templateType){case 0:return"IOS 文件";case 1:return"系统模版";case 2:return"用户模版";default:return"未知模版[".concat(t.templateType,"]")}},show_template_list:function(){this.show_type=0},show_create_template:function(){this.$refs["createForm"]&&this.$refs["createForm"].resetFields(),this.show_type=2},show_template_info:function(t){this.show_template=t,this.show_type=1},update_template_info:function(t){var e=this.templates.findIndex((function(e){return e.templateId===t.templateId}));e>=0?this.$set(this.templates,e,t):this.templates.push(t),this.show_template&&this.show_template.templateId===t.templateId&&(this.show_template=t)},handle_notify_message:function(t){var e=this;5===t.type&&zo({templateId:t.id}).then((function(o){if(0==o.code)e.update_template_info(o.data);else if(5000001==o.code){var s=e.templates.findIndex((function(e){return e.templateId===t.id}));s>=0&&e.templates.splice(s,1)}}))},create_template_click:function(){var t=this,e={name:this.create_template.name,templateType:this.create_template.templateType,uri:this.create_template.uri,volumeType:this.create_template.templateType};0===this.create_template.templateType?e.volumeType="raw":1===this.create_template.templateType&&(e.volumeType="qcow2"),qo(e).then((function(e){0===e.code?(t.update_template_info(e.data),t.show_type=0):t.$notify.error({title:"错误",message:"创建模版失败:".concat(e.message)})}))},download_template:function(t){var e=this;this.$confirm("重新下载模版, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){No({templateId:t.templateId}).then((function(t){0===t.code?e.update_template_info(t.data):e.$notify.error({title:"错误",message:"重新下载模版失败:".concat(t.message)})}))}))["catch"]((function(){}))},destroy_template:function(t){var e=this;this.$confirm("删除模版, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Po({templateId:t.templateId}).then((function(o){if(0===o.code){var s=e.templates.findIndex((function(e){return e.templateId===t.templateId}));s>=0&&e.templates.splice(s,1),e.show_type=0}else e.$notify.error({title:"错误",message:"删除模版失败:".concat(o.message)})}))}))["catch"]((function(){}))}}},te=Yt;var ee=(0,u.Z)(te,Qt,Wt,!1,null,"55dc318c",null);const oe=ee.exports;var se=function(){var t=this,e=t._self._c;return e("div",[e("el-container",[e("el-main",[e("el-card",{directives:[{name:"show",rawName:"v-show",value:0===this.show_type,expression:"this.show_type === 0"}],staticClass:"box-card"},[e("el-row",[e("el-table",{staticStyle:{width:"100%"},attrs:{"v-loading":t.data_loading,data:t.snapshots}},[e("el-table-column",{attrs:{label:"ID",prop:"snapshotVolumeId",width:"80"}}),e("el-table-column",{attrs:{label:"名称",prop:"name","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{label:"磁盘类型",prop:"type",width:"100"}}),e("el-table-column",{attrs:{label:"磁盘空间",prop:"capacity",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.get_volume_desplay_size(e.row.capacity))+" ")]}}])}),e("el-table-column",{attrs:{label:"物理空间",prop:"allocation",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.get_volume_desplay_size(e.row.allocation))+" ")]}}])}),e("el-table-column",{attrs:{label:"状态",prop:"status",width:"100"},scopedSlots:t._u([{key:"default",fn:function(o){return[e("el-tag",{attrs:{type:1===o.row.status?"success":"danger"}},[t._v(t._s(t.get_snapshot_status(o.row)))])]}}])}),e("el-table-column",{attrs:{label:"操作",width:"300"},scopedSlots:t._u([{key:"default",fn:function(o){return[e("el-button",{attrs:{type:"",size:"mini"},on:{click:function(e){return t.show_snapshot_info(o.row)}}},[t._v("快照详情")]),e("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){return t.destroy_snapshot(o.row)}}},[t._v("销毁快照")])]}}])})],1)],1)],1),e("el-card",{directives:[{name:"show",rawName:"v-show",value:1===this.show_type,expression:"this.show_type === 1"}],staticClass:"box-card"},[e("el-row",{attrs:{slot:"header"},slot:"header"},[e("el-page-header",{attrs:{content:"快照详情"},on:{back:t.show_snapshot_list}})],1),e("el-row",{staticStyle:{"text-align":"left",margin:"20px 0"}},[e("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){return t.destroy_snapshot(t.show_snapshot)}}},[t._v("销毁快照")])],1),e("el-row",[e("el-descriptions",{attrs:{column:2,size:"medium",border:""}},[e("el-descriptions-item",{attrs:{label:"ID"}},[t._v(t._s(t.show_snapshot.snapshotVolumeId))]),e("el-descriptions-item",{attrs:{label:"快照名"}},[t._v(t._s(t.show_snapshot.name))]),e("el-descriptions-item",{attrs:{label:"快照路径"}},[t._v(t._s(t.show_snapshot.volumePath))]),e("el-descriptions-item",{attrs:{label:"快照容量"}},[t._v(t._s(t.get_volume_desplay_size(t.show_snapshot.capacity)))]),e("el-descriptions-item",{attrs:{label:"物理占有"}},[t._v(t._s(t.get_volume_desplay_size(t.show_snapshot.allocation)))]),e("el-descriptions-item",{attrs:{label:"磁盘类型"}},[t._v(t._s(t.show_snapshot.type))]),e("el-descriptions-item",{attrs:{label:"存储池"}},[t._v(t._s(t.get_storage_name(t.show_snapshot.storageId)))]),e("el-descriptions-item",{attrs:{label:"状态"}},[e("el-tag",{attrs:{type:1===t.show_snapshot.status?"success":"danger"}},[t._v(t._s(t.get_snapshot_status(t.show_snapshot)))])],1)],1)],1)],1)],1)],1)],1)},ae=[];const ne={name:"snapshotView",components:{},data:function(){return{data_loading:!1,show_type:0,show_snapshot:{},snapshots:[],storages:[]}},mixins:[Pt],created:function(){this.init_view(),this.init_notify()},methods:{init_view:function(){var t=this;return(0,x.Z)((0,I.Z)().mark((function e(){return(0,I.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.data_loading=!0,e.next=3,Io().then((function(e){0===e.code&&(t.storages=e.data)}));case 3:return e.next=5,Fo().then((function(e){0==e.code&&(t.snapshots=e.data)}))["finally"]((function(){t.data_loading=!1}));case 5:case"end":return e.stop()}}),e)})))()},get_storage_name:function(t){var e=this.storages.find((function(e){return e.storageId===t}))||{name:"-"};return e.name},get_volume_desplay_size:function(t){return t>=1099511627776?(t/1099511627776).toFixed(2)+" TB":t>=1073741824?(t/1073741824).toFixed(2)+" GB":t>=1048576?(t/1048576).toFixed(2)+" MB":t>=1024?(t/1024).toFixed(2)+"  KB":t+"  bytes"},get_snapshot_status:function(t){switch(t.status){case 0:return"正在创建";case 1:return"已就绪";case 2:return"快照错误";case 3:return"正在删除";default:return"未知状态[".concat(t.status,"]")}},show_snapshot_list:function(){this.show_type=0},show_snapshot_info:function(t){this.show_snapshot=t,this.show_type=1},update_snapshot_info:function(t){var e=this.snapshots.findIndex((function(e){return e.snapshotVolumeId===t.snapshotVolumeId}));e>=0?this.$set(this.snapshots,e,t):this.snapshots.push(t),this.show_snapshot&&this.show_snapshot.snapshotVolumeId===t.snapshotVolumeId&&(this.show_snapshot=t)},handle_notify_message:function(t){var e=this;6===t.type&&Vo({snapshotVolumeId:t.id}).then((function(o){if(0==o.code)e.update_snapshot_info(o.data);else if(6000001==o.code){var s=e.snapshots.findIndex((function(e){return e.snapshotVolumeId===t.id}));s>=0&&e.snapshots.splice(s,1)}}))},destroy_snapshot:function(t){var e=this;this.$confirm("删除快照, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Mo({snapshotVolumeId:t.snapshotVolumeId}).then((function(o){if(0===o.code){var s=e.snapshots.findIndex((function(e){return e.snapshotVolumeId===t.snapshotVolumeId}));s>=0&&e.snapshots.splice(s,1),e.show_type=0}else e.$notify.error({title:"错误",message:"删除快照失败:".concat(o.message)})}))}))["catch"]((function(){}))}}},re=ne;var ie=(0,u.Z)(re,se,ae,!1,null,"31f4f986",null);const le=ie.exports;var ce=function(){var t=this,e=t._self._c;return e("div",[e("el-container",[e("el-main",[e("el-card",{directives:[{name:"show",rawName:"v-show",value:0===this.show_type,expression:"this.show_type === 0"}],staticClass:"box-card"},[e("el-row",{staticClass:"clearfix",staticStyle:{height:"30px"},attrs:{slot:"header"},slot:"header"},[e("div",{staticStyle:{float:"left"}},[e("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[e("el-form-item",[e("el-link",{attrs:{type:"primary"},on:{click:t.show_create_volume}},[t._v("创建磁盘")])],1),e("el-form-item",[e("el-link",{staticStyle:{margin:"0 10px"},attrs:{type:"primary"},on:{click:t.show_upload_volume}},[t._v("导入磁盘")])],1),e("el-form-item",[e("el-link",{attrs:{disabled:!t.select_volumes.length,type:"danger"},on:{click:t.batch_destroy_volume_click}},[t._v("批量删除")])],1),e("el-form-item",{attrs:{label:"存储池"}},[e("el-select",{staticStyle:{width:"100%"},on:{change:t.update_show_page},model:{value:t.select_storage_id,callback:function(e){t.select_storage_id=e},expression:"select_storage_id"}},[e("el-option",{attrs:{label:"全部",value:0}}),t._l(this.storages,(function(t){return e("el-option",{key:t.storageId,attrs:{label:t.description,value:t.storageId}})}))],2)],1)],1)],1),e("div",[e("el-input",{staticStyle:{float:"right",width:"300px","margin-bottom":"10px"},attrs:{placeholder:"请输入搜索关键字"},on:{input:t.update_show_page},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}})],1)]),e("el-row",[e("el-table",{ref:"volumeTable",staticStyle:{width:"100%"},attrs:{"v-loading":!0,data:t.show_table_volumes},on:{"selection-change":t.handleSelectionChange}},[e("el-table-column",{attrs:{type:"selection",width:"55"}}),e("el-table-column",{attrs:{label:"ID",prop:"volumeId",width:"80"}}),e("el-table-column",{attrs:{label:"名称",prop:"description","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{label:"磁盘类型",prop:"type",width:"100"},scopedSlots:t._u([{key:"default",fn:function(o){return[e("el-tag",[t._v(t._s(o.row.type))])]}}])}),e("el-table-column",{attrs:{label:"磁盘空间",prop:"capacity",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.get_volume_desplay_size(e.row.capacity))+" ")]}}])}),e("el-table-column",{attrs:{label:"物理空间",prop:"allocation",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.get_volume_desplay_size(e.row.allocation))+" ")]}}])}),e("el-table-column",{attrs:{label:"挂载主机",prop:"allocation",width:"120","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(o){return[o.row.attach?e("el-link",{attrs:{type:"primary",href:"/#/Guest?id=".concat(o.row.attach.guestId),underline:!1}},[t._v(t._s(o.row.attach?o.row.attach.description:"-"))]):t._e(),o.row.attach?t._e():e("span",[t._v(t._s(o.row.attach?o.row.attach.description:"-"))])]}}])}),e("el-table-column",{attrs:{label:"状态",prop:"status",width:"100"},scopedSlots:t._u([{key:"default",fn:function(o){return[e("el-tag",{attrs:{type:1===o.row.status?"success":"danger"}},[t._v(t._s(t.get_volume_status(o.row)))])]}}])}),e("el-table-column",{attrs:{label:"操作",width:"250"},scopedSlots:t._u([{key:"default",fn:function(o){return[e("el-dropdown",{attrs:{size:"small","split-button":"",placement:"bottom-end",type:"primary"},on:{click:function(e){return t.show_volume_info(o.row)},command:t.menu_command_click}},[t._v(" 磁盘管理 "),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e("el-dropdown-item",{attrs:{command:{volume:o.row,command:"info"}}},[t._v("磁盘详情")]),e("el-dropdown-item",{attrs:{command:{volume:o.row,command:"resize"},divided:""}},[t._v("扩容磁盘")]),e("el-dropdown-item",{attrs:{command:{volume:o.row,command:"clone"}}},[t._v("克隆磁盘")]),e("el-dropdown-item",{attrs:{command:{volume:o.row,command:"migrate"}}},[t._v("迁移磁盘")]),e("el-dropdown-item",{attrs:{command:{volume:o.row,command:"snapshote"},divided:""}},[t._v("创建快照")]),e("el-dropdown-item",{attrs:{command:{volume:o.row,command:"template"}}},[t._v("创建模版")]),e("el-dropdown-item",{attrs:{command:{volume:o.row,command:"destroy"},divided:""}},[t._v("销毁磁盘")])],1)],1)]}}])})],1),e("el-pagination",{attrs:{"current-page":t.current_page,"page-size":t.page_size,"page-sizes":[5,10,20,50,100,200],total:t.total_size,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":t.on_page_size_change,"current-change":t.on_current_page_change}})],1)],1),e("el-card",{directives:[{name:"show",rawName:"v-show",value:1===this.show_type,expression:"this.show_type === 1"}],staticClass:"box-card"},[e("el-row",{attrs:{slot:"header"},slot:"header"},[e("el-page-header",{attrs:{content:"磁盘详情"},on:{back:t.show_volume_list}})],1),e("el-row",{staticStyle:{"text-align":"left",margin:"20px 0"}},[e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.show_create_volume()}}},[t._v("创建磁盘")]),e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.show_resize_volume_click(t.show_volume)}}},[t._v("扩容磁盘")]),e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.show_clone_volume_click(t.show_volume)}}},[t._v("克隆磁盘")]),e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.show_migrate_volume_click(t.show_volume)}}},[t._v("迁移磁盘")]),e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.show_create_volume_snapshot_click(t.show_volume)}}},[t._v("创建快照")]),e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.show_create_volume_template_click(t.show_volume)}}},[t._v("创建模版")]),e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.show_download_volume_click(t.show_volume)}}},[t._v("下载磁盘")]),e("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){return t.destroy_volume(t.show_volume)}}},[t._v("销毁磁盘")])],1),e("el-row",[e("el-descriptions",{attrs:{column:2,size:"medium",border:""}},[e("el-descriptions-item",{attrs:{label:"ID"}},[t._v(t._s(t.show_volume.volumeId))]),e("el-descriptions-item",{attrs:{label:"磁盘名"}},[t._v(t._s(t.show_volume.description))]),e("el-descriptions-item",{attrs:{label:"磁盘类型"}},[t._v(t._s(t.show_volume.type))]),e("el-descriptions-item",{attrs:{label:"磁盘路径"}},[t._v(t._s(t.show_volume.path))]),e("el-descriptions-item",{attrs:{label:"磁盘模版"}},[t._v(t._s(t.show_volume.template?t.show_volume.template.name:"-"))]),e("el-descriptions-item",{attrs:{label:"磁盘存储池"}},[e("el-link",{attrs:{type:"primary",href:"/#/Storage?id=".concat(t.show_volume.storageId),underline:!1}},[t._v(" "+t._s(t.get_storage_name(t.show_volume.storageId))+" ")])],1),e("el-descriptions-item",{attrs:{label:"挂载主机"}},[t.show_volume.attach?e("el-link",{attrs:{type:"primary",href:"/#/Guest?id=".concat(t.show_volume.attach.guestId),underline:!1}},[t._v(" "+t._s(t.show_volume.attach.description)+" ")]):t._e(),t.show_volume.attach?t._e():e("span",[t._v("-")])],1),e("el-descriptions-item",{attrs:{label:"磁盘容量"}},[t._v(t._s(t.get_volume_desplay_size(t.show_volume.capacity)))]),e("el-descriptions-item",{attrs:{label:"物理占用"}},[t._v(t._s(t.get_volume_desplay_size(t.show_volume.allocation)))]),e("el-descriptions-item",{attrs:{label:"状态"}},[e("el-tag",{attrs:{type:1===t.show_volume.status?"success":"danger"}},[t._v(t._s(t.get_volume_status(t.show_volume)))])],1)],1)],1)],1),e("el-card",{directives:[{name:"show",rawName:"v-show",value:2===this.show_type,expression:"this.show_type === 2"}],staticClass:"box-card"},[e("el-row",{attrs:{slot:"header"},slot:"header"},[e("el-page-header",{staticStyle:{color:"#409eff"},attrs:{content:"创建磁盘"},on:{back:function(e){return t.show_volume_list()}}})],1),e("el-row",[e("el-form",{ref:"createForm",staticClass:"demo-ruleForm",attrs:{model:t.create_volume,"label-width":"100px"}},[e("el-form-item",{attrs:{label:"名称",prop:"description"}},[e("el-input",{model:{value:t.create_volume.description,callback:function(e){t.$set(t.create_volume,"description",e)},expression:"create_volume.description"}})],1),e("el-form-item",{attrs:{label:"存储池",prop:"type"}},[e("el-select",{staticStyle:{width:"100%"},model:{value:t.create_volume.storageId,callback:function(e){t.$set(t.create_volume,"storageId",e)},expression:"create_volume.storageId"}},[e("el-option",{attrs:{label:"随机",value:0}}),t._l(this.storages,(function(t){return e("el-option",{key:t.storageId,attrs:{label:t.description,value:t.storageId}})}))],2)],1),e("el-form-item",{attrs:{label:"磁盘类型",prop:"volumeType"}},[e("el-select",{staticStyle:{width:"100%"},model:{value:t.create_volume.volumeType,callback:function(e){t.$set(t.create_volume,"volumeType",e)},expression:"create_volume.volumeType"}},[e("el-option",{attrs:{label:"raw",value:"raw"}}),e("el-option",{attrs:{label:"qcow",value:"qcow"}}),e("el-option",{attrs:{label:"qcow2",value:"qcow2"}}),e("el-option",{attrs:{label:"vdi",value:"vdi"}}),e("el-option",{attrs:{label:"vmdk",value:"vmdk"}}),e("el-option",{attrs:{label:"vpc",value:"vpc"}})],1)],1),e("el-form-item",{attrs:{label:"磁盘大小(GB)",prop:"volumeSize"}},[e("el-input",{model:{value:t.create_volume.volumeSize,callback:function(e){t.$set(t.create_volume,"volumeSize",e)},expression:"create_volume.volumeSize"}})],1),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:t.create_volume_click}},[t._v("立即创建")]),e("el-button",{on:{click:t.show_volume_list}},[t._v("取消")])],1)],1)],1)],1),e("el-card",{directives:[{name:"show",rawName:"v-show",value:3===this.show_type,expression:"this.show_type === 3"}],staticClass:"box-card"},[e("el-row",{attrs:{slot:"header"},slot:"header"},[e("el-page-header",{staticStyle:{color:"#409eff"},attrs:{content:"克隆磁盘"},on:{back:function(e){return t.show_volume_list()}}})],1),e("el-row",[e("el-form",{ref:"cloneForm",staticClass:"demo-ruleForm",attrs:{model:t.clone_volume,"label-width":"100px"}},[e("el-form-item",{attrs:{label:"名称",prop:"description"}},[e("el-input",{model:{value:t.clone_volume.description,callback:function(e){t.$set(t.clone_volume,"description",e)},expression:"clone_volume.description"}})],1),e("el-form-item",{attrs:{label:"存储池",prop:"storageId"}},[e("el-select",{staticStyle:{width:"100%"},model:{value:t.clone_volume.storageId,callback:function(e){t.$set(t.clone_volume,"storageId",e)},expression:"clone_volume.storageId"}},[e("el-option",{attrs:{label:"随机",value:0}}),t._l(this.storages,(function(t){return e("el-option",{key:t.storageId,attrs:{label:t.description,value:t.storageId}})}))],2)],1),e("el-form-item",{attrs:{label:"磁盘类型",prop:"volumeType"}},[e("el-select",{staticStyle:{width:"100%"},model:{value:t.clone_volume.volumeType,callback:function(e){t.$set(t.clone_volume,"volumeType",e)},expression:"clone_volume.volumeType"}},[e("el-option",{attrs:{label:"raw",value:"raw"}}),e("el-option",{attrs:{label:"qcow",value:"qcow"}}),e("el-option",{attrs:{label:"qcow2",value:"qcow2"}}),e("el-option",{attrs:{label:"vdi",value:"vdi"}}),e("el-option",{attrs:{label:"vmdk",value:"vmdk"}}),e("el-option",{attrs:{label:"vpc",value:"vpc"}})],1)],1),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:t.clone_volume_click}},[t._v("克隆")]),e("el-button",{on:{click:t.show_volume_list}},[t._v("取消")])],1)],1)],1)],1),e("el-card",{directives:[{name:"show",rawName:"v-show",value:4===this.show_type,expression:"this.show_type === 4"}],staticClass:"box-card"},[e("el-row",{attrs:{slot:"header"},slot:"header"},[e("el-page-header",{staticStyle:{color:"#409eff"},attrs:{content:"迁移磁盘"},on:{back:function(e){return t.show_volume_list()}}})],1),e("el-row",[e("el-form",{staticClass:"demo-ruleForm",attrs:{model:t.migrate_volume,"label-width":"100px"}},[e("el-form-item",{attrs:{label:"存储池",prop:"type"}},[e("el-select",{staticStyle:{width:"100%"},model:{value:t.migrate_volume.storageId,callback:function(e){t.$set(t.migrate_volume,"storageId",e)},expression:"migrate_volume.storageId"}},[e("el-option",{attrs:{label:"随机",value:0}}),t._l(this.storages,(function(t){return e("el-option",{key:t.storageId,attrs:{label:t.description,value:t.storageId}})}))],2)],1),e("el-form-item",{attrs:{label:"磁盘类型",prop:"volumeType"}},[e("el-select",{staticStyle:{width:"100%"},model:{value:t.migrate_volume.volumeType,callback:function(e){t.$set(t.migrate_volume,"volumeType",e)},expression:"migrate_volume.volumeType"}},[e("el-option",{attrs:{label:"raw",value:"raw"}}),e("el-option",{attrs:{label:"qcow",value:"qcow"}}),e("el-option",{attrs:{label:"qcow2",value:"qcow2"}}),e("el-option",{attrs:{label:"vdi",value:"vdi"}}),e("el-option",{attrs:{label:"vmdk",value:"vmdk"}}),e("el-option",{attrs:{label:"vpc",value:"vpc"}})],1)],1),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:t.migrate_volume_click}},[t._v("迁移")]),e("el-button",{on:{click:t.show_volume_list}},[t._v("取消")])],1)],1)],1)],1),e("el-dialog",{attrs:{title:"磁盘扩容",visible:t.resize_dialog_visiable,width:"300px"},on:{"update:visible":function(e){t.resize_dialog_visiable=e}}},[e("el-form",{attrs:{model:t.resize_volume,"label-width":"100px"}},[e("el-form-item",{attrs:{label:"磁盘大小(GB)"}},[e("el-input",{attrs:{placeholder:"请输入磁盘大小(GB)"},model:{value:t.resize_volume.size,callback:function(e){t.$set(t.resize_volume,"size",e)},expression:"resize_volume.size"}})],1)],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.resize_dialog_visiable=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.resize_volume_click}},[t._v("确 定")])],1)],1),e("el-dialog",{attrs:{title:"创建模版",visible:t.template_dialog_visiable,width:"400px"},on:{"update:visible":function(e){t.template_dialog_visiable=e}}},[e("el-form",{attrs:{model:t.resize_volume,"label-width":"100px"}},[e("el-form-item",{attrs:{label:"模版名称"}},[e("el-input",{attrs:{placeholder:"请输入模版名称"},model:{value:t.template_volume.name,callback:function(e){t.$set(t.template_volume,"name",e)},expression:"template_volume.name"}})],1)],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.template_dialog_visiable=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.create_volume_template_click}},[t._v("确 定")])],1)],1),e("el-dialog",{attrs:{title:"创建快照",visible:t.snapshot_dialog_visiable,width:"400px"},on:{"update:visible":function(e){t.snapshot_dialog_visiable=e}}},[e("el-form",{attrs:{model:t.snapshot_volume,"label-width":"100px"}},[e("el-form-item",{attrs:{label:"快照名称"}},[e("el-input",{attrs:{placeholder:"请输入快照名称"},model:{value:t.snapshot_volume.snapshotName,callback:function(e){t.$set(t.snapshot_volume,"snapshotName",e)},expression:"snapshot_volume.snapshotName"}})],1),e("el-form-item",{attrs:{label:"磁盘类型",prop:"volumeType"}},[e("el-select",{staticStyle:{width:"100%"},model:{value:t.snapshot_volume.snapshotVolumeType,callback:function(e){t.$set(t.snapshot_volume,"snapshotVolumeType",e)},expression:"snapshot_volume.snapshotVolumeType"}},[e("el-option",{attrs:{label:"raw",value:"raw"}}),e("el-option",{attrs:{label:"qcow",value:"qcow"}}),e("el-option",{attrs:{label:"qcow2",value:"qcow2"}}),e("el-option",{attrs:{label:"vdi",value:"vdi"}}),e("el-option",{attrs:{label:"vmdk",value:"vmdk"}}),e("el-option",{attrs:{label:"vpc",value:"vpc"}})],1)],1)],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.snapshot_dialog_visiable=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.create_volume_snapshot_click}},[t._v("确 定")])],1)],1),e("el-dialog",{attrs:{title:"下载磁盘",visible:t.download_dialog_visiable,width:"400px"},on:{"update:visible":function(e){t.download_dialog_visiable=e}}},[e("el-form",{attrs:{model:t.download_volume,"label-width":"100px"}},[e("el-form-item",{attrs:{label:"磁盘类型",prop:"volumeType"}},[e("el-select",{staticStyle:{width:"100%"},model:{value:t.download_volume.volumeType,callback:function(e){t.$set(t.download_volume,"volumeType",e)},expression:"download_volume.volumeType"}},[e("el-option",{attrs:{label:"raw",value:"raw"}}),e("el-option",{attrs:{label:"qcow",value:"qcow"}}),e("el-option",{attrs:{label:"qcow2",value:"qcow2"}}),e("el-option",{attrs:{label:"vdi",value:"vdi"}}),e("el-option",{attrs:{label:"vmdk",value:"vmdk"}}),e("el-option",{attrs:{label:"vpc",value:"vpc"}})],1)],1)],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.download_dialog_visiable=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.download_volume_click}},[t._v("下载")])],1)],1),e("el-card",{directives:[{name:"show",rawName:"v-show",value:5===this.show_type,expression:"this.show_type === 5"}],staticClass:"box-card"},[e("el-row",{attrs:{slot:"header"},slot:"header"},[e("el-page-header",{staticStyle:{color:"#409eff"},attrs:{content:"上传磁盘"},on:{back:function(e){return t.show_volume_list()}}})],1),e("el-row",[e("el-form",{ref:"uploadForm",staticClass:"demo-ruleForm",attrs:{model:t.upload_volume,"label-width":"100px"}},[e("el-form-item",{attrs:{label:"名称",prop:"description"}},[e("el-input",{model:{value:t.upload_volume.description,callback:function(e){t.$set(t.upload_volume,"description",e)},expression:"upload_volume.description"}})],1),e("el-form-item",{attrs:{label:"存储池",prop:"storageId"}},[e("el-select",{staticStyle:{width:"100%"},model:{value:t.upload_volume.storageId,callback:function(e){t.$set(t.upload_volume,"storageId",e)},expression:"upload_volume.storageId"}},[e("el-option",{attrs:{label:"随机",value:0}}),t._l(this.storages,(function(t){return e("el-option",{key:t.storageId,attrs:{label:t.description,value:t.storageId}})}))],2)],1),e("el-form-item",{attrs:{label:"目标磁盘类型",prop:"volumeType"}},[e("el-select",{staticStyle:{width:"100%"},model:{value:t.upload_volume.volumeType,callback:function(e){t.$set(t.upload_volume,"volumeType",e)},expression:"upload_volume.volumeType"}},[e("el-option",{attrs:{label:"raw",value:"raw"}}),e("el-option",{attrs:{label:"qcow",value:"qcow"}}),e("el-option",{attrs:{label:"qcow2",value:"qcow2"}}),e("el-option",{attrs:{label:"vdi",value:"vdi"}}),e("el-option",{attrs:{label:"vmdk",value:"vmdk"}}),e("el-option",{attrs:{label:"vpc",value:"vpc"}})],1)],1),e("el-form-item",[e("el-upload",{ref:"upload",staticClass:"upload-demo",staticStyle:{"max-width":"300px"},attrs:{action:t.get_upload_uri(),limit:1,"on-success":t.on_upload_success,"on-error":t.on_upload_error,name:"volume",data:t.upload_volume,"file-list":t.upload_file_list,"auto-upload":!1,"show-file-list":!0}},[e("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[t._v("选择磁盘")])],1)],1),e("el-form-item",[e("el-button",{attrs:{type:"primary",loading:t.uploading},on:{click:t.upload_volume_click}},[t._v("导入")]),e("el-button",{on:{click:t.show_volume_list}},[t._v("取消")])],1)],1)],1)],1)],1)],1)],1)},ue=[];o(89554),o(54747),o(73210),o(21249),o(26699),o(32023),o(69600),o(92222);const de={name:"volumeView",components:{},data:function(){return{data_loading:!1,resize_dialog_visiable:!1,template_dialog_visiable:!1,snapshot_dialog_visiable:!1,download_dialog_visiable:!1,current_volume_id:0,current_loading:!1,uploading:!1,show_type:-1,select_storage_id:0,show_volume:{},create_volume:{description:"",storageId:0,volumeType:"qcow2",volumeSize:100},upload_file_list:[],upload_volume:{description:"",storageId:0,volumeType:"qcow2"},download_volume:{volumeType:"qcow2",volumeId:0},clone_volume:{sourceVolumeId:0,description:"",storageId:0,volumeType:"qcow2"},migrate_volume:{sourceVolumeId:0,storageId:0,volumeType:"qcow2"},resize_volume:{volumeId:0,size:100},template_volume:{volumeId:0,name:""},snapshot_volume:{volumeId:0,snapshotName:"",snapshotVolumeType:"qcow2"},keyword:"",volumes:[],storages:[],select_volumes:[],current_page:1,page_size:10,total_size:0}},mixins:[Pt],mounted:function(){var t=this;this.current_volume_id=this.$route.query.id,this.current_volume_id?(this.show_type,this.current_loading=!0,Uo({volumeId:this.current_volume_id}).then((function(e){0===e.code?t.show_volume_info(e.data):t.$alert("获取磁盘信息失败:".concat(e.message),"提示",{dangerouslyUseHTMLString:!0,confirmButtonText:"返回",type:"error"}).then((function(){t.show_type=0}))}))["finally"]((function(){t.current_loading=!1}))):this.show_type=0,this.init_view(),this.init_notify()},computed:{show_table_volumes:function(){return this.volumes.filter((function(t){return void 0===t.isShow||t.isShow}))}},methods:{handleSelectionChange:function(t){this.select_volumes=t},get_upload_uri:function(){return"./api/volume/upload"},init_view:function(){var t=this;return(0,x.Z)((0,I.Z)().mark((function e(){return(0,I.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.data_loading=!0,e.next=3,Io().then((function(e){0==e.code&&(t.storages=e.data)}));case 3:return e.next=5,Ro().then((function(e){0==e.code&&(t.volumes=e.data,t.update_show_page())}))["finally"]((function(){t.data_loading=!1}));case 5:case"end":return e.stop()}}),e)})))()},on_current_page_change:function(t){this.current_page=t,this.update_show_page()},on_page_size_change:function(t){this.page_size=t,this.update_show_page()},update_show_page:function(){var t=this,e=0;this.volumes.forEach((function(o,s){var a=!0,n=t.keyword.trim().toLowerCase();if(""!==n){var r=o.attach?o.attach.description.toLowerCase():"";a=""+o.volumeId===n||o.description.toLowerCase().indexOf(n)>=0||r.indexOf(n)>=0}var i=!0;t.select_storage_id>0&&(i=o.storageId===t.select_storage_id),a&&i?(e++,e<=t.page_size*(t.current_page-1)||e>t.page_size*t.current_page?o.isShow=!1:o.isShow=!0):o.isShow=!1,t.$set(t.volumes,s,o)})),this.total_size=e},get_storage_name:function(t){var e=this.storages.find((function(e){return e.storageId===t}))||{description:"-"};return e.description},get_volume_status:function(t){switch(t.status){case 0:return"正在创建";case 1:return"已就绪";case 2:return"正在挂载";case 3:return"正在卸载";case 4:return"正在克隆";case 5:return"创建模版";case 6:return"创建快照";case 7:return"正在迁移";case 8:return"正在扩容";case 9:return"正在销毁";case 10:return"磁盘错误";default:return"未知状态[".concat(t.status,"]")}},update_volume_info:function(t){var e=this,o=this.select_volumes.map((function(t){return t.volumeId})),s=this.volumes.findIndex((function(e){return e.volumeId===t.volumeId}));if(s>=0)this.$set(this.volumes,s,t);else{var a=this.page_size*(this.current_page-1);this.volumes.splice(a,0,t)}this.show_volume&&this.show_volume.volumeId===t.volumeId&&(this.show_volume=t),this.update_show_page(),this.$nextTick((function(){e.volumes.forEach((function(t){o.includes(t.volumeId)&&t.isShow&&e.$refs.volumeTable.toggleRowSelection(t)}))}))},handle_notify_message:function(t){var e=this;2===t.type&&Uo({volumeId:t.id}).then((function(o){if(0==o.code)e.update_volume_info(o.data);else if(4000001==o.code){var s=e.select_volumes.map((function(t){return t.volumeId})),a=e.volumes.findIndex((function(e){return e.volumeId===t.id}));a>=0&&e.volumes.splice(a,1),e.$nextTick((function(){e.volumes.forEach((function(t){s.includes(t.volumeId)&&t.isShow&&e.$refs.volumeTable.toggleRowSelection(t)}))}))}}))},show_volume_list:function(){this.show_type=0},show_create_volume:function(){this.$refs["createForm"]&&this.$refs["createForm"].resetFields(),this.show_type=2},show_upload_volume:function(){this.$refs["uploadForm"]&&this.$refs["uploadForm"].resetFields(),this.uploading=!1,this.upload_file_list=[],this.show_type=5},upload_volume_click:function(){this.uploading=!0,this.$refs.upload.submit()},show_volume_info:function(t){var e=this;return(0,x.Z)((0,I.Z)().mark((function o(){return(0,I.Z)().wrap((function(o){while(1)switch(o.prev=o.next){case 0:return e.show_volume=t,o.next=3,e.init_volume_template(t);case 3:e.show_type=1;case 4:case"end":return o.stop()}}),o)})))()},init_volume_template:function(t){return(0,x.Z)((0,I.Z)().mark((function e(){return(0,I.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(0!==t.templateId){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,zo({templateId:t.templateId}).then((function(e){0==e.code&&(t.template=e.data)}));case 4:case"end":return e.stop()}}),e)})))()},create_volume_click:function(){var t=this;Oo(this.create_volume).then((function(e){0===e.code?(t.update_volume_info(e.data),t.show_type=0):t.$notify.error({title:"错误",message:"创建磁盘失败:".concat(e.message)})}))},update_volume_status:function(t,e){var o=this.volumes.find((function(e){return e.volumeId===t}));o&&(o.status=e)},menu_command_click:function(t){switch(t.command){case"info":this.show_volume_info(t.volume);break;case"resize":this.show_resize_volume_click(t.volume);break;case"snapshote":this.show_create_volume_snapshot_click(t.volume);break;case"clone":this.show_clone_volume_click(t.volume);break;case"migrate":this.show_migrate_volume_click(t.volume);break;case"template":this.show_create_volume_template_click(t.volume);break;case"destroy":this.destroy_volume(t.volume);break}},show_download_volume_click:function(t){this.download_volume.volumeId=t.volumeId,this.clone_volume.volumeType=t.type,this.download_dialog_visiable=!0},show_clone_volume_click:function(t){this.clone_volume.sourceVolumeId=t.volumeId,this.clone_volume.volumeType=t.type,this.clone_volume.description="Clone-"+t.description,this.clone_volume.storageId=t.storageId,this.show_type=3},show_migrate_volume_click:function(t){this.migrate_volume.sourceVolumeId=t.volumeId,this.migrate_volume.volumeType=t.type,this.migrate_volume.storageId=t.storageId,this.show_type=4},show_create_volume_template_click:function(t){this.template_volume.volumeId=t.volumeId,this.template_volume.name="",this.template_dialog_visiable=!0},show_resize_volume_click:function(t){this.resize_volume.volumeId=t.volumeId,this.resize_volume.size=100,this.resize_dialog_visiable=!0},show_create_volume_snapshot_click:function(t){this.snapshot_volume.volumeId=t.volumeId,this.snapshot_volume.name="",this.snapshot_volume.snapshotVolumeType=t.type,this.snapshot_dialog_visiable=!0},clone_volume_click:function(){var t=this;this.$confirm("克隆磁盘, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Ao(t.clone_volume).then((function(e){0===e.code?(t.update_volume_info(e.data.clone),t.update_volume_info(e.data.source),t.show_type=0):t.$notify.error({title:"错误",message:"克隆磁盘失败:".concat(e.message)})}))}))["catch"]((function(){}))},migrate_volume_click:function(){var t=this;this.$confirm("迁移磁盘, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Eo(t.migrate_volume).then((function(e){0===e.code?(t.update_volume_info(e.data.migrate),t.update_volume_info(e.data.source),t.show_type=0):t.$notify.error({title:"错误",message:"迁移磁盘失败:".concat(e.message)})}))}))["catch"]((function(){}))},resize_volume_click:function(){var t=this;this.$confirm("扩容磁盘, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Lo(t.resize_volume).then((function(e){0===e.code?(t.update_volume_info(e.data),t.resize_dialog_visiable=!1):t.$notify.error({title:"错误",message:"扩容磁盘失败:".concat(e.message)})}))}))["catch"]((function(){}))},create_volume_template_click:function(){var t=this;this.$confirm("创建磁盘模版, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Bo(t.template_volume).then((function(e){0===e.code?(t.update_volume_status(t.template_volume.volumeId,5),t.template_dialog_visiable=!1):t.$notify.error({title:"错误",message:"创建磁盘模版失败:".concat(e.message)})}))}))["catch"]((function(){}))},create_volume_snapshot_click:function(){var t=this;this.$confirm("创建磁盘快照, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Go(t.snapshot_volume).then((function(e){0===e.code?(t.update_volume_status(t.snapshot_volume.volumeId,6),t.snapshot_dialog_visiable=!1):t.$notify.error({title:"错误",message:"创建磁盘快照失败:".concat(e.message)})}))}))["catch"]((function(){}))},get_volume_desplay_size:function(t){return t>=1099511627776?(t/1099511627776).toFixed(2)+" TB":t>=1073741824?(t/1073741824).toFixed(2)+" GB":t>=1048576?(t/1048576).toFixed(2)+" MB":t>=1024?(t/1024).toFixed(2)+"  KB":t+"  bytes"},destroy_volume:function(t){var e=this;this.$confirm("删除磁盘, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){console.log(t),Ho({volumeId:t.volumeId}).then((function(t){0===t.code?(e.update_volume_info(t.data),e.show_type=0):e.$notify.error({title:"错误",message:"删除磁盘失败:".concat(t.message)})}))}))["catch"]((function(){}))},batch_destroy_volume_click:function(){var t=this;this.$confirm("批量删除所选磁盘, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var e=t.select_volumes.map((function(t){return t.volumeId})).join(",");jo({volumeIds:e}).then((function(e){0===e.code?e.data.filter((function(e){t.update_volume_info(e)})):t.$notify.error({title:"错误",message:"批量删除磁盘:".concat(e.message)})}))}))["catch"]((function(){}))},on_upload_success:function(t){this.uploading=!1,0===t.code?(this.update_volume_info(t.data),this.show_type=0,this.upload_file_list=[]):(this.upload_file_list=[],this.$notify.error({title:"错误",message:"上传磁盘失败:".concat(t.message)}))},on_upload_error:function(){this.uploading=!1,this.upload_file_list=[],this.$notify.error({title:"错误",message:"磁盘上传失败。"})},download_volume_click:function(){var t="./api/volume/download?volumeId=".concat(this.download_volume.volumeId,"&volumeType=").concat(this.download_volume.volumeType);window.open(t,"_blank"),this.download_dialog_visiable=!1}}},_e=de;var pe=(0,u.Z)(_e,ce,ue,!1,null,"21a89ac0",null);const he=pe.exports;var me=function(){var t=this,e=t._self._c;return e("div",[e("el-container",[e("el-main",[e("el-card",{directives:[{name:"show",rawName:"v-show",value:0===this.show_type,expression:"this.show_type === 0"}],staticClass:"box-card"},[e("el-row",{staticClass:"clearfix",staticStyle:{height:"20px"},attrs:{slot:"header"},slot:"header"},[e("el-button",{staticStyle:{float:"left",padding:"3px 0"},attrs:{type:"text"},on:{click:t.show_crate_scheme_info_click}},[t._v("创建计算方案")])],1),e("el-row",[e("el-table",{staticStyle:{width:"100%"},attrs:{"v-loading":t.data_loading,data:t.schemes}},[e("el-table-column",{attrs:{label:"ID",prop:"schemeId",width:"80"}}),e("el-table-column",{attrs:{label:"名称",prop:"name","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{label:"CPU",prop:"cpu",width:"120"}}),e("el-table-column",{attrs:{label:"内存",prop:"memory",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.get_memory_desplay(e.row.memory))+" ")]}}])}),e("el-table-column",{attrs:{label:"操作","min-width":"380"},scopedSlots:t._u([{key:"default",fn:function(o){return[e("el-button",{attrs:{type:"",size:"mini"},on:{click:function(e){return t.show_scheme_info_click(o.row)}}},[t._v("详情")]),e("el-button",{attrs:{type:"",size:"mini"},on:{click:function(e){return t.show_modify_scheme(o.row)}}},[t._v("修改")]),e("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){return t.destroy_scheme(o.row)}}},[t._v("删除")])]}}])})],1)],1)],1),e("SchemeInfoComponent",{directives:[{name:"show",rawName:"v-show",value:1===this.show_type,expression:"this.show_type === 1"}],ref:"SchemeInfoComponentRef",on:{back:function(e){return t.show_scheme_list()},onHostUpdate:t.update_scheme_info}}),e("el-card",{directives:[{name:"show",rawName:"v-show",value:2===this.show_type,expression:"this.show_type === 2"}],staticClass:"box-card"},[e("el-row",{attrs:{slot:"header"},slot:"header"},[e("el-page-header",{staticStyle:{color:"#409eff"},attrs:{content:"创建计算方案"},on:{back:function(e){return t.show_scheme_list()}}})],1),e("el-row",[e("el-form",{ref:"createForm",staticClass:"demo-ruleForm",attrs:{model:t.create_scheme,"label-width":"100px"}},[e("el-form-item",{attrs:{label:"名称",prop:"name"}},[e("el-input",{model:{value:t.create_scheme.name,callback:function(e){t.$set(t.create_scheme,"name",e)},expression:"create_scheme.name"}})],1),e("el-form-item",{attrs:{label:"CPU",prop:"cpu"}},[e("el-input",{model:{value:t.create_scheme.cpu,callback:function(e){t.$set(t.create_scheme,"cpu",e)},expression:"create_scheme.cpu"}})],1),e("el-form-item",{attrs:{label:"内存(MB)",prop:"memory"}},[e("el-input",{model:{value:t.create_scheme.memory,callback:function(e){t.$set(t.create_scheme,"memory",e)},expression:"create_scheme.memory"}})],1),e("el-form-item",{attrs:{label:"配额",prop:"speed"}},[e("el-input",{model:{value:t.create_scheme.speed,callback:function(e){t.$set(t.create_scheme,"speed",e)},expression:"create_scheme.speed"}})],1),e("el-form-item",{attrs:{label:"Cores",prop:"cores"}},[e("el-input",{model:{value:t.create_scheme.cores,callback:function(e){t.$set(t.create_scheme,"cores",e)},expression:"create_scheme.cores"}})],1),e("el-form-item",{attrs:{label:"Sockets",prop:"sockets"}},[e("el-input",{model:{value:t.create_scheme.sockets,callback:function(e){t.$set(t.create_scheme,"sockets",e)},expression:"create_scheme.sockets"}})],1),e("el-form-item",{attrs:{label:"Threads",prop:"threads"}},[e("el-input",{model:{value:t.create_scheme.threads,callback:function(e){t.$set(t.create_scheme,"threads",e)},expression:"create_scheme.threads"}})],1),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:t.create_scheme_click}},[t._v("立即创建")]),e("el-button",{on:{click:t.show_scheme_list}},[t._v("取消")])],1)],1)],1)],1),e("el-card",{directives:[{name:"show",rawName:"v-show",value:3===this.show_type,expression:"this.show_type === 3"}],staticClass:"box-card"},[e("el-row",{attrs:{slot:"header"},slot:"header"},[e("el-page-header",{staticStyle:{color:"#409eff"},attrs:{content:"修改计算方案"},on:{back:function(e){return t.show_scheme_list()}}})],1),e("el-row",[e("el-form",{staticClass:"demo-ruleForm",attrs:{model:t.modify_scheme,"label-width":"100px"}},[e("el-form-item",{attrs:{label:"名称",prop:"name"}},[e("el-input",{model:{value:t.modify_scheme.name,callback:function(e){t.$set(t.modify_scheme,"name",e)},expression:"modify_scheme.name"}})],1),e("el-form-item",{attrs:{label:"CPU",prop:"cpu"}},[e("el-input",{model:{value:t.modify_scheme.cpu,callback:function(e){t.$set(t.modify_scheme,"cpu",e)},expression:"modify_scheme.cpu"}})],1),e("el-form-item",{attrs:{label:"内存(MB)",prop:"memory"}},[e("el-input",{model:{value:t.modify_scheme.memory,callback:function(e){t.$set(t.modify_scheme,"memory",e)},expression:"modify_scheme.memory"}})],1),e("el-form-item",{attrs:{label:"配额",prop:"speed"}},[e("el-input",{model:{value:t.modify_scheme.speed,callback:function(e){t.$set(t.modify_scheme,"speed",e)},expression:"modify_scheme.speed"}})],1),e("el-form-item",{attrs:{label:"Cores",prop:"cores"}},[e("el-input",{model:{value:t.modify_scheme.cores,callback:function(e){t.$set(t.modify_scheme,"cores",e)},expression:"modify_scheme.cores"}})],1),e("el-form-item",{attrs:{label:"Sockets",prop:"sockets"}},[e("el-input",{model:{value:t.modify_scheme.sockets,callback:function(e){t.$set(t.modify_scheme,"sockets",e)},expression:"modify_scheme.sockets"}})],1),e("el-form-item",{attrs:{label:"Threads",prop:"threads"}},[e("el-input",{model:{value:t.modify_scheme.threads,callback:function(e){t.$set(t.modify_scheme,"threads",e)},expression:"modify_scheme.threads"}})],1),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:t.modify_scheme_click}},[t._v("修改")]),e("el-button",{on:{click:function(e){t.show_type=0}}},[t._v("取消")])],1)],1)],1)],1)],1)],1)],1)},fe=[];const we={name:"schemeView",components:{SchemeInfoComponent:$t},data:function(){return{data_loading:!1,current_scheme_id:0,show_type:-1,show_scheme:{},create_scheme:{name:"",cpu:1,memory:512,speed:0,sockets:0,cores:0,threads:0},modify_scheme:{schemeId:0,name:"",cpu:1,memory:512,speed:0,sockets:0,cores:0,threads:0},schemes:[]}},mixins:[Pt],mounted:function(){this.show_type=0,this.init_notify(),this.init_view()},methods:{init_view:function(){var t=this;return(0,x.Z)((0,I.Z)().mark((function e(){return(0,I.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.data_loading=!0,e.next=3,Ko().then((function(e){0==e.code&&(t.schemes=e.data)}))["finally"]((function(){t.data_loading=!1}));case 3:case"end":return e.stop()}}),e)})))()},update_scheme_info:function(t){var e=this.schemes.findIndex((function(e){return e.schemeId===t.schemeId}));e>=0?this.$set(this.schemes,e,t):this.schemes.push(t),this.$refs.SchemeInfoComponentRef.init_scheme(t),this.$forceUpdate()},handle_notify_message:function(t){var e=this;8===t.type&&Xo({schemeId:t.id}).then((function(o){if(0==o.code)e.update_scheme_info(o.data);else if(8000001==o.code){var s=e.schemes.findIndex((function(e){return e.networkId===t.id}));s>=0&&e.schemes.splice(s,1)}e.$forceUpdate()}))},show_scheme_list:function(){this.show_type=0},show_crate_scheme_info_click:function(){this.$refs["createForm"]&&this.$refs["createForm"].resetFields(),this.show_type=2},show_modify_scheme:function(t){this.modify_scheme.schemeId=t.schemeId,this.modify_scheme.name=t.name,this.modify_scheme.cpu=t.cpu,this.modify_scheme.memory=t.memory/1024,this.modify_scheme.speed=t.speed,this.modify_scheme.sockets=t.sockets,this.modify_scheme.cores=t.cores,this.modify_scheme.threads=t.threads,this.show_type=3},show_scheme_info_click:function(t){this.show_scheme=t,this.$refs.SchemeInfoComponentRef.init_scheme(t),this.show_type=1},create_scheme_click:function(){var t=this;Jo(this.create_scheme).then((function(e){0===e.code?(t.update_scheme_info(e.data),t.show_type=0):t.$notify.error({title:"错误",message:"创建计算方案失败:".concat(e.message)})}))},modify_scheme_click:function(){var t=this;this.$confirm("修改计算方案, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Qo(t.modify_scheme).then((function(e){0===e.code?(t.update_scheme_info(e.data),t.show_type=0):t.$notify.error({title:"错误",message:"修改计算方案失败:".concat(e.message)})}))}))["catch"]((function(){}))},get_memory_desplay:function(t){return t>=1048576?parseInt(t/1048576)+" GB":t>=1024?parseInt(t/1024)+"  MB":void 0},destroy_scheme:function(t){var e=this;this.$confirm("删除计算方案, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Wo({schemeId:t.schemeId}).then((function(o){if(0===o.code){var s=e.schemes.findIndex((function(e){return e.schemeId===t.schemeId}));s>=0&&e.schemes.splice(s,1),e.show_type=0}else e.$notify.error({title:"错误",message:"删除计算方案失败:".concat(o.message)})}))}))["catch"]((function(){}))}}},ge=we;var ve=(0,u.Z)(ge,me,fe,!1,null,"6c88c4f3",null);const ye=ve.exports;var be=function(){var t=this,e=t._self._c;return e("div",[e("el-container",[e("el-main",[e("el-card",{directives:[{name:"show",rawName:"v-show",value:0===this.show_type,expression:"this.show_type === 0"}],staticClass:"box-card"},[e("el-row",{staticClass:"clearfix",staticStyle:{height:"30px"},attrs:{slot:"header"},slot:"header"},[e("div",{staticStyle:{float:"left"}},[e("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[e("el-form-item",[e("el-link",{attrs:{type:"primary"},on:{click:t.show_create_guest_click}},[t._v("创建虚拟机")])],1),e("el-form-item",[e("el-link",{staticStyle:{padding:"0 10px"},attrs:{disabled:!t.select_guests.length,type:"primary"},on:{click:t.batch_start_guest_click}},[t._v("批量启动")])],1),e("el-form-item",[e("el-link",{attrs:{disabled:!t.select_guests.length,type:"danger"},on:{click:t.batch_stop_guest_click}},[t._v("批量停止")])],1),e("el-form-item",{attrs:{label:"运行主机"}},[e("el-select",{staticStyle:{width:"100%"},on:{change:t.update_guest_show_page},model:{value:t.select_host_id,callback:function(e){t.select_host_id=e},expression:"select_host_id"}},[e("el-option",{attrs:{label:"全部",value:0}}),t._l(this.hosts,(function(t){return e("el-option",{key:t.hostId,attrs:{label:t.displayName,value:t.hostId}})}))],2)],1)],1)],1),e("div",[e("el-input",{staticStyle:{float:"right",width:"300px","margin-bottom":"10px"},attrs:{placeholder:"请输入搜索关键字"},on:{input:t.update_guest_show_page},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}})],1)]),e("el-row",[e("el-table",{ref:"guestTable",staticStyle:{width:"100%"},attrs:{"v-loading":t.data_loading,data:t.show_table_guests},on:{"selection-change":t.handleSelectionChange}},[e("el-table-column",{attrs:{type:"selection",width:"55"}}),e("el-table-column",{attrs:{label:"ID",prop:"guestId",width:"80"}}),e("el-table-column",{attrs:{label:"实例名",prop:"name",width:"180","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{label:"标签",prop:"description",width:"180"}}),e("el-table-column",{attrs:{label:"IP地址",prop:"guestIp",width:"150"}}),e("el-table-column",{attrs:{label:"配置",prop:"cpu",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.cpu)+"核/"+t._s(t.get_memory_desplay(e.row.memory)))]}}])}),e("el-table-column",{attrs:{label:"类型",width:"100"},scopedSlots:t._u([{key:"default",fn:function(o){return[e("el-tag",[t._v(t._s(0===o.row.type?"系统主机":"用户主机"))])]}}])}),e("el-table-column",{attrs:{label:"状态",prop:"status",width:"100"},scopedSlots:t._u([{key:"default",fn:function(o){return[e("el-tag",{attrs:{type:2===o.row.status?"success":"danger"}},[t._v(t._s(t.get_guest_status(o.row)))])]}}])}),e("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(o){return[e("el-dropdown",{attrs:{size:"small","split-button":"",placement:"bottom-end",type:"primary"},on:{click:function(e){return t.show_guest_info_click(o.row)},command:t.menu_command_click}},[t._v(" 虚拟机管理 "),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e("el-dropdown-item",{attrs:{command:{guest:o.row,command:"info"}}},[t._v("虚拟机详情")]),e("el-dropdown-item",{attrs:{command:{guest:o.row,command:"start"},divided:"",disabled:4!==o.row.status}},[t._v("启动虚拟机")]),e("el-dropdown-item",{attrs:{command:{guest:o.row,command:"stop"},disabled:2!==o.row.status}},[t._v("停止虚拟机")]),e("el-dropdown-item",{attrs:{command:{guest:o.row,command:"vnc"},disabled:2!==o.row.status}},[t._v("远程桌面")]),e("el-dropdown-item",{attrs:{command:{guest:o.row,command:"reboot"},disabled:2!==o.row.status}},[t._v("重启虚拟机")]),0!==o.row.type?e("el-dropdown-item",{attrs:{command:{guest:o.row,command:"attach_cd"},disabled:0!==o.row.cdRoom}},[t._v("挂载光驱")]):t._e(),0!==o.row.type?e("el-dropdown-item",{attrs:{command:{guest:o.row,command:"detach_cd"},disabled:0===o.row.cdRoom}},[t._v("卸载光驱")]):t._e(),e("el-dropdown-item",{attrs:{command:{guest:o.row,command:"destroy"},divided:""}},[t._v("销毁虚拟机")])],1)],1)]}}])})],1),e("el-pagination",{attrs:{"current-page":t.current_page,"page-size":t.page_size,"page-sizes":[5,10,20,50,100,200],total:t.total_size,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":t.on_page_size_change,"current-change":t.on_current_page_change}})],1)],1),e("GuestInfoComponent",{directives:[{name:"show",rawName:"v-show",value:1===this.show_type,expression:"this.show_type === 1"}],ref:"GuestInfoComponentRef",on:{back:t.show_guest_list_page,onGuestUpdate:t.update_guest_info}}),e("CreateGuestComponent",{directives:[{name:"show",rawName:"v-show",value:2===this.show_type,expression:"this.show_type === 2"}],ref:"CreateGuestComponentRef",on:{back:t.show_guest_list_page,onGuestUpdate:t.update_guest_info}})],1)],1),e("AttachCdRoomComponent",{ref:"AttachCdRoomComponentRef",on:{onGuestUpdate:t.update_guest_info}}),e("StartGuestComponent",{ref:"StartGuestComponentRef",on:{onGuestUpdate:t.update_guest_info}}),e("StopGuestComponent",{ref:"StopGuestComponentRef",on:{onGuestUpdate:t.update_guest_info}})],1)},ke=[],Ie=function(){var t=this,e=t._self._c;return e("el-card",{staticClass:"box-card"},[e("el-row",{attrs:{slot:"header"},slot:"header"},[e("el-page-header",{staticStyle:{color:"#409eff"},attrs:{content:"创建虚拟机"},on:{back:t.on_back_click}})],1),e("el-row",[e("el-form",{ref:"createForm",staticClass:"demo-ruleForm",attrs:{model:t.create_guest,"label-width":"100px"}},[e("el-row",[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"标签",prop:"description"}},[e("el-input",{model:{value:t.create_guest.description,callback:function(e){t.$set(t.create_guest,"description",e)},expression:"create_guest.description"}})],1)],1),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"总线方式"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"总线方式"},model:{value:t.create_guest.busType,callback:function(e){t.$set(t.create_guest,"busType",e)},expression:"create_guest.busType"}},[e("el-option",{attrs:{label:"virtio",value:"virtio"}}),e("el-option",{attrs:{label:"ide",value:"ide"}}),e("el-option",{attrs:{label:"scsi",value:"scsi"}})],1)],1)],1)],1),e("el-row",[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"运行主机"}},[e("el-select",{staticStyle:{width:"100%"},model:{value:t.create_guest.hostId,callback:function(e){t.$set(t.create_guest,"hostId",e)},expression:"create_guest.hostId"}},[e("el-option",{attrs:{label:"随机",value:0}}),t._l(this.hosts,(function(t){return e("el-option",{key:t.hostId,attrs:{label:t.displayName,value:t.hostId}})}))],2)],1)],1),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"架构"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择架构"},model:{value:t.create_guest.schemeId,callback:function(e){t.$set(t.create_guest,"schemeId",e)},expression:"create_guest.schemeId"}},t._l(this.schemes,(function(t){return e("el-option",{key:t.schemeId,attrs:{label:t.name,value:t.schemeId}})})),1)],1)],1)],1),e("el-row",[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"网络"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择网络"},model:{value:t.create_guest.networkId,callback:function(e){t.$set(t.create_guest,"networkId",e)},expression:"create_guest.networkId"}},t._l(this.networks,(function(t){return e("el-option",{key:t.networkId,attrs:{label:t.name,value:t.networkId}})})),1)],1)],1),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"网络驱动"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择网卡驱动"},model:{value:t.create_guest.networkDeviceType,callback:function(e){t.$set(t.create_guest,"networkDeviceType",e)},expression:"create_guest.networkDeviceType"}},[e("el-option",{attrs:{label:"virtio",value:"virtio"}}),e("el-option",{attrs:{label:"rtl8139",value:"rtl8139"}})],1)],1)],1)],1),e("el-row",[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"安装方式"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择安装方式"},model:{value:t.create_guest.type,callback:function(e){t.$set(t.create_guest,"type",e)},expression:"create_guest.type"}},[e("el-option",{attrs:{label:"ISO镜像",value:0}}),e("el-option",{attrs:{label:"模版安装",value:1}}),e("el-option",{attrs:{label:"快照安装",value:2}}),e("el-option",{attrs:{label:"现有磁盘",value:3}})],1)],1)],1),e("el-col",{attrs:{span:12}},[3!==t.create_guest.type?e("el-form-item",{attrs:{label:"磁盘类型"}},[e("el-select",{staticStyle:{width:"100%"},model:{value:t.create_guest.volumeType,callback:function(e){t.$set(t.create_guest,"volumeType",e)},expression:"create_guest.volumeType"}},[e("el-option",{attrs:{label:"raw",value:"raw"}}),e("el-option",{attrs:{label:"qcow",value:"qcow"}}),e("el-option",{attrs:{label:"qcow2",value:"qcow2"}}),e("el-option",{attrs:{label:"vdi",value:"vdi"}}),e("el-option",{attrs:{label:"vmdk",value:"vmdk"}}),e("el-option",{attrs:{label:"vpc",value:"vpc"}})],1)],1):t._e()],1)],1),e("el-row",[e("el-col",{attrs:{span:12}},[0===t.create_guest.type?e("el-form-item",{attrs:{label:"ISO模版"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择光盘镜像"},model:{value:t.create_guest.isoTemplateId,callback:function(e){t.$set(t.create_guest,"isoTemplateId",e)},expression:"create_guest.isoTemplateId"}},t._l(this.iso_template,(function(t){return e("el-option",{key:t.templateId,attrs:{label:t.name,value:t.templateId}})})),1)],1):t._e(),1===t.create_guest.type?e("el-form-item",{attrs:{label:"系统模版"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择模版"},model:{value:t.create_guest.diskTemplateId,callback:function(e){t.$set(t.create_guest,"diskTemplateId",e)},expression:"create_guest.diskTemplateId"}},t._l(this.disk_template,(function(t){return e("el-option",{key:t.templateId,attrs:{label:t.name,value:t.templateId}})})),1)],1):t._e(),2===t.create_guest.type?e("el-form-item",{attrs:{label:"快照模版"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择系统快照"},model:{value:t.create_guest.snapshotVolumeId,callback:function(e){t.$set(t.create_guest,"snapshotVolumeId",e)},expression:"create_guest.snapshotVolumeId"}},t._l(this.snapshot_template,(function(t){return e("el-option",{key:t.snapshotVolumeId,attrs:{label:t.name,value:t.snapshotVolumeId}})})),1)],1):t._e(),3===t.create_guest.type?e("el-form-item",{attrs:{label:"可用磁盘"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择系统磁盘"},model:{value:t.create_guest.volumeId,callback:function(e){t.$set(t.create_guest,"volumeId",e)},expression:"create_guest.volumeId"}},t._l(this.attach_volumes,(function(t){return e("el-option",{key:t.volumeId,attrs:{label:t.description,value:t.volumeId}})})),1)],1):t._e()],1),e("el-col",{attrs:{span:12}},[3!==t.create_guest.type?e("el-form-item",{attrs:{label:"存储池"}},[e("el-select",{staticStyle:{width:"100%"},model:{value:t.create_guest.storageId,callback:function(e){t.$set(t.create_guest,"storageId",e)},expression:"create_guest.storageId"}},[e("el-option",{attrs:{label:"随机",value:0}}),t._l(this.storages,(function(t){return e("el-option",{key:t.storageId,attrs:{label:t.description,value:t.storageId}})}))],2)],1):t._e()],1)],1),0===t.create_guest.type?e("el-form-item",{attrs:{label:"磁盘大小"}},[e("el-input",{model:{value:t.create_guest.size,callback:function(e){t.$set(t.create_guest,"size",e)},expression:"create_guest.size"}})],1):t._e(),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:t.create_guest_click}},[t._v("立即创建")]),e("el-button",{on:{click:t.on_back_click}},[t._v("取消")])],1)],1)],1)],1)},xe=[];const Te={data:function(){return{create_guest:{type:0,description:"",busType:"virtio",hostId:0,schemeId:"",networkId:"",networkDeviceType:"virtio",volumeType:"qcow2",isoTemplateId:"",diskTemplateId:"",snapshotVolumeId:"",volumeId:"",storageId:0,size:100},iso_template:[],attach_volumes:[],disk_template:[],storages:[],snapshot_template:[],schemes:[],hosts:[],networks:[]}},methods:{on_back_click:function(){this.$emit("back")},load_all_attach_volumes:function(){var t=this;return(0,x.Z)((0,I.Z)().mark((function e(){return(0,I.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Do().then((function(e){0===e.code&&(t.attach_volumes=e.data)}));case 2:case"end":return e.stop()}}),e)})))()},load_all_template:function(){var t=this;return(0,x.Z)((0,I.Z)().mark((function e(){return(0,I.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Zo().then((function(e){0===e.code&&(t.iso_template=e.data.filter((function(t){return 0==t.templateType&&2===t.status})),t.disk_template=e.data.filter((function(t){return 2==t.templateType&&2===t.status})))}));case 2:case"end":return e.stop()}}),e)})))()},load_all_storage:function(){var t=this;return(0,x.Z)((0,I.Z)().mark((function e(){return(0,I.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Io().then((function(e){0==e.code&&(t.storages=e.data.filter((function(t){return 1==t.status})))}));case 2:case"end":return e.stop()}}),e)})))()},load_all_snapshot:function(){var t=this;return(0,x.Z)((0,I.Z)().mark((function e(){return(0,I.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Fo().then((function(e){0==e.code&&(t.snapshot_template=e.data.filter((function(t){return 1==t.status})))}));case 2:case"end":return e.stop()}}),e)})))()},load_all_networks:function(){var t=this;return(0,x.Z)((0,I.Z)().mark((function e(){return(0,I.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,uo().then((function(e){0===e.code&&(t.networks=e.data.filter((function(t){return 2===t.status})))}));case 2:case"end":return e.stop()}}),e)})))()},load_all_host:function(){var t=this;return(0,x.Z)((0,I.Z)().mark((function e(){return(0,I.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,wo().then((function(e){0===e.code&&(t.hosts=e.data.filter((function(t){return 1==t.status})))}));case 2:case"end":return e.stop()}}),e)})))()},load_all_schemes:function(){var t=this;return(0,x.Z)((0,I.Z)().mark((function e(){return(0,I.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Ko().then((function(e){0===e.code&&(t.schemes=e.data)}));case 2:case"end":return e.stop()}}),e)})))()},init:function(){var t=this;return(0,x.Z)((0,I.Z)().mark((function e(){return(0,I.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.load_all_attach_volumes(),t.load_all_host(),t.load_all_template(),t.load_all_storage(),t.load_all_schemes(),t.load_all_networks(),t.load_all_snapshot(),t.$refs["createForm"]&&t.$refs["createForm"].resetFields(),t.create_guest.isoTemplateId="",t.create_guest.diskTemplateId="",t.create_guest.snapshotVolumeId="",t.create_guest.volumeId="",t.create_guest.type=0;case 13:case"end":return e.stop()}}),e)})))()},create_guest_click:function(){var t=this;switch(this.create_guest.type){case 0:this.create_guest.diskTemplateId=0,this.create_guest.snapshotVolumeId=0,this.create_guest.volumeId=0;break;case 1:this.create_guest.isoTemplateId=0,this.create_guest.snapshotVolumeId=0,this.create_guest.volumeId=0,this.create_guest.size=0;break;case 2:this.create_guest.isoTemplateId=0,this.create_guest.diskTemplateId=0,this.create_guest.volumeId=0,this.create_guest.size=0;break;case 3:this.create_guest.isoTemplateId=0,this.create_guest.diskTemplateId=0,this.create_guest.snapshotVolumeId=0,this.create_guest.size=0;break}is(this.create_guest).then((function(e){0===e.code?(t.$emit("onGuestUpdate",e.data),t.$nextTick((function(){t.on_back_click()}))):t.$notify.error({title:"错误",message:"创建虚拟机失败:".concat(e.message)})}))}}},$e=Te;var Se=(0,u.Z)($e,Ie,xe,!1,null,null,null);const Ce=Se.exports,Ze={name:"guestView",components:{StartGuestComponent:ot,StopGuestComponent:lt,GuestInfoComponent:zt,CreateGuestComponent:Ce,AttachCdRoomComponent:M},data:function(){return{data_loading:!1,select_host_id:0,show_type:-1,keyword:"",guests:[],storages:[],hosts:[],select_guests:[],current_page:1,page_size:10,total_size:0}},mixins:[Pt],mounted:function(){this.show_type=0,this.init_view(),this.init_notify()},computed:{show_table_guests:function(){return this.guests.filter((function(t){return void 0===t.isShow||t.isShow}))}},methods:{handleSelectionChange:function(t){this.select_guests=t},init_view:function(){var t=this;return(0,x.Z)((0,I.Z)().mark((function e(){return(0,I.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.data_loading=!0,e.next=3,ns().then((function(e){0==e.code&&(t.guests=e.data,t.update_guest_show_page())}))["finally"]((function(){t.data_loading=!1}));case 3:return e.next=5,t.load_all_host();case 5:case"end":return e.stop()}}),e)})))()},load_all_host:function(){var t=this;return(0,x.Z)((0,I.Z)().mark((function e(){return(0,I.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,wo().then((function(e){0===e.code&&(t.hosts=e.data.filter((function(t){return 1==t.status})))}));case 2:case"end":return e.stop()}}),e)})))()},on_current_page_change:function(t){this.current_page=t,this.update_guest_show_page()},on_page_size_change:function(t){this.page_size=t,this.update_guest_show_page()},update_guest_show_page:function(){var t=this,e=0;this.guests.forEach((function(o,s){var a=!0,n=t.keyword.trim().toLowerCase();""!==n&&(a=""+o.guestId===n||o.description.toLowerCase().indexOf(n)>=0||o.name.toLowerCase().indexOf(n)>=0||o.guestIp.toLowerCase().indexOf(n)>=0);var r=!0;t.select_host_id>0&&(r=o.hostId===t.select_host_id),a&&r?(e++,e<=t.page_size*(t.current_page-1)||e>t.page_size*t.current_page?o.isShow=!1:o.isShow=!0):o.isShow=!1,t.$set(t.guests,s,o)})),this.total_size=e},update_guest_info:function(t){var e=this;return(0,x.Z)((0,I.Z)().mark((function o(){var s,a,n;return(0,I.Z)().wrap((function(o){while(1)switch(o.prev=o.next){case 0:s=e.select_guests.map((function(t){return t.guestId})),a=e.guests.findIndex((function(e){return e.guestId===t.guestId})),a>=0?e.$set(e.guests,a,t):1===t.type&&(n=e.page_size*(e.current_page-1),e.guests.splice(n,0,t)),e.update_guest_show_page(),e.$nextTick((function(){e.guests.forEach((function(t){s.includes(t.guestId)&&t.isShow&&e.$refs.guestTable.toggleRowSelection(t)}))})),e.$refs.GuestInfoComponentRef.update_guest_info(t);case 6:case"end":return o.stop()}}),o)})))()},get_memory_desplay:function(t){return t>=1048576?(t/1048576).toFixed(2)+" GB":t>=1024?(t/1024).toFixed(2)+"  MB":t+" KB"},get_guest_status:function(t){switch(t.status){case 0:return"正在创建";case 1:return"正在启动";case 2:return"正在运行";case 3:return"正在停止";case 4:return"已停止";case 5:return"重启中";case 6:return"虚拟机错误";default:return"未知状态[".concat(t.status,"]")}},handle_notify_message:function(t){var e=this;1===t.type?Yo({guestId:t.id}).then((function(o){if(0==o.code)e.update_guest_info(o.data);else if(2000001==o.code){var s=e.select_guests.map((function(t){return t.guestId})),a=e.guests.findIndex((function(e){return e.guestId===t.id}));a>=0&&e.guests.splice(a,1),e.$nextTick((function(){e.guests.forEach((function(t){s.includes(t.guestId)&&t.isShow&&e.$refs.guestTable.toggleRowSelection(t)}))}))}})):4===t.type?4===t.type&&go({hostId:t.id}).then((function(t){0==t.code&&e.$refs.GuestInfoComponentRef.refresh_host(t.data)})):8===t.type&&Xo({schemeId:t.id}).then((function(t){0==t.code&&e.$refs.GuestInfoComponentRef.refresh_scheme(t.data)}))},show_guest_list_page:function(){this.show_type=0},show_host_back:function(){this.show_type=1},show_create_guest_click:function(){var t=this;return(0,x.Z)((0,I.Z)().mark((function e(){return(0,I.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$refs.CreateGuestComponentRef.init(),t.show_type=2;case 2:case"end":return e.stop()}}),e)})))()},reboot_guest_click:function(t){var e=this;this.$confirm("重启当前虚拟机, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){ps({guestId:t.guestId}).then((function(t){0===t.code?e.update_guest_info(t.data):e.$notify.error({title:"错误",message:"重启虚拟机失败:".concat(t.message)})}))}))["catch"]((function(){}))},detach_guest_cd_room_click:function(t){var e=this;fs({guestId:t.guestId}).then((function(t){0===t.code?(e.update_guest_info(t.data),e.stop_dialog_visiable=!1):e.$notify.error({title:"错误",message:"卸载虚拟机光驱失败:".concat(t.message)})}))},menu_command_click:function(t){switch(t.command){case"info":this.show_guest_info_click(t.guest);break;case"start":this.show_start_guest_click(t.guest);break;case"reboot":this.reboot_guest_click(t.guest);break;case"stop":this.show_stop_guest_click(t.guest);break;case"detach_cd":this.detach_guest_cd_room_click(t.guest);break;case"attach_cd":this.show_attach_cd_room_click(t.guest);break;case"vnc":this.vnc_click(t.guest);break;case"destroy":this.destroy_guest(t.guest);break}},show_guest_info_click:function(t){var e=this;return(0,x.Z)((0,I.Z)().mark((function o(){return(0,I.Z)().wrap((function(o){while(1)switch(o.prev=o.next){case 0:e.$refs.GuestInfoComponentRef.init(t),e.show_type=1;case 2:case"end":return o.stop()}}),o)})))()},show_start_guest_click:function(t){var e=this;return(0,x.Z)((0,I.Z)().mark((function o(){return(0,I.Z)().wrap((function(o){while(1)switch(o.prev=o.next){case 0:e.$refs.StartGuestComponentRef.init(t);case 1:case"end":return o.stop()}}),o)})))()},show_stop_guest_click:function(t){this.$refs.StopGuestComponentRef.init(t)},show_attach_cd_room_click:function(t){this.$refs.AttachCdRoomComponentRef.init(t)},vnc_click:function(t){var e=this.$router.resolve({path:"/Vnc",query:{id:t.guestId,description:t.description}}),o=e.href;window.open(o,"_blank")},destroy_guest:function(t){var e=this;this.$confirm("删除当前虚拟机, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){rs({guestId:t.guestId}).then((function(o){if(0===o.code){var s=e.guests.findIndex((function(e){return e.guestId===t.guestId}));s>=0&&e.guests.splice(s,1),e.show_type=0}else e.$notify.error({title:"错误",message:"删除虚拟机失败:".concat(o.message)})}))}))["catch"]((function(){}))},batch_start_guest_click:function(){var t=this;this.$confirm("启动所选虚拟机, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var e=t.select_guests.map((function(t){return t.guestId})).join(",");us({guestIds:e}).then((function(e){0===e.code?e.data.filter((function(e){t.update_guest_info(e)})):t.$notify.error({title:"错误",message:"批量启动虚拟机失败:".concat(e.message)})}))}))["catch"]((function(){}))},batch_stop_guest_click:function(){var t=this;this.$confirm("停止所选虚拟机, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var e=t.select_guests.map((function(t){return t.guestId})).join(",");_s({guestIds:e}).then((function(e){0===e.code?e.data.filter((function(e){t.update_guest_info(e)})):t.$notify.error({title:"错误",message:"批量停止虚拟机失败:".concat(e.message)})}))}))["catch"]((function(){}))}}},ze=Ze;var qe=(0,u.Z)(ze,be,ke,!1,null,"6c5c4a45",null);const Be=qe.exports;var Ne=function(){var t=this,e=t._self._c;return e("div",{staticClass:"main"},[e("div",{attrs:{id:"top_bar"}},[e("div",{attrs:{id:"status"}},[t._v(t._s(t.status))]),e("div",{attrs:{id:"sendCtrlAltDelButton"},on:{onclick:t.on_send_ctrl_alt_del}},[t._v("发送 Ctrl+Alt+Del")])]),e("div",{attrs:{id:"screen"}})])},Pe=[],Fe=o(35417);const Ve={name:"VncView",inject:["check_full_screen"],data:function(){return{id:0,description:"",rfb:null,url:"",status:"连接中..."}},mounted:function(){var t;this.check_full_screen(!0),this.id=this.$route.query.id,this.description=this.$route.query.description,t="https:"===window.location.protocol?"wss":"ws",this.status="正在连接[".concat(this.description,"]..."),this.url="".concat(t,"://").concat(window.location.host,"/api/vnc/").concat(this.id),this.connect()},beforeDestroy:function(){this.check_full_screen(!1)},methods:{connect:function(){var t=this;ts({guestId:this.id}).then((function(e){0===e.code&&(t.rfb=new Fe.Z(document.getElementById("screen"),t.url,{credentials:{password:e.data}}),t.rfb.addEventListener("connect",t.on_connect_success),t.rfb.addEventListener("disconnect",t.on_disconnect),t.rfb.addEventListener("credentialsrequired",t.on_required_password),t.rfb.scaleViewport=!1,t.rfb.resizeSession=!1)}))},on_connect_success:function(){this.status="连接成功[".concat(this.description,"]")},on_disconnect:function(t){this.status="远程连接已断开[".concat(this.description,"]"),t.detail.clean&&(this.status="正在重新连接[".concat(this.description,"]..."),this.connect())},on_required_password:function(){var t=this;ts({guestId:this.id}).then((function(e){0===e.code&&e.data&&t.rfb.sendCredentials({password:e.data})}))},on_send_ctrl_alt_del:function(){this.rfb.sendCtrlAltDel()}}},Ge=Ve;var Me=(0,u.Z)(Ge,Ne,Pe,!1,null,"01864a97",null);const Re=Me.exports;var De=function(){var t=this,e=t._self._c;return e("div",[e("el-container",[e("el-main",[e("el-card",{staticClass:"box-card"},[e("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[e("span",[t._v("系统汇总")])]),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:4}},[e("div",[e("el-statistic",{attrs:{"group-separator":",",value:this.networks.length,title:"网络数量"}})],1)]),e("el-col",{attrs:{span:4}},[e("div",[e("el-statistic",{attrs:{"group-separator":",",value:this.storages.length,title:"存储池数量"}})],1)]),e("el-col",{attrs:{span:4}},[e("div",[e("el-statistic",{attrs:{"group-separator":",",value:this.hosts.length,title:"主机数量"}})],1)]),e("el-col",{attrs:{span:4}},[e("div",[e("el-statistic",{attrs:{"group-separator":",",value:this.guests.length,title:"虚拟机数量"}},[e("template",{slot:"formatter"},[t._v(t._s(t.get_runing_guest_number())+" /"+t._s(this.guests.length))])],2)],1)]),e("el-col",{attrs:{span:4}},[e("div",[e("el-statistic",{attrs:{"group-separator":",",value:this.volumes.length,title:"磁盘数量"}})],1)])],1),e("el-divider"),e("el-card",[e("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[e("span",[t._v("主机信息")])]),e("div",{staticClass:"component"},[e("div",[e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"已使用:"+t.get_allocat_cpu()+"核 / 总共:"+t.get_total_cpu()+"核",placement:"top"}},[e("el-progress",{attrs:{format:t.get_cpu_progress_title,type:"circle",percentage:t.totalCpuPercentage,color:"#67C23A"}})],1)],1),e("div",[e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"已使用:"+t.get_memory_desplay(t.get_allocat_memory())+" / 总共:"+t.get_memory_desplay(t.get_total_memory()),placement:"top"}},[e("el-progress",{attrs:{format:t.get_memory_progress_title,type:"circle",percentage:t.totalMemoryePercentage,color:"#67C23A"}})],1)],1),e("div",[e("el-table",{attrs:{data:t.hosts}},[e("el-table-column",{attrs:{label:"名称",prop:"displayName"}}),e("el-table-column",{attrs:{label:"主机IP",prop:"hostIp",width:"200"}}),e("el-table-column",{attrs:{label:"CPU",prop:"hostIp","min-width":"150"},scopedSlots:t._u([{key:"default",fn:function(t){return[e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"已使用:"+t.row.allocationCpu+"核 / 总共:"+t.row.totalCpu+"核",placement:"top"}},[e("el-progress",{attrs:{color:"#67C23A",percentage:t.row.totalCpu<=0?0:Math.floor(100*t.row.allocationCpu/t.row.totalCpu)}})],1)]}}])}),e("el-table-column",{attrs:{label:"内存",prop:"hostIp","min-width":"150"},scopedSlots:t._u([{key:"default",fn:function(o){return[e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"已使用:"+t.get_memory_desplay(o.row.allocationMemory)+" / 总共:"+t.get_memory_desplay(o.row.totalMemory),placement:"top"}},[e("el-progress",{attrs:{color:"#67C23A",percentage:o.row.totalMemory<=0?0:Math.floor(100*o.row.allocationMemory/o.row.totalMemory)}})],1)]}}])}),e("el-table-column")],1)],1)])]),e("el-divider"),e("el-card",[e("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[e("span",[t._v("存储池")])]),e("div",{staticClass:"storage_component"},[e("div",[e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"已用:"+t.get_storage_desplay(t.get_allocat_storage())+" / 总共:"+t.get_storage_desplay(t.get_total_capacity()),placement:"top"}},[e("el-progress",{attrs:{type:"circle",format:t.get_storage_progress_title,percentage:t.totalStoragePercentage,color:"#67C23A"}})],1)],1),e("div",[e("el-table",{attrs:{data:t.storages}},[e("el-table-column",{attrs:{label:"名称",prop:"description",width:"120"}}),e("el-table-column",{attrs:{label:"类型",prop:"type",width:"120"}}),e("el-table-column",{attrs:{label:"容量",prop:"capacity",width:"180"},scopedSlots:t._u([{key:"default",fn:function(o){return[e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"已用:"+t.get_storage_desplay(o.row.allocation)+" / 总共:"+t.get_storage_desplay(o.row.capacity),placement:"top"}},[e("el-progress",{attrs:{color:"#67C23A",percentage:o.row.capacity<=0?0:Math.floor(100*o.row.allocation/o.row.capacity)}})],1)]}}])}),e("el-table-column")],1)],1)])])],1)],1)],1)],1)},Ue=[];const Oe={name:"guestView",components:{},data:function(){return{hosts:[],networks:[],storages:[],volumes:[],guests:[],totalStoragePercentage:0,totalCpuPercentage:0,totalMemoryePercentage:0}},mounted:function(){this.init_data()},methods:{init_data:function(){var t=this;wo().then((function(e){0===e.code&&(t.hosts=e.data,t.totalCpuPercentage=t.get_total_cpu()<=0?0:Math.floor(100*t.get_allocat_cpu()/t.get_total_cpu()),t.totalMemoryePercentage=t.get_total_memory()<=0?0:Math.floor(100*t.get_allocat_memory()/t.get_total_memory()))})),uo().then((function(e){0===e.code&&(t.networks=e.data)})),Io().then((function(e){0===e.code&&(t.storages=e.data)})),Ro().then((function(e){0===e.code&&(t.volumes=e.data)})),ss().then((function(e){0===e.code&&(t.guests=e.data)})),Io().then((function(e){0===e.code&&(t.storages=e.data,t.totalStoragePercentage=t.get_total_capacity()<=0?0:parseInt(100*t.get_allocat_storage()/t.get_total_capacity()))}))},get_runing_guest_number:function(){return this.guests.filter((function(t){return 2===t.status})).length},get_storage_desplay:function(t){return t>1099511627776?(t/1099511627776).toFixed(2)+" TB":t>1073741824?(t/1073741824).toFixed(2)+" GB":t>1048576?(t/1048576).toFixed(2)+" MB":t>1024?(t/1024).toFixed(2)+"  KB":t+"  bytes"},get_memory_desplay:function(t){return t>1048576?(t/1048576).toFixed(2)+" GB":t>1024?(t/1024).toFixed(2)+"  MB":void 0},get_total_memory:function(){var t=0;return this.hosts.forEach((function(e){return t+=e.totalMemory})),t},get_allocat_memory:function(){var t=0;return this.hosts.forEach((function(e){return t+=e.allocationMemory})),t},get_total_cpu:function(){var t=0;return this.hosts.forEach((function(e){return t+=e.totalCpu})),t},get_allocat_cpu:function(){var t=0;return this.hosts.forEach((function(e){return t+=e.allocationCpu})),t},locat_cpu:function(){var t=0;return this.hosts.forEach((function(e){return t+=e.allocationCpu})),t},get_total_capacity:function(){var t=0;return this.storages.forEach((function(e){return t+=e.capacity})),t},get_allocat_storage:function(){var t=0;return this.storages.forEach((function(e){return t+=e.allocation})),t},get_cpu_progress_title:function(t){return"总内核:"+t+"%"},get_memory_progress_title:function(t){return"总内存:"+t+"%"},get_storage_progress_title:function(t){return"总存储:"+t+"%"}}},Ee=Oe;var Le=(0,u.Z)(Ee,De,Ue,!1,null,"52652666",null);const Ae=Le.exports;var He=function(){var t=this,e=t._self._c;return e("div",[e("el-container",[e("el-main",[e("el-card",{directives:[{name:"show",rawName:"v-show",value:0===this.show_type,expression:"this.show_type === 0"}],staticClass:"box-card"},[e("el-row",{staticClass:"clearfix",staticStyle:{height:"20px"},attrs:{slot:"header"},slot:"header"},[e("el-button",{staticStyle:{float:"left",padding:"3px 0"},attrs:{type:"text"},on:{click:t.show_create_user_click}},[t._v("注册用户")])],1),e("el-row",[e("el-table",{staticStyle:{width:"100%"},attrs:{"v-loading":t.data_loading,data:t.users}},[e("el-table-column",{attrs:{label:"ID",prop:"userId",width:"80"}}),e("el-table-column",{attrs:{label:"用户名",prop:"loginName",width:"200"}}),e("el-table-column",{attrs:{label:"状态",prop:"state",width:"180"},scopedSlots:t._u([{key:"default",fn:function(o){return[e("el-tag",{attrs:{type:0===o.row.state?"success":"danger"}},[t._v(t._s(0===o.row.state?"启用":"禁用"))])]}}])}),e("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(o){return[e("el-button",{attrs:{type:"",size:"mini"},on:{click:function(e){return t.show_reset_password_click(o.row)}}},[t._v("重置密码")]),1===o.row.state?e("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(e){return t.update_user_state_click(o.row,0)}}},[t._v("启用")]):t._e(),0===o.row.state?e("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){return t.update_user_state_click(o.row,1)}}},[t._v("禁用")]):t._e(),e("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){return t.destroy_user_click(o.row)}}},[t._v("删除")])]}}])})],1)],1)],1),e("el-card",{directives:[{name:"show",rawName:"v-show",value:1===this.show_type,expression:"this.show_type === 1"}],staticClass:"box-card"},[e("el-row",{attrs:{slot:"header"},slot:"header"},[e("el-page-header",{staticStyle:{color:"#409eff"},attrs:{content:"注册用户"},on:{back:function(e){return t.show_user_list()}}})],1),e("el-row",[e("el-form",{ref:"createForm",staticClass:"demo-ruleForm",attrs:{model:t.create_user,"label-width":"100px"}},[e("el-form-item",{attrs:{label:"登录名",prop:"loginName"}},[e("el-input",{model:{value:t.create_user.loginName,callback:function(e){t.$set(t.create_user,"loginName",e)},expression:"create_user.loginName"}})],1),e("el-form-item",{attrs:{label:"密码",prop:"password"}},[e("el-input",{attrs:{"show-password":""},model:{value:t.create_user.password,callback:function(e){t.$set(t.create_user,"password",e)},expression:"create_user.password"}})],1),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:t.on_create_user_click}},[t._v("注册")]),e("el-button",{on:{click:t.show_user_list}},[t._v("取消")])],1)],1)],1)],1),e("el-dialog",{attrs:{title:"重置密码",visible:t.reset_passwor_dialog_visiable,width:"300px"},on:{"update:visible":function(e){t.reset_passwor_dialog_visiable=e}}},[e("el-form",{ref:"resetPasswordForm",attrs:{model:t.reset_password_user,"label-width":"60px"}},[e("el-form-item",{attrs:{label:"密码"}},[e("el-input",{attrs:{placeholder:"请输入密码","show-password":""},model:{value:t.reset_password_user.password,callback:function(e){t.$set(t.reset_password_user,"password",e)},expression:"reset_password_user.password"}})],1)],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.reset_passwor_dialog_visiable=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.on_reset_password_click}},[t._v("确 定")])],1)],1)],1)],1)],1)},je=[];const Ke={name:"userView",components:{},data:function(){return{data_loading:!1,current_loading:!1,reset_passwor_dialog_visiable:!1,show_type:0,create_user:{loginName:"",password:""},reset_password_user:{userId:0,password:""},users:[]}},mounted:function(){this.init_view(),this.show_type=0},methods:{init_view:function(){var t=this;return(0,x.Z)((0,I.Z)().mark((function e(){return(0,I.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.data_loading=!0,e.next=3,Is().then((function(e){0==e.code&&(t.users=e.data)}))["finally"]((function(){t.data_loading=!1}));case 3:case"end":return e.stop()}}),e)})))()},show_user_list:function(){this.show_type=0},show_create_user_click:function(){this.$refs["createForm"]&&this.$refs["createForm"].resetFields(),this.show_type=1},show_reset_password_click:function(t){this.$refs["resetPasswordForm"]&&this.$refs["resetPasswordForm"].resetFields(),this.reset_password_user.userId=t.userId,this.reset_password_user.password="",this.reset_passwor_dialog_visiable=!0},update_user_info:function(t){var e=this.users.findIndex((function(e){return e.userId===t.userId}));e>=0?this.$set(this.users,e,t):this.users.push(t),this.show_user&&this.show_user.userId===t.userId&&(this.show_user=t)},on_create_user_click:function(){var t=this;xs(this.create_user).then((function(e){0===e.code?(t.update_user_info(e.data),t.show_type=0):t.$notify.error({title:"错误",message:"注册用户失败:".concat(e.message)})}))},on_reset_password_click:function(){var t=this;this.$confirm("重置密码, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){$s(t.reset_password_user).then((function(e){0===e.code?(t.update_user_info(e.data),t.reset_passwor_dialog_visiable=!1):t.$notify.error({title:"错误",message:"重置密码失败:".concat(e.message)})}))}))["catch"]((function(){}))},update_user_state_click:function(t,e){var o=this,s=0===e?"启用用户":"禁用用户";this.$confirm("".concat(s,", 是否继续?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Ts({userId:t.userId,state:e}).then((function(t){0===t.code?o.update_user_info(t.data):o.$notify.error({title:"错误",message:"".concat(s,"失败:").concat(t.message)})}))}))["catch"]((function(){}))},destroy_user_click:function(t){var e=this;this.$confirm("删除用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Cs({userId:t.userId}).then((function(o){if(0===o.code){var s=e.users.findIndex((function(e){return e.userId===t.userId}));s>=0&&e.users.splice(s,1)}else e.$notify.error({title:"错误",message:"删除用户失败:".concat(o.message)})}))}))["catch"]((function(){}))}}},Xe=Ke;var Je=(0,u.Z)(Xe,He,je,!1,null,"3724222a",null);const Qe=Je.exports;var We=function(){var t=this,e=t._self._c;return e("div",{staticClass:"login-container",attrs:{id:"main"}},["Login"!==t.show_type||this.oauth.enalbe?t._e():e("el-form",{ref:"ruleForm2",staticClass:"demo-ruleForm login-page",attrs:{"label-position":"left","label-width":"0px","status-icon":""}},[e("h3",{staticClass:"title"},[t._v("KVM Cloud Login")]),e("el-form-item",{attrs:{prop:"username"}},[e("el-input",{attrs:{"auto-complete":"off",autofocus:"true",placeholder:"用户名","prefix-icon":"el-icon-s-custom",type:"text"},model:{value:t.loginData.loginName,callback:function(e){t.$set(t.loginData,"loginName",e)},expression:"loginData.loginName"}})],1),e("el-form-item",{attrs:{prop:"password"}},[e("el-input",{attrs:{"show-password":!0,"auto-complete":"off",placeholder:"密码","prefix-icon":"el-icon-lock",type:"password"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.login.apply(null,arguments)}},model:{value:t.loginData.password,callback:function(e){t.$set(t.loginData,"password",e)},expression:"loginData.password"}})],1),e("el-form-item",{staticStyle:{width:"100%"}},[e("el-button",{staticStyle:{width:"100%"},attrs:{disabled:""==t.loginData.loginName||""==t.loginData.password,loading:t.loading,type:"primary"},on:{click:t.login}},[t._v("登录")])],1)],1),"Loading"===t.show_type?e("el-form",{staticClass:"login-page",attrs:{"label-position":"left","label-width":"0px","status-icon":""}},[e("div",{staticClass:"title"},[t._v(t._s(this.oauth.title))]),e("div",{directives:[{name:"loading",rawName:"v-loading",value:!0,expression:"true"}],staticStyle:{height:"80px","font-size":"30px","margin-bottom":"10px"},attrs:{"element-loading-spinner":"el-icon-loading","element-loading-text":"正在登录,请稍后..."}})]):t._e(),"Error"===t.show_type?e("el-form",{staticClass:"login-page",attrs:{"label-position":"left","label-width":"0px","status-icon":""}},[e("div",{staticClass:"title"},[t._v(t._s(this.oauth.title))]),e("div",[e("strong",{staticStyle:{color:"red"}},[t._v(t._s(this.errorMessage))])]),e("div",{staticClass:"register"},[e("el-link",{attrs:{type:"primary"},on:{click:function(e){return t.go_login()}}},[t._v("重新登录")])],1)]):t._e()],1)},Ye=[];const to={name:"loginView",inject:["check_full_screen"],data:function(){return{loginData:{loginName:"",password:""},oauth:{enable:!1,title:" Oauth2 登录"},show_type:"",errorMessage:"",loading:!1}},mounted:function(){var t=this;this.check_full_screen(!0),qs().then((function(e){if(0===e.code)if(e.data.oauth&&(t.oauth.title=e.data.oauth.title,t.oauth.enable=e.data.oauth.enable),t.oauth.enable){var o=t.$route.query.code;o&&""!==o?bs({code:o}).then((function(e){0!==e.code?(t.errorMessage="登录失败,服务器返回如下:\r\n".concat(e.message),t.show_type="Error"):(localStorage.setItem("X-Token",e.data.token),t.$router.push({path:"/"}))})):t.go_login()}else t.show_type="Login";else t.show_type="Login"}))},beforeDestroy:function(){this.check_full_screen(!1)},methods:{login:function(){var t=this;this.loading=!0,console.log(this.loginData.loginName),Zs({loginName:this.loginData.loginName}).then((function(e){if(0===e.code){var o=window.sha256_digest(window.sha256_digest(t.loginData.password+":"+e.data.signature)+":"+e.data.nonce);ks({loginName:t.loginData.loginName,password:o,nonce:e.data.nonce}).then((function(e){0===e.code?(localStorage.setItem("X-Token",e.data.token),t.$router.push({path:"/"})):t.$notify.error({title:"错误",duration:3e3,message:"登录失败:".concat(e.message)})}))["finally"]((function(){t.loading=!1}))}else t.$notify.error({title:"错误",duration:3e3,message:"登录失败:".concat(e.message)})}))["finally"]((function(){t.loading=!1}))},go_login:function(){window.location.href="/login"},show_login:function(){this.show_type="Login"}}},eo=to;var oo=(0,u.Z)(eo,We,Ye,!1,null,"6542b460",null);const so=oo.exports;s["default"].use(y.ZP);var ao=[{path:"/",name:"Home",component:Ae},{path:"/Vnc",name:"Vnc",component:Re},{path:"/Guest",name:"Guest",component:Be},{path:"/Network",name:"Network",component:Mt},{path:"/Host",name:"Host",component:Lt},{path:"/Storage",name:"Storage",component:Jt},{path:"/Template",name:"Template",component:oe},{path:"/Snapshot",name:"Snapshot",component:le},{path:"/Volume",name:"Volume",component:he},{path:"/Scheme",name:"Scheme",component:ye},{path:"/User",name:"User",component:Qe},{path:"/Login",name:"Login",component:so}],no=new y.ZP({routes:ao});const ro=no;var io=o(67986),lo=function(){function t(){(0,m.Z)(this,t),this.baseUrl=""}return(0,f.Z)(t,[{key:"getInsideConfig",value:function(){var t={baseURL:io.BASEURL,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8","X-Token":localStorage.getItem("X-Token")}};return t}},{key:"destroy",value:function(t){delete this.queue[t]}},{key:"interceptors",value:function(t,e){var o=this;t.interceptors.request.use((function(t){return"get"!==t.method.toLowerCase()?t.data=v().stringify(t.data):t.data=!0,t}),(function(t){return Promise.reject(t)})),t.interceptors.response.use((function(t){var e=t.data;if(401!==e.code)return t.data;ro.push({path:"/login"})}),(function(t){o.destroy(e);var s=t.response;if(s){var a=s.status,n=null;switch(a){case 400:n="请求参数错误";break;case 401:n="未授权或token过期，请登录";break;case 413:n="资源大小超过限制";break;case 403:n="跨域访问已被拒绝";break;case 404:n="请求地址出错: ".concat(s.config.url);break;case 408:n="请求超时";break;case 405:n="请求方法不正确";break;case 500:n="服务器内部错误";break;case 501:n="服务器未实现";break;case 502:n="网关错误";break;case 503:n="该服务不可用";break;case 504:n="网关超时";break;case 505:n="HTTP版本不受支持";break;default:n="未知错误status:".concat(a)}return console.log(n),Promise.reject(t)}return Promise.reject(t)}))}},{key:"request",value:function(t){var e=w.Z.create(),o=Object.assign({},t,this.getInsideConfig());return this.interceptors(e,o.url),e(o)}}]),t}();const co=new lo;var uo=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"/api/network/all",params:t})},_o=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"/api/network/info",params:t})},po=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"api/network/create",data:t,method:"PUT"})},ho=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"api/network/maintenance",data:t,method:"POST"})},mo=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"/api/network/register",data:t,method:"POST"})},fo=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"api/network/destroy",data:t,method:"DELETE"})},wo=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"/api/host/all",params:t})},go=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"/api/host/info",params:t})},vo=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"api/host/create",data:t,method:"PUT"})},yo=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"api/host/maintenance",data:t,method:"POST"})},bo=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"/api/host/register",data:t,method:"POST"})},ko=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"api/host/destroy",data:t,method:"DELETE"})},Io=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"/api/storage/all",params:t})},xo=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"/api/storage/info",params:t})},To=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"api/storage/create",data:t,method:"PUT"})},$o=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"api/storage/maintenance",data:t,method:"POST"})},So=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"/api/storage/register",data:t,method:"POST"})},Co=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"api/storage/destroy",data:t,method:"DELETE"})},Zo=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"/api/template/all",params:t})},zo=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"/api/template/info",params:t})},qo=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"api/template/create",data:t,method:"PUT"})},Bo=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"api/template/volume/create",data:t,method:"PUT"})},No=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"api/template/download",data:t,method:"POST"})},Po=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"api/template/destroy",data:t,method:"DELETE"})},Fo=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"/api/snapshot/all",params:t})},Vo=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"/api/snapshot/info",params:t})},Go=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"api/snapshot/create",data:t,method:"PUT"})},Mo=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"api/snapshot/destroy",data:t,method:"DELETE"})},Ro=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"/api/volume/all",params:t})},Do=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"/api/volume/not/attach/all",params:t})},Uo=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"/api/volume/info",params:t})},Oo=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"api/volume/create",data:t,method:"PUT"})},Eo=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"api/volume/migrate",data:t,method:"PUT"})},Lo=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"api/volume/resize",data:t,method:"POST"})},Ao=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"api/volume/clone",data:t,method:"PUT"})},Ho=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"api/volume/destroy",data:t,method:"DELETE"})},jo=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"api/volume/destroy/batch",data:t,method:"DELETE"})},Ko=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"/api/scheme/all",params:t})},Xo=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"/api/scheme/info",params:t})},Jo=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"api/scheme/create",data:t,method:"PUT"})},Qo=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"api/scheme/modify",data:t,method:"POST"})},Wo=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"api/scheme/destroy",data:t,method:"DELETE"})},Yo=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"/api/guest/info",params:t})},ts=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"/api/guest/vnc/password",params:t})},es=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"/api/guest/volume",params:t})},os=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"/api/guest/network",params:t})},ss=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"/api/guest/all",params:t})},as=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"/api/guest/system",params:t})},ns=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"/api/guest/user",params:t})},rs=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"api/guest/destroy",data:t,method:"DELETE"})},is=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"api/guest/create",data:t,method:"PUT"})},ls=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"api/guest/reinstall",data:t,method:"POST"})},cs=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"api/guest/start",data:t,method:"POST"})},us=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"api/guest/start/batch",data:t,method:"POST"})},ds=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"api/guest/shutdown",data:t,method:"POST"})},_s=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"api/guest/shutdown/batch",data:t,method:"POST"})},ps=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"api/guest/reboot",data:t,method:"POST"})},hs=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"api/guest/modify",data:t,method:"POST"})},ms=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"api/guest/cd/attach",data:t,method:"POST"})},fs=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"api/guest/cd/detach",data:t,method:"POST"})},ws=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"api/guest/disk/attach",data:t,method:"POST"})},gs=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"api/guest/disk/detach",data:t,method:"POST"})},vs=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"api/guest/network/attach",data:t,method:"POST"})},ys=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"api/guest/network/detach",data:t,method:"POST"})},bs=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"api/user/oauth2/login",data:t,method:"POST"})},ks=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"/api/user/login",data:t,method:"POST"})},Is=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"api/user/list",data:t,method:"GET"})},xs=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"api/user/register",data:t,method:"PUT"})},Ts=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"api/user/state/update",data:t,method:"POST"})},$s=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"api/user/password/reset",data:t,method:"POST"})},Ss=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"api/user/password/modify",data:t,method:"POST"})},Cs=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"api/user/destroy",data:t,method:"DELETE"})},Zs=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"api/user/login/signature",params:t})},zs=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"api/user/signature",params:t})},qs=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return co.request({url:"api/config",data:t,method:"GET"})};const Bs={data:function(){return{update_password_dialog_visible:!1,update_password:{oldPassword:"",newPassword:"",confirmPassword:"",nonce:""}}},methods:{handleSelect:function(t){var e=this;switch(t){case"password":this.update_password.oldPassword="",this.update_password.newPassword="",this.update_password.confirmPassword="",this.update_password.nonce="",this.update_password_dialog_visible=!0;break;case"quit":this.$confirm("退出登录, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){localStorage.removeItem("X-Token"),e.$router.push({path:"/Login"})}))["catch"]((function(){}));break}},update_user_password_click:function(){var t=this;this.update_password.newPassword==this.update_password.confirmPassword?zs().then((function(e){if(0===e.code){var o=window.sha256_digest(window.sha256_digest(t.update_password.oldPassword+":"+e.data.signature)+":"+e.data.nonce),s=e.data.nonce,a=window.sha256_digest(t.newPassword+":"+e.data.signature),n={oldPassword:o,newPassword:a,nonce:s};Ss(n).then((function(e){0!==e.code?t.$notify.error({title:"错误",message:"修改密码失败:".concat(e.message)}):t.update_password_dialog_visible=!1}))}else t.$notify.error({title:"错误",message:"修改密码失败:".concat(e.message)})})):this.$notify.error({title:"错误",duration:3e3,message:"新密码与旧密码不一致"})}}},Ns=Bs;var Ps=(0,u.Z)(Ns,p,h,!1,null,"08998a84",null);const Fs=Ps.exports,Vs={components:{NavViewVue:_,HeadViewVue:Fs},provide:function(){var t=this;return{check_full_screen:function(e){t.isFullScreen=e}}},data:function(){return{isFullScreen:!1}}},Gs=Vs;var Ms=(0,u.Z)(Gs,a,n,!1,null,null,null);const Rs=Ms.exports;var Ds=o(90408);s["default"].use(Ds.ZP);const Us=new Ds.ZP.Store({state:{},getters:{},mutations:{},actions:{},modules:{}});var Os=o(85114),Es=o.n(Os);s["default"].use(Es()),s["default"].config.productionTip=!1,s["default"].prototype.$websocket=void 0,new s["default"]({router:ro,store:Us,render:function(t){return t(Rs)}}).$mount("#app")},66949:(t,e,o)=>{"use strict";t.exports=o.p+"img/logo.047618b0.png"},24654:()=>{}},e={};function o(s){var a=e[s];if(void 0!==a)return a.exports;var n=e[s]={id:s,loaded:!1,exports:{}};return t[s].call(n.exports,n,n.exports,o),n.loaded=!0,n.exports}o.m=t,(()=>{o.amdO={}})(),(()=>{var t=[];o.O=(e,s,a,n)=>{if(!s){var r=1/0;for(u=0;u<t.length;u++){for(var[s,a,n]=t[u],i=!0,l=0;l<s.length;l++)(!1&n||r>=n)&&Object.keys(o.O).every((t=>o.O[t](s[l])))?s.splice(l--,1):(i=!1,n<r&&(r=n));if(i){t.splice(u--,1);var c=a();void 0!==c&&(e=c)}}return e}n=n||0;for(var u=t.length;u>0&&t[u-1][2]>n;u--)t[u]=t[u-1];t[u]=[s,a,n]}})(),(()=>{o.n=t=>{var e=t&&t.__esModule?()=>t["default"]:()=>t;return o.d(e,{a:e}),e}})(),(()=>{o.d=(t,e)=>{for(var s in e)o.o(e,s)&&!o.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})}})(),(()=>{o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()})(),(()=>{o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e)})(),(()=>{o.r=t=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}})(),(()=>{o.nmd=t=>(t.paths=[],t.children||(t.children=[]),t)})(),(()=>{o.p="/"})(),(()=>{var t={143:0};o.O.j=e=>0===t[e];var e=(e,s)=>{var a,n,[r,i,l]=s,c=0;if(r.some((e=>0!==t[e]))){for(a in i)o.o(i,a)&&(o.m[a]=i[a]);if(l)var u=l(o)}for(e&&e(s);c<r.length;c++)n=r[c],o.o(t,n)&&t[n]&&t[n][0](),t[n]=0;return o.O(u)},s=self["webpackChunkcloud"]=self["webpackChunkcloud"]||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))})();var s=o.O(void 0,[998],(()=>o(82746)));s=o.O(s)})();