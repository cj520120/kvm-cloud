"use strict";(self["webpackChunkkvm_cloud_web"]=self["webpackChunkkvm_cloud_web"]||[]).push([[756],{112:function(e,a,t){t.d(a,{$e:function(){return r},Er:function(){return u},G8:function(){return n},T$:function(){return i},dz:function(){return o}});var l=t(3162);const o=(e={})=>(0,l.A)({url:"api/group/all",params:e}),n=(e={})=>(0,l.A)({url:"api/group/search",params:e}),u=(e={})=>(0,l.A)({url:"api/group/create",params:e,method:"put"}),r=(e={})=>(0,l.A)({url:"api/group/update",params:e,method:"post"}),i=(e={})=>(0,l.A)({url:"api/group/destroy",params:e,method:"delete"})},1644:function(e,a,t){t.r(a),t.d(a,{default:function(){return C}});var l=t(6845),o=(t(4974),t(8206),t(9464)),n=(t(2708),t(6390)),u=(t(8145),t(1177),t(5143)),r=(t(493),t(7836)),i=(t(3020),t(9622),t(7255)),c=(t(756),t(5567),t(6918)),d=t(1654),s=t(4673),p=t(112),b=t(2303),m=t(6555),g=t(7898),f=(t(7191),t(1421)),v=t(7445),k=t(8180);t(6447);const _={class:"dialog-footer"};var R={__name:"EditGroupDialog",emits:["on-create-group","on-update-group"],setup(e,{expose:a,emit:t}){const l=(0,d.KR)(!1),o=t,n=(0,d.Kh)({id:"",name:""}),b=(0,d.KR)(""),{t:m}=(0,v.s9)(),R=(0,d.KR)(null),y=(0,d.Kh)({name:[{required:!0,message:m("cj.tooltip.global.not_empty",{name:m("cj.label.basic.name")}),trigger:["blur","change"]},{min:1,max:32,message:m("cj.tooltip.global.length_error",{name:m("cj.label.basic.name")}),trigger:["blur","change"]}]});function h(){R.value.validate((e=>{if(e){let e=n.id?"on-update-group":"on-create-group",a=n.id?p.$e:p.Er,t=n.id?{groupId:n.id,groupName:n.name}:{groupName:n.name};a(t).then((a=>{0===a.code?(l.value=!1,o(e,a.data,!0),(0,f.z)(a)):(0,f.U)(a)}))}else(0,k.nk)({type:"error",message:m("cj.tooltip.global.has_error")})}))}return a({open:e=>{b.value=e.title,n.id=e.id,n.name=e.name,l.value=!0}}),(e,a)=>{const t=i.WK,o=u.xE,p=u.US,m=r.S2,f=g.kZ;return(0,c.uX)(),(0,c.Wv)(f,{modelValue:(0,d.R1)(l),"onUpdate:modelValue":a[2]||(a[2]=e=>(0,d.i9)(l)?l.value=e:null),title:(0,d.R1)(b),width:"400","close-on-click-modal":!1},{footer:(0,c.k6)((()=>[(0,c.Lk)("div",_,[(0,c.bF)(m,{onClick:a[1]||(a[1]=e=>l.value=!1)},{default:(0,c.k6)((()=>[(0,c.eW)((0,s.v_)(e.$t("cj.btn.basic.cancel")),1)])),_:1}),(0,c.bF)(m,{type:"primary",onClick:h},{default:(0,c.k6)((()=>[(0,c.eW)((0,s.v_)(e.$t("cj.btn.basic.confirm")),1)])),_:1})])])),default:(0,c.k6)((()=>[(0,c.bF)(p,{model:(0,d.R1)(n),"label-width":"auto",ref_key:"group_ref",ref:R,rules:(0,d.R1)(y)},{default:(0,c.k6)((()=>[(0,c.bF)(o,{label:e.$t("cj.label.basic.name"),prop:"name"},{default:(0,c.k6)((()=>[(0,c.bF)(t,{modelValue:(0,d.R1)(n).name,"onUpdate:modelValue":a[0]||(a[0]=e=>(0,d.R1)(n).name=e)},null,8,["modelValue"])])),_:1},8,["label"])])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])}}};const y=R;var h=y;function j(e,a,t,l){const o=(0,c.WQ)("websocket");(0,c.sV)((()=>{o.subscribe_notify(e,(e=>{if(9===e.type){let a=e.data;0==a.code?t(a.data):10000001==a.code&&l(e.id)}})),o.subscribe_connect_notify(e,(()=>{a()})),o.init(),a()})),(0,c.xo)((()=>{o.unsubscribe_notify(e),o.unsubscribe_connect_notify(e)}))}var $=t(7774),z=(t(5280),Object.assign({name:"Group"},{__name:"Group",setup(e){const a=(0,d.KR)(null),{t:t}=(0,v.s9)(),g=(0,d.KR)({keyword:"",no:1,size:10}),k=(0,d.KR)(!1),_=(0,d.KR)({data:[],total:0});function R(e){g.value.no=e,z()}function y(e){g.value.size=e,z()}function z(){k.value=!0,(0,p.G8)(g.value).then((e=>{const{list:a=[],total:t=0}=e.data||{};_.value={data:a,total:t}})).catch((()=>{_.value={data:[],total:0}})).finally((()=>{k.value=!1}))}function w(){const e={id:0,title:t("cj.dialog.group.create"),name:""};a.value.open(e)}function C(e,l){const o={id:l.groupId,title:t("cj.dialog.group.edit"),name:l.groupName};a.value.open(o)}function F(e,a=!1){let t=_.value.data.findIndex((a=>a.groupId===e.groupId));-1!==t?Object.assign(_.value.data[t],e):a&&(_.value.data.push(e),_.value.total++)}function W(e){let a=_.value.data.findIndex((a=>a.groupId===e));-1!==a&&(_.value.data.splice(a,1),_.value.total--)}function x(e,a){$.s.confirm(t("cj.dialog.group.deleteConfirm"),"Warning",{confirmButtonText:t("cj.btn.basic.confirm"),cancelButtonText:t("cj.btn.basic.cancel"),type:"warning"}).then((()=>{(0,p.T$)({groupId:a.groupId}).then((e=>{0===e.code?(W(a.groupId),(0,f.z)(e)):(0,f.U)(e)}))}))}return j("group_list",z,F,W),(e,t)=>{const p=i.WK,f=u.xE,v=r.S2,j=u.US,$=n.o8,W=n.Up,U=o.aQ,I=(0,c.gN)("Admin"),K=l.L;return(0,c.uX)(),(0,c.CE)("div",null,[(0,c.bF)(j,{model:(0,d.R1)(g),inline:"",size:"small"},{default:(0,c.k6)((()=>[(0,c.bF)(f,{label:e.$t("cj.label.basic.keyword")},{default:(0,c.k6)((()=>[(0,c.bF)(p,{modelValue:(0,d.R1)(g).keyword,"onUpdate:modelValue":t[0]||(t[0]=e=>(0,d.R1)(g).keyword=e),clearable:""},null,8,["modelValue"])])),_:1},8,["label"]),(0,c.bF)(f,null,{default:(0,c.k6)((()=>[(0,c.bF)(v,{type:"primary",onClick:z,icon:(0,d.R1)(b.Search),disabled:(0,d.R1)(k)},{default:(0,c.k6)((()=>[(0,c.eW)((0,s.v_)(e.$t("cj.btn.basic.search")),1)])),_:1},8,["icon","disabled"]),(0,c.bo)(((0,c.uX)(),(0,c.Wv)(v,{type:"primary",onClick:w,icon:(0,d.R1)(b.DocumentAdd)},{default:(0,c.k6)((()=>[(0,c.eW)((0,s.v_)(e.$t("cj.btn.basic.create")),1)])),_:1},8,["icon"])),[[I]])])),_:1})])),_:1},8,["model"]),(0,c.bo)(((0,c.uX)(),(0,c.Wv)(W,{data:(0,d.R1)(_).data,style:{width:"100%"},"table-layout":"auto",border:""},{default:(0,c.k6)((()=>[(0,c.bF)($,{prop:"groupId",label:e.$t("cj.label.basic.id")},null,8,["label"]),(0,c.bF)($,{prop:"groupName",label:e.$t("cj.label.basic.name")},null,8,["label"]),(0,c.bF)($,{prop:"createTime",label:e.$t("cj.label.basic.createTime")},{default:(0,c.k6)((e=>[(0,c.eW)((0,s.v_)((0,d.R1)(m.BU)(e.row.createTime)),1)])),_:1},8,["label"]),(0,c.bF)($,{label:e.$t("cj.label.basic.operation")},{default:(0,c.k6)((a=>[(0,c.bo)(((0,c.uX)(),(0,c.Wv)(v,{size:"small",type:"primary",onClick:e=>C(a.$index,a.row),icon:(0,d.R1)(b.Edit)},{default:(0,c.k6)((()=>[(0,c.eW)((0,s.v_)(e.$t("cj.btn.basic.edit")),1)])),_:2},1032,["onClick","icon"])),[[I]]),(0,c.bo)(((0,c.uX)(),(0,c.Wv)(v,{size:"small",type:"danger",onClick:e=>x(a.$index,a.row),icon:(0,d.R1)(b.Delete)},{default:(0,c.k6)((()=>[(0,c.eW)((0,s.v_)(e.$t("cj.btn.basic.delete")),1)])),_:2},1032,["onClick","icon"])),[[I]])])),_:1},8,["label"])])),_:1},8,["data"])),[[K,(0,d.R1)(k)]]),t[3]||(t[3]=(0,c.Lk)("br",null,null,-1)),(0,c.bF)(U,{size:"small",background:"",onCurrentChange:R,onSizeChange:y,"current-page":(0,d.R1)(g).no,"onUpdate:currentPage":t[1]||(t[1]=e=>(0,d.R1)(g).no=e),"page-sizes":[10,20,50,100,200],"page-size":(0,d.R1)(g).size,"onUpdate:pageSize":t[2]||(t[2]=e=>(0,d.R1)(g).size=e),layout:"sizes, prev, pager, next, jumper, total",total:(0,d.R1)(_).total},null,8,["current-page","page-size","total"]),(0,c.bF)(h,{ref_key:"editGroupDialogRef",ref:a,onOnCreateGroup:F,onOnUpdateGroup:F},null,512)])}}}));const w=z;var C=w}}]);