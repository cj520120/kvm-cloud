"use strict";(self["webpackChunkkvm_cloud_web"]=self["webpackChunkkvm_cloud_web"]||[]).push([[806],{8363:function(e,l,a){a.r(l),a.d(l,{default:function(){return X}});var u=a(6845),t=(a(4974),a(8206),a(9464)),r=(a(2708),a(6390)),s=(a(8145),a(7477)),o=(a(6788),a(1177),a(5143)),n=(a(493),a(7836)),d=(a(3020),a(9622),a(7255)),i=(a(756),a(5567),a(6918)),c=a(1654),b=a(4673),p=a(5104),m=a(2303),v=a(6555),g=a(7898),f=(a(7191),a(6622)),_=(a(4005),a(7233),a(1421)),k=a(7445),R=a(8180);a(6447);const y={class:"dialog-footer"};var j={__name:"CreateUserDialog",emits:["on-create-user"],setup(e,{expose:l,emit:a}){const u=(0,c.KR)(!1),t=a,r=(0,c.KR)({userName:"",userType:0,userStatus:0,loginName:"",password:""}),{t:s}=(0,k.s9)(),m=(0,c.KR)(null),v=(0,c.KR)({userName:[{required:!0,message:s("cj.tooltip.global.not_empty",{name:s("cj.label.user.userName")}),trigger:["blur","change"]},{min:1,max:32,message:s("cj.tooltip.global.length_error",{name:s("cj.label.user.userName")}),trigger:["blur","change"]}],loginName:[{required:!0,message:s("cj.tooltip.global.not_empty",{name:s("cj.label.user.loginName")}),trigger:["blur","change"]},{min:1,max:32,message:s("cj.tooltip.global.length_error",{name:s("cj.label.user.loginName")}),trigger:["blur","change"]}],password:[{required:!0,message:s("cj.tooltip.global.not_empty",{name:s("cj.label.user.password")}),trigger:["blur","change"]},{min:1,max:32,message:s("cj.tooltip.global.length_error",{name:s("cj.label.user.password")}),trigger:["blur","change"]}]}),j=(0,c.KR)([{value:0,label:"cj.enum.userStatus.active"},{value:1,label:"cj.enum.userStatus.inactive"}]),w=(0,c.KR)([{value:0,label:"cj.enum.userRole.super"},{value:100,label:"cj.enum.userRole.admin"},{value:200,label:"cj.enum.userRole.user"}]),F=(0,c.KR)("");function h(){m.value.validate((e=>{e?(0,p.a9)({userName:r.value.userName,loginName:r.value.loginName,password:r.value.password,userStatus:r.value.userStatus,userType:r.value.userType}).then((e=>{0===e.code?(u.value=!1,t("on-create-user",e.data,!0),(0,_.zo)(e)):(0,_.Ue)(e)})):(0,R.nk)({type:"error",message:s("cj.tooltip.global.has_error")})}))}return l({open:e=>{F.value=e.title,r.value.loginName="",r.value.password="",r.value.userStatus=0,r.value.userName="",r.value.userType=200,u.value=!0}}),(e,l)=>{const a=d.WK,t=o.xE,s=f.P9,p=f.AV,_=o.US,k=n.S2,R=g.kZ;return(0,i.uX)(),(0,i.Wv)(R,{modelValue:(0,c.R1)(u),"onUpdate:modelValue":l[6]||(l[6]=e=>(0,c.i9)(u)?u.value=e:null),title:(0,c.R1)(F),width:"400","close-on-click-modal":!1},{footer:(0,i.k6)((()=>[(0,i.Lk)("div",y,[(0,i.bF)(k,{onClick:l[5]||(l[5]=e=>u.value=!1)},{default:(0,i.k6)((()=>[(0,i.eW)((0,b.v_)(e.$t("cj.btn.basic.cancel")),1)])),_:1}),(0,i.bF)(k,{type:"primary",onClick:h},{default:(0,i.k6)((()=>[(0,i.eW)((0,b.v_)(e.$t("cj.btn.basic.confirm")),1)])),_:1})])])),default:(0,i.k6)((()=>[(0,i.bF)(_,{model:(0,c.R1)(r),"label-width":"auto",ref_key:"user_ref",ref:m,rules:(0,c.R1)(v)},{default:(0,i.k6)((()=>[(0,i.bF)(t,{label:e.$t("cj.label.user.userName"),prop:"userName"},{default:(0,i.k6)((()=>[(0,i.bF)(a,{modelValue:(0,c.R1)(r).userName,"onUpdate:modelValue":l[0]||(l[0]=e=>(0,c.R1)(r).userName=e)},null,8,["modelValue"])])),_:1},8,["label"]),(0,i.bF)(t,{label:e.$t("cj.label.user.loginName"),prop:"loginName"},{default:(0,i.k6)((()=>[(0,i.bF)(a,{modelValue:(0,c.R1)(r).loginName,"onUpdate:modelValue":l[1]||(l[1]=e=>(0,c.R1)(r).loginName=e)},null,8,["modelValue"])])),_:1},8,["label"]),(0,i.bF)(t,{label:e.$t("cj.label.user.password"),prop:"password"},{default:(0,i.k6)((()=>[(0,i.bF)(a,{modelValue:(0,c.R1)(r).password,"onUpdate:modelValue":l[2]||(l[2]=e=>(0,c.R1)(r).password=e),"show-password":!0,type:"password"},null,8,["modelValue"])])),_:1},8,["label"]),(0,i.bF)(t,{label:e.$t("cj.label.basic.status")},{default:(0,i.k6)((()=>[(0,i.bF)(p,{modelValue:(0,c.R1)(r).userStatus,"onUpdate:modelValue":l[3]||(l[3]=e=>(0,c.R1)(r).userStatus=e),style:{width:"240px"}},{default:(0,i.k6)((()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)((0,c.R1)(j),(l=>((0,i.uX)(),(0,i.Wv)(s,{key:l.value,label:e.$t(l.label),value:l.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1},8,["label"]),(0,i.bF)(t,{label:e.$t("cj.label.user.userType")},{default:(0,i.k6)((()=>[(0,i.bF)(p,{modelValue:(0,c.R1)(r).userType,"onUpdate:modelValue":l[4]||(l[4]=e=>(0,c.R1)(r).userType=e),style:{width:"240px"}},{default:(0,i.k6)((()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)((0,c.R1)(w),(l=>((0,i.uX)(),(0,i.Wv)(s,{key:l.value,label:e.$t(l.label),value:l.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1},8,["label"])])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])}}};const w=j;var F=w;const h={class:"dialog-footer"};var N={__name:"ResetUserPasswordDialog",emits:["on-update-user"],setup(e,{expose:l,emit:a}){const u=(0,c.KR)(!1),t=a,r=(0,c.Kh)({id:"",password:""}),{t:s}=(0,k.s9)(),m=(0,c.KR)(null),v=(0,c.KR)({password:[{required:!0,message:s("cj.tooltip.global.not_empty",{name:s("cj.label.user.password")}),trigger:["blur","change"]},{min:1,max:32,message:s("cj.tooltip.global.length_error",{name:s("cj.label.user.password")}),trigger:["blur","change"]}]}),f=(0,c.KR)("");function y(){m.value.validate((e=>{if(!e)return(0,R.nk)({type:"error",message:s("cj.tooltip.global.has_error")}),!1;{let e="on-update-user";(0,p.aH)({userId:r.id,password:r.password}).then((l=>{0===l.code?(u.value=!1,t(e,l.data,!0),(0,_.zo)(l)):(0,_.Ue)(l)}))}}))}return l({open:e=>{f.value=e.title,r.id=e.userId,r.password="",u.value=!0}}),(e,l)=>{const a=d.WK,t=o.xE,s=o.US,p=n.S2,_=g.kZ;return(0,i.uX)(),(0,i.Wv)(_,{modelValue:(0,c.R1)(u),"onUpdate:modelValue":l[2]||(l[2]=e=>(0,c.i9)(u)?u.value=e:null),title:(0,c.R1)(f),width:"400","close-on-click-modal":!1},{footer:(0,i.k6)((()=>[(0,i.Lk)("div",h,[(0,i.bF)(p,{onClick:l[1]||(l[1]=e=>u.value=!1)},{default:(0,i.k6)((()=>[(0,i.eW)((0,b.v_)(e.$t("cj.btn.basic.cancel")),1)])),_:1}),(0,i.bF)(p,{type:"primary",onClick:y},{default:(0,i.k6)((()=>[(0,i.eW)((0,b.v_)(e.$t("cj.btn.basic.confirm")),1)])),_:1})])])),default:(0,i.k6)((()=>[(0,i.bF)(s,{model:(0,c.R1)(r),"label-width":"auto",ref_key:"user_ref",ref:m,rules:(0,c.R1)(v)},{default:(0,i.k6)((()=>[(0,i.bF)(t,{label:e.$t("cj.label.user.password"),prop:"password"},{default:(0,i.k6)((()=>[(0,i.bF)(a,{modelValue:(0,c.R1)(r).password,"onUpdate:modelValue":l[0]||(l[0]=e=>(0,c.R1)(r).password=e),"show-password":!0,type:"password"},null,8,["modelValue"])])),_:1},8,["label"])])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])}}};const V=N;var U=V;const $={class:"dialog-footer"};var S={__name:"UpdateUserDialog",emits:["on-create-user","on-update-user"],setup(e,{expose:l,emit:a}){const u=(0,c.KR)(!1),t=a,r=(0,c.Kh)({id:"",userName:"",userType:void 0,userStatus:void 0}),s=(0,c.KR)(""),m=(0,c.KR)([{value:0,label:"cj.enum.userStatus.active"},{value:1,label:"cj.enum.userStatus.inactive"}]),v=(0,c.KR)([{value:0,label:"cj.enum.userRole.super"},{value:100,label:"cj.enum.userRole.admin"},{value:200,label:"cj.enum.userRole.user"}]),{t:y}=(0,k.s9)(),j=(0,c.KR)(null),w=(0,c.KR)({userName:[{required:!0,message:y("cj.tooltip.global.not_empty",{name:y("cj.label.user.userName")}),trigger:["blur","change"]},{min:1,max:32,message:y("cj.tooltip.global.length_error",{name:y("cj.label.user.userName")}),trigger:["blur","change"]}]});function F(){j.value.validate((e=>{if(e){let e="on-update-user";(0,p.xx)({userId:r.id,userStatus:r.userStatus,userName:r.userName,userType:r.userType}).then((l=>{0===l.code?(u.value=!1,t(e,l.data,!0),(0,_.zo)(l)):(0,_.Ue)(l)}))}else(0,R.nk)({type:"error",message:y("cj.tooltip.global.has_error")})}))}return l({open:e=>{s.value=e.title,r.id=e.userId,r.userStatus=e.userStatus,r.userName=e.userName,r.userType=e.userType,u.value=!0}}),(e,l)=>{const a=d.WK,t=o.xE,p=f.P9,_=f.AV,k=o.US,R=n.S2,y=g.kZ;return(0,i.uX)(),(0,i.Wv)(y,{modelValue:(0,c.R1)(u),"onUpdate:modelValue":l[4]||(l[4]=e=>(0,c.i9)(u)?u.value=e:null),title:(0,c.R1)(s),width:"400","close-on-click-modal":!1},{footer:(0,i.k6)((()=>[(0,i.Lk)("div",$,[(0,i.bF)(R,{onClick:l[3]||(l[3]=e=>u.value=!1)},{default:(0,i.k6)((()=>[(0,i.eW)((0,b.v_)(e.$t("cj.btn.basic.cancel")),1)])),_:1}),(0,i.bF)(R,{type:"primary",onClick:F},{default:(0,i.k6)((()=>[(0,i.eW)((0,b.v_)(e.$t("cj.btn.basic.confirm")),1)])),_:1})])])),default:(0,i.k6)((()=>[(0,i.bF)(k,{model:(0,c.R1)(r),"label-width":"auto",ref_key:"user_ref",ref:j,rules:(0,c.R1)(w)},{default:(0,i.k6)((()=>[(0,i.bF)(t,{label:e.$t("cj.label.user.userName"),prop:"userName"},{default:(0,i.k6)((()=>[(0,i.bF)(a,{modelValue:(0,c.R1)(r).userName,"onUpdate:modelValue":l[0]||(l[0]=e=>(0,c.R1)(r).userName=e)},null,8,["modelValue"])])),_:1},8,["label"]),(0,i.bF)(t,{label:e.$t("cj.label.basic.status"),prop:"userStatus"},{default:(0,i.k6)((()=>[(0,i.bF)(_,{modelValue:(0,c.R1)(r).userStatus,"onUpdate:modelValue":l[1]||(l[1]=e=>(0,c.R1)(r).userStatus=e),style:{width:"240px"}},{default:(0,i.k6)((()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)((0,c.R1)(m),(l=>((0,i.uX)(),(0,i.Wv)(p,{key:l.value,label:e.$t(l.label),value:l.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1},8,["label"]),(0,i.bF)(t,{label:e.$t("cj.label.user.userType"),prop:"userType"},{default:(0,i.k6)((()=>[(0,i.bF)(_,{modelValue:(0,c.R1)(r).userType,"onUpdate:modelValue":l[2]||(l[2]=e=>(0,c.R1)(r).userType=e),style:{width:"240px"}},{default:(0,i.k6)((()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)((0,c.R1)(v),(l=>((0,i.uX)(),(0,i.Wv)(p,{key:l.value,label:e.$t(l.label),value:l.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1},8,["label"])])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])}}};const W=S;var K=W;function T(e,l,a,u){const t=(0,i.WQ)("websocket");(0,i.sV)((()=>{t.subscribe_notify(e,(e=>{if(14===e.type){let l=e.data;0==l.code?a(l.data):9000004==l.code&&u(e.id)}})),t.subscribe_connect_notify(e,(()=>{l()})),t.init(),l()})),(0,i.xo)((()=>{t.unsubscribe_notify(e),t.unsubscribe_connect_notify(e)}))}var C=a(9758),x=a(7774),I=(a(5280),Object.assign({name:"User"},{__name:"User",setup(e){const l=(0,c.KR)(null),a=(0,c.KR)(null),g=(0,c.KR)(null),{t:f}=(0,k.s9)(),R=(0,c.KR)({keyword:"",no:1,size:10}),y=(0,c.KR)(!1),j=(0,c.KR)({data:[],total:0});async function w(){V()}function h(e){R.value.no=e,V()}function N(e){R.value.size=e,V()}function V(){y.value=!0,(0,p.EU)(R.value).then((e=>{const{list:l=[],total:a=0}=e.data||{};j.value={data:l,total:a}})).catch((()=>{j.value={data:[],total:0}})).finally((()=>{y.value=!1}))}function $(){const e={title:f("cj.dialog.user.register")};l.value.open(e)}function S(e,l){const u={userId:l.userId,title:f("cj.dialog.user.resetPassword")};a.value.open(u)}function W(e,l){const a={userId:l.userId,title:f("cj.dialog.user.updateUser"),userName:l.userName,userType:l.userType,userStatus:l.userStatus};g.value.open(a)}function I(e,l=!1){let a=j.value.data.findIndex((l=>l.userId===e.userId));-1!==a?Object.assign(j.value.data[a],e):l&&(j.value.data.push(e),j.value.total++)}function z(e){let l=j.value.data.findIndex((l=>l.userId===e));-1!==l&&(j.value.data.splice(l,1),j.value.total--)}function X(e,l){x.s.confirm(f("cj.dialog.user.deleteConfirm"),"Warning",{confirmButtonText:f("cj.btn.basic.confirm"),cancelButtonText:f("cj.btn.basic.cancel"),type:"warning"}).then((()=>{(0,p.Nq)({userId:l.userId}).then((e=>{0===e.code?(z(l.userId),(0,_.zo)(e)):(0,_.Ue)(e)}))}))}return T("user-list",w,I,z),(e,p)=>{const f=d.WK,_=o.xE,k=n.S2,w=o.US,T=r.o8,x=s.u,z=r.Up,E=t.aQ,D=(0,i.gN)("SuperAdmin"),P=u.L;return(0,i.uX)(),(0,i.CE)("div",null,[(0,i.bF)(w,{model:(0,c.R1)(R),inline:"",size:"small"},{default:(0,i.k6)((()=>[(0,i.bF)(_,{label:e.$t("cj.label.basic.keyword")},{default:(0,i.k6)((()=>[(0,i.bF)(f,{modelValue:(0,c.R1)(R).keyword,"onUpdate:modelValue":p[0]||(p[0]=e=>(0,c.R1)(R).keyword=e),onChange:V,clearable:""},null,8,["modelValue"])])),_:1},8,["label"]),(0,i.bF)(_,null,{default:(0,i.k6)((()=>[(0,i.bF)(k,{type:"primary",onClick:V,icon:(0,c.R1)(m.Search),disabled:(0,c.R1)(y)},{default:(0,i.k6)((()=>[(0,i.eW)((0,b.v_)(e.$t("cj.btn.basic.search")),1)])),_:1},8,["icon","disabled"]),(0,i.bo)(((0,i.uX)(),(0,i.Wv)(k,{type:"primary",onClick:$,icon:(0,c.R1)(m.DocumentAdd)},{default:(0,i.k6)((()=>[(0,i.eW)((0,b.v_)(e.$t("cj.btn.basic.create")),1)])),_:1},8,["icon"])),[[D]])])),_:1})])),_:1},8,["model"]),(0,i.bo)(((0,i.uX)(),(0,i.Wv)(z,{data:(0,c.R1)(j).data,style:{width:"100%"},"table-layout":"auto",border:""},{default:(0,i.k6)((()=>[(0,i.bF)(T,{prop:"userId",label:e.$t("cj.label.basic.id")},null,8,["label"]),(0,i.bF)(T,{prop:"userName",label:e.$t("cj.label.user.userName")},null,8,["label"]),(0,i.bF)(T,{prop:"loginName",label:e.$t("cj.label.user.loginName")},null,8,["label"]),(0,i.bF)(T,{prop:"userType",label:e.$t("cj.label.user.userType")},{default:(0,i.k6)((l=>[(0,i.bF)(x,null,{default:(0,i.k6)((()=>[(0,i.eW)((0,b.v_)(e.$t((0,c.R1)(v.TW)(l.row.userType))),1)])),_:2},1024)])),_:1},8,["label"]),(0,i.bF)(T,{prop:"loginType",label:e.$t("cj.label.user.loginType")},{default:(0,i.k6)((l=>[(0,i.bF)(x,null,{default:(0,i.k6)((()=>[(0,i.eW)((0,b.v_)(e.$t((0,c.R1)(v.yr)(l.row.loginType))),1)])),_:2},1024)])),_:1},8,["label"]),(0,i.bF)(T,{prop:"userStatus",label:e.$t("cj.label.basic.status")},{default:(0,i.k6)((l=>[(0,i.bF)(x,null,{default:(0,i.k6)((()=>[(0,i.eW)((0,b.v_)(e.$t((0,c.R1)(v.s)(l.row.userStatus))),1)])),_:2},1024)])),_:1},8,["label"]),(0,i.bF)(T,{prop:"registerTime",label:e.$t("cj.label.user.registerTime")},{default:(0,i.k6)((e=>[(0,i.eW)((0,b.v_)((0,c.R1)(v.BU)(e.row.registerTime)),1)])),_:1},8,["label"]),(0,i.bF)(T,{label:e.$t("cj.label.basic.operation")},{default:(0,i.k6)((l=>[(0,i.bo)(((0,i.uX)(),(0,i.Wv)(k,{size:"small",type:"primary",onClick:e=>S(l.$index,l.row),icon:(0,c.R1)(m.Lock)},{default:(0,i.k6)((()=>[(0,i.eW)((0,b.v_)(e.$t("cj.btn.user.resetPassword")),1)])),_:2},1032,["onClick","icon"])),[[D]]),(0,i.bo)(((0,i.uX)(),(0,i.Wv)(k,{size:"small",type:"primary",onClick:e=>W(l.$index,l.row),icon:(0,c.R1)(m.Edit)},{default:(0,i.k6)((()=>[(0,i.eW)((0,b.v_)(e.$t("cj.btn.basic.edit")),1)])),_:2},1032,["onClick","icon"])),[[D]]),(0,i.bo)(((0,i.uX)(),(0,i.Wv)(k,{size:"small",type:"danger",onClick:e=>X(l.$index,l.row),icon:(0,c.R1)(m.Delete),disabled:l.row.userId===(0,c.R1)(C.QM)().userId},{default:(0,i.k6)((()=>[(0,i.eW)((0,b.v_)(e.$t("cj.btn.basic.delete")),1)])),_:2},1032,["onClick","icon","disabled"])),[[D]])])),_:1},8,["label"])])),_:1},8,["data"])),[[P,(0,c.R1)(y)]]),p[3]||(p[3]=(0,i.Lk)("br",null,null,-1)),(0,i.bF)(E,{size:"small",background:"",onCurrentChange:h,onSizeChange:N,"current-page":(0,c.R1)(R).no,"onUpdate:currentPage":p[1]||(p[1]=e=>(0,c.R1)(R).no=e),"page-sizes":[10,20,50,100,200],"page-size":(0,c.R1)(R).size,"onUpdate:pageSize":p[2]||(p[2]=e=>(0,c.R1)(R).size=e),layout:"sizes, prev, pager, next, jumper, total",total:(0,c.R1)(j).total},null,8,["current-page","page-size","total"]),(0,i.bF)(F,{ref_key:"createUserDialogRef",ref:l,onOnCreateUser:I},null,512),(0,i.bF)(U,{ref_key:"resetUserPasswordDialogRef",ref:a,onOnUpdateUser:I},null,512),(0,i.bF)(K,{ref_key:"updateUserStateDialogRef",ref:g,onOnUpdateUser:I},null,512)])}}}));const z=I;var X=z}}]);